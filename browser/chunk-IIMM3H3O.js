import{$ as Hi,$b as Dc,A as _e,Aa as an,Ab as xc,B as Es,Bb as Rc,D as cc,F as bs,Fc as kc,G as je,Gb as ir,H as $e,Ha as Ji,Hb as at,I as Ki,Ja as Yi,K as Qi,Ka as Xi,L as uc,M as rn,N as Wi,O as Ge,Oa as mc,P as hc,Pb as rr,S as Cs,Sb as Ut,T as dc,Tb as pe,U as W,Ua as ln,V as fe,Vb as j,W as fc,Wa as Zi,Wb as Pc,Xa as Ve,Y as sn,Ya as Tt,Z as pc,Zb as sr,aa as yt,ab as er,ac as hn,b as ac,ba as ie,bb as wt,da as re,db as Et,dc as Ds,ea as q,eb as bt,fb as tr,g as Gi,gc as Vc,hb as ue,hc as Vs,ia as Ce,ib as As,ja as Z,jc as ks,ka as ee,la as Ue,lc as Ns,ma as ni,mc as Os,na as ii,oa as Fe,ob as Ss,oc as Ms,pa as Mt,pb as xs,qa as st,qb as nr,ra as Y,rb as Rs,sa as vt,sb as Ps,ta as It,tb as Qe,tc as Ls,u as ge,ua as Lt,ub as Sc,v as lc,wa as Ft,xa as Bt,y as ti,ya as on,z as De,za as qt,zb as un}from"./chunk-777HDVUW.js";import{B as cn,a as ei,d as V,j as gc,l as _c,m as yc,n as vc,p as Ic,r as Ke,s as Tc,t as ot,u as wc,v as Ec,w as bc,x as Cc,z as Ac}from"./chunk-U7L4XMCF.js";var ud=["*"];function hd(n,e){n&1&&Fe(0)}function dd(n,e){if(n&1&&(Z(0,"div",4),ie(1,hd,1,0,"ng-container",5),ee()),n&2){let t=Y();re("data-pc-section","start"),W(),q("ngTemplateOutlet",t.startTemplate)}}function fd(n,e){n&1&&Fe(0)}function pd(n,e){if(n&1&&(Z(0,"div",6),ie(1,fd,1,0,"ng-container",5),ee()),n&2){let t=Y();re("data-pc-section","center"),W(),q("ngTemplateOutlet",t.centerTemplate)}}function md(n,e){n&1&&Fe(0)}function gd(n,e){if(n&1&&(Z(0,"div",7),ie(1,md,1,0,"ng-container",5),ee()),n&2){let t=Y();re("data-pc-section","end"),W(),q("ngTemplateOutlet",t.endTemplate)}}var Ym=(()=>{class n{el;style;styleClass;ariaLabelledBy;templates;startTemplate;endTemplate;centerTemplate;constructor(t){this.el=t}getBlockableElement(){return this.el.nativeElement.children[0]}ngAfterContentInit(){this.templates.forEach(t=>{switch(t.getType()){case"start":case"left":this.startTemplate=t.template;break;case"end":case"right":this.endTemplate=t.template;break;case"center":this.centerTemplate=t.template;break}})}static \u0275fac=function(i){return new(i||n)(fe(Ge))};static \u0275cmp=De({type:n,selectors:[["p-toolbar"]],contentQueries:function(i,s,o){if(i&1&&Lt(o,Ut,4),i&2){let l;Ft(l=Bt())&&(s.templates=l)}},hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass",ariaLabelledBy:"ariaLabelledBy"},ngContentSelectors:ud,decls:5,vars:9,consts:[["role","toolbar",3,"ngClass","ngStyle"],["class","p-toolbar-group-left p-toolbar-group-start",4,"ngIf"],["class","p-toolbar-group-center",4,"ngIf"],["class","p-toolbar-group-right p-toolbar-group-end",4,"ngIf"],[1,"p-toolbar-group-left","p-toolbar-group-start"],[4,"ngTemplateOutlet"],[1,"p-toolbar-group-center"],[1,"p-toolbar-group-right","p-toolbar-group-end"]],template:function(i,s){i&1&&(vt(),Z(0,"div",0),It(1),ie(2,dd,2,2,"div",1)(3,pd,2,2,"div",2)(4,gd,2,2,"div",3),ee()),i&2&&(Ce(s.styleClass),q("ngClass","p-toolbar p-component")("ngStyle",s.style),re("aria-labelledby",s.ariaLabelledBy)("data-pc-name","toolbar"),W(2),q("ngIf",s.startTemplate),W(),q("ngIf",s.centerTemplate),W(),q("ngIf",s.endTemplate))},dependencies:[wt,Et,tr,bt],styles:[`@layer primeng{.p-toolbar{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap}.p-toolbar-group-start,.p-toolbar-group-center,.p-toolbar-group-end,.p-toolbar-group-left,.p-toolbar-group-right{display:flex;align-items:center}}
`],encapsulation:2,changeDetection:0})}return n})(),Bs=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=_e({type:n});static \u0275inj=ge({imports:[ue,pe,pe]})}return n})();var _d=["*"];function yd(n,e){if(n&1&&(Z(0,"span",4),qt(1),ee()),n&2){let t=Y();W(),an(t.label)}}function vd(n,e){if(n&1&&Ue(0,"span",6),n&2){let t=Y(2);Ce(t.icon),q("ngClass","p-avatar-icon")}}function Id(n,e){if(n&1&&ie(0,vd,1,3,"span",5),n&2){let t=Y(),i=on(6);q("ngIf",t.icon)("ngIfElse",i)}}function Td(n,e){if(n&1){let t=Mt();Z(0,"img",8),st("error",function(s){je(t);let o=Y(2);return $e(o.imageError(s))}),ee()}if(n&2){let t=Y(2);q("src",t.image,Cs),re("aria-label",t.ariaLabel)}}function wd(n,e){if(n&1&&ie(0,Td,1,2,"img",7),n&2){let t=Y();q("ngIf",t.image)}}var ag=(()=>{class n{label;icon;image;size="normal";shape="square";style;styleClass;ariaLabel;ariaLabelledBy;onImageError=new rn;containerClass(){return{"p-avatar p-component":!0,"p-avatar-image":this.image!=null,"p-avatar-circle":this.shape==="circle","p-avatar-lg":this.size==="large","p-avatar-xl":this.size==="xlarge"}}imageError(t){this.onImageError.emit(t)}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=De({type:n,selectors:[["p-avatar"]],hostAttrs:[1,"p-element"],inputs:{label:"label",icon:"icon",image:"image",size:"size",shape:"shape",style:"style",styleClass:"styleClass",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy"},outputs:{onImageError:"onImageError"},ngContentSelectors:_d,decls:7,vars:9,consts:[["iconTemplate",""],["imageTemplate",""],[3,"ngClass","ngStyle"],["class","p-avatar-text",4,"ngIf","ngIfElse"],[1,"p-avatar-text"],[3,"class","ngClass",4,"ngIf","ngIfElse"],[3,"ngClass"],[3,"src","error",4,"ngIf"],[3,"error","src"]],template:function(i,s){if(i&1&&(vt(),Z(0,"div",2),It(1),ie(2,yd,2,1,"span",3)(3,Id,1,2,"ng-template",null,0,ln)(5,wd,1,1,"ng-template",null,1,ln),ee()),i&2){let o=on(4);Ce(s.styleClass),q("ngClass",s.containerClass())("ngStyle",s.style),re("aria-labelledby",s.ariaLabelledBy)("aria-label",s.ariaLabel)("data-pc-name","avatar"),W(2),q("ngIf",s.label)("ngIfElse",o)}},dependencies:[wt,Et,bt],styles:[`@layer primeng{.p-avatar{display:inline-flex;align-items:center;justify-content:center;width:2rem;height:2rem;font-size:1rem}.p-avatar.p-avatar-image{background-color:transparent}.p-avatar.p-avatar-circle{border-radius:50%;overflow:hidden}.p-avatar .p-avatar-icon{font-size:1rem}.p-avatar img{width:100%;height:100%}}
`],encapsulation:2,changeDetection:0})}return n})(),qs=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=_e({type:n});static \u0275inj=ge({imports:[ue]})}return n})();function Ed(n,e){if(n&1&&(Z(0,"span",1),qt(1),ee()),n&2){let t=Y();Ce(t.styleClass),q("ngClass",t.containerClass())("ngStyle",t.style),W(),an(t.value)}}var vg=(()=>{class n{styleClass;style;badgeSize;severity;value;badgeDisabled=!1;set size(t){this._size=t,console.warn("size property is deprecated and will removed in v18, use badgeSize instead.")}get size(){return this._size}_size;containerClass(){return{"p-badge p-component":!0,"p-badge-no-gutter":this.value!=null&&String(this.value).length===1,"p-badge-lg":this.badgeSize==="large"||this.size==="large","p-badge-xl":this.badgeSize==="xlarge"||this.size==="xlarge",[`p-badge-${this.severity}`]:this.severity}}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=De({type:n,selectors:[["p-badge"]],hostAttrs:[1,"p-element"],inputs:{styleClass:"styleClass",style:"style",badgeSize:"badgeSize",severity:"severity",value:"value",badgeDisabled:[2,"badgeDisabled","badgeDisabled",Ve],size:"size"},features:[yt],decls:1,vars:1,consts:[[3,"ngClass","class","ngStyle",4,"ngIf"],[3,"ngClass","ngStyle"]],template:function(i,s){i&1&&ie(0,Ed,2,5,"span",0),i&2&&q("ngIf",!s.badgeDisabled)},dependencies:[wt,Et,bt],styles:[`@layer primeng{.p-badge{display:inline-block;border-radius:10px;text-align:center;padding:0 .5rem}.p-overlay-badge{position:relative}.p-overlay-badge .p-badge{position:absolute;top:0;right:0;transform:translate(50%,-50%);transform-origin:100% 0;margin:0}.p-badge-dot{width:.5rem;min-width:.5rem;height:.5rem;border-radius:50%;padding:0}.p-badge-no-gutter{padding:0;border-radius:50%}}
`],encapsulation:2,changeDetection:0})}return n})(),Us=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=_e({type:n});static \u0275inj=ge({imports:[ue,pe]})}return n})();var Cd=["*"],Ad=(n,e,t,i,s,o)=>({"p-sidebar":!0,"p-sidebar-active":n,"p-sidebar-left":e,"p-sidebar-right":t,"p-sidebar-top":i,"p-sidebar-bottom":s,"p-sidebar-full":o}),Sd=(n,e)=>({transform:n,transition:e}),xd=n=>({value:"visible",params:n});function Rd(n,e){n&1&&Fe(0)}function Pd(n,e){if(n&1&&(ni(0),ie(1,Rd,1,0,"ng-container",5),ii()),n&2){let t=Y(2);W(),q("ngTemplateOutlet",t.headlessTemplate)}}function Dd(n,e){n&1&&Fe(0)}function Vd(n,e){n&1&&Ue(0,"TimesIcon",13),n&2&&(q("styleClass","p-sidebar-close-icon"),re("data-pc-section","closeicon"))}function kd(n,e){}function Nd(n,e){n&1&&ie(0,kd,0,0,"ng-template")}function Od(n,e){if(n&1&&(Z(0,"span",14),ie(1,Nd,1,0,null,5),ee()),n&2){let t=Y(4);re("data-pc-section","closeicon"),W(),q("ngTemplateOutlet",t.closeIconTemplate)}}function Md(n,e){if(n&1){let t=Mt();Z(0,"button",10),st("click",function(s){je(t);let o=Y(3);return $e(o.close(s))})("keydown.enter",function(s){je(t);let o=Y(3);return $e(o.close(s))}),ie(1,Vd,1,2,"TimesIcon",11)(2,Od,2,2,"span",12),ee()}if(n&2){let t=Y(3);re("aria-label",t.ariaCloseLabel)("data-pc-section","closebutton")("data-pc-group-section","iconcontainer"),W(),q("ngIf",!t.closeIconTemplate),W(),q("ngIf",t.closeIconTemplate)}}function Ld(n,e){n&1&&Fe(0)}function Fd(n,e){n&1&&Fe(0)}function Bd(n,e){if(n&1&&(ni(0),Z(1,"div",15),ie(2,Fd,1,0,"ng-container",5),ee(),ii()),n&2){let t=Y(3);W(),re("data-pc-section","footer"),W(),q("ngTemplateOutlet",t.footerTemplate)}}function qd(n,e){if(n&1&&(Z(0,"div",6),ie(1,Dd,1,0,"ng-container",5)(2,Md,3,5,"button",7),ee(),Z(3,"div",8),It(4),ie(5,Ld,1,0,"ng-container",5),ee(),ie(6,Bd,3,2,"ng-container",9)),n&2){let t=Y(2);re("data-pc-section","header"),W(),q("ngTemplateOutlet",t.headerTemplate),W(),q("ngIf",t.showCloseIcon),W(),re("data-pc-section","content"),W(2),q("ngTemplateOutlet",t.contentTemplate),W(),q("ngIf",t.footerTemplate)}}function Ud(n,e){if(n&1){let t=Mt();Z(0,"div",3,0),st("@panelState.start",function(s){je(t);let o=Y();return $e(o.onAnimationStart(s))})("@panelState.done",function(s){je(t);let o=Y();return $e(o.onAnimationEnd(s))})("keydown",function(s){je(t);let o=Y();return $e(o.onKeyDown(s))}),ie(2,Pd,2,1,"ng-container",4)(3,qd,7,6,"ng-template",null,1,ln),ee()}if(n&2){let t=on(4),i=Y();Ce(i.styleClass),q("ngClass",mc(9,Ad,i.visible,i.position==="left"&&!i.fullScreen,i.position==="right"&&!i.fullScreen,i.position==="top"&&!i.fullScreen,i.position==="bottom"&&!i.fullScreen,i.fullScreen))("@panelState",Yi(19,xd,Xi(16,Sd,i.transformOptions,i.transitionOptions)))("ngStyle",i.style),re("data-pc-name","sidebar")("data-pc-section","root"),W(2),q("ngIf",i.headlessTemplate)("ngIfElse",t)}}var zd=Os([ks({transform:"{{transform}}",opacity:0}),Vs("{{transition}}")]),jd=Os([Vs("{{transition}}",ks({transform:"{{transform}}",opacity:0}))]),Fg=(()=>{class n{document;el;renderer;cd;config;appendTo;blockScroll=!1;style;styleClass;ariaCloseLabel;autoZIndex=!0;baseZIndex=0;modal=!0;dismissible=!0;showCloseIcon=!0;closeOnEscape=!0;transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)";get visible(){return this._visible}set visible(t){this._visible=t}get position(){return this._position}set position(t){switch(this._position=t,t){case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break}}get fullScreen(){return this._fullScreen}set fullScreen(t){this._fullScreen=t,t&&(this.transformOptions="none")}templates;onShow=new rn;onHide=new rn;visibleChange=new rn;initialized;_visible;_position="left";_fullScreen=!1;container;transformOptions="translate3d(-100%, 0px, 0px)";mask;maskClickListener;documentEscapeListener;animationEndListener;contentTemplate;headerTemplate;footerTemplate;closeIconTemplate;headlessTemplate;constructor(t,i,s,o,l){this.document=t,this.el=i,this.renderer=s,this.cd=o,this.config=l}ngAfterViewInit(){this.initialized=!0}ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"content":this.contentTemplate=t.template;break;case"header":this.headerTemplate=t.template;break;case"footer":this.footerTemplate=t.template;break;case"closeicon":this.closeIconTemplate=t.template;break;case"headless":this.headlessTemplate=t.template;break;default:this.contentTemplate=t.template;break}})}onKeyDown(t){t.code==="Escape"&&this.hide(!1)}show(){this.autoZIndex&&at.set("modal",this.container,this.baseZIndex||this.config.zIndex.modal),this.modal&&this.enableModality(),this.onShow.emit({}),this.visibleChange.emit(!0)}hide(t=!0){t&&this.onHide.emit({}),this.modal&&this.disableModality()}close(t){this.hide(!1),this.visibleChange.emit(!1),t.preventDefault()}enableModality(){let t=this.document.querySelectorAll(".p-sidebar-active"),s=t.length==1?String(parseInt(this.container.style.zIndex)-1):String(parseInt(t[0].style.zIndex)-1);this.mask||(this.mask=this.renderer.createElement("div"),this.renderer.setStyle(this.mask,"zIndex",s),j.addMultipleClasses(this.mask,"p-component-overlay p-sidebar-mask p-component-overlay p-component-overlay-enter"),this.dismissible&&(this.maskClickListener=this.renderer.listen(this.mask,"click",o=>{this.dismissible&&this.close(o)})),this.renderer.appendChild(this.document.body,this.mask),this.blockScroll&&j.blockBodyScroll())}disableModality(){this.mask&&(j.addClass(this.mask,"p-component-overlay-leave"),this.animationEndListener=this.renderer.listen(this.mask,"animationend",this.destroyModal.bind(this)))}destroyModal(){this.unbindMaskClickListener(),this.mask&&this.renderer.removeChild(this.document.body,this.mask),this.blockScroll&&j.unblockBodyScroll(),this.unbindAnimationEndListener(),this.mask=null}onAnimationStart(t){switch(t.toState){case"visible":this.container=t.element,this.appendContainer(),this.show(),this.closeOnEscape&&this.bindDocumentEscapeListener();break}}onAnimationEnd(t){switch(t.toState){case"void":this.hide(!0),at.clear(this.container),this.unbindGlobalListeners();break}}appendContainer(){this.appendTo&&(this.appendTo==="body"?this.renderer.appendChild(this.document.body,this.container):j.appendChild(this.container,this.appendTo))}bindDocumentEscapeListener(){let t=this.el?this.el.nativeElement.ownerDocument:this.document;this.documentEscapeListener=this.renderer.listen(t,"keydown",i=>{i.which==27&&parseInt(this.container.style.zIndex)===at.get(this.container)&&this.close(i)})}unbindDocumentEscapeListener(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}unbindGlobalListeners(){this.unbindMaskClickListener(),this.unbindDocumentEscapeListener()}unbindAnimationEndListener(){this.animationEndListener&&this.mask&&(this.animationEndListener(),this.animationEndListener=null)}ngOnDestroy(){this.initialized=!1,this.visible&&this.modal&&this.destroyModal(),this.appendTo&&this.container&&this.renderer.appendChild(this.el.nativeElement,this.container),this.container&&this.autoZIndex&&at.clear(this.container),this.container=null,this.unbindGlobalListeners(),this.unbindAnimationEndListener()}static \u0275fac=function(i){return new(i||n)(fe(er),fe(Ge),fe(sn),fe(Zi),fe(rr))};static \u0275cmp=De({type:n,selectors:[["p-sidebar"]],contentQueries:function(i,s,o){if(i&1&&Lt(o,Ut,4),i&2){let l;Ft(l=Bt())&&(s.templates=l)}},hostAttrs:[1,"p-element"],inputs:{appendTo:"appendTo",blockScroll:[2,"blockScroll","blockScroll",Ve],style:"style",styleClass:"styleClass",ariaCloseLabel:"ariaCloseLabel",autoZIndex:[2,"autoZIndex","autoZIndex",Ve],baseZIndex:[2,"baseZIndex","baseZIndex",Tt],modal:[2,"modal","modal",Ve],dismissible:[2,"dismissible","dismissible",Ve],showCloseIcon:[2,"showCloseIcon","showCloseIcon",Ve],closeOnEscape:[2,"closeOnEscape","closeOnEscape",Ve],transitionOptions:"transitionOptions",visible:"visible",position:"position",fullScreen:"fullScreen"},outputs:{onShow:"onShow",onHide:"onHide",visibleChange:"visibleChange"},features:[yt],ngContentSelectors:Cd,decls:1,vars:1,consts:[["container",""],["notHeadless",""],["role","complementary",3,"ngClass","ngStyle","class","keydown",4,"ngIf"],["role","complementary",3,"keydown","ngClass","ngStyle"],[4,"ngIf","ngIfElse"],[4,"ngTemplateOutlet"],[1,"p-sidebar-header"],["type","button","class","p-sidebar-close p-sidebar-icon p-link","pRipple","",3,"click","keydown.enter",4,"ngIf"],[1,"p-sidebar-content"],[4,"ngIf"],["type","button","pRipple","",1,"p-sidebar-close","p-sidebar-icon","p-link",3,"click","keydown.enter"],[3,"styleClass",4,"ngIf"],["class","p-sidebar-close-icon",4,"ngIf"],[3,"styleClass"],[1,"p-sidebar-close-icon"],[1,"p-sidebar-footer"]],template:function(i,s){i&1&&(vt(),ie(0,Ud,5,21,"div",2)),i&2&&q("ngIf",s.visible)},dependencies:()=>[wt,Et,tr,bt,Dc,Ls],styles:[`@layer primeng{.p-sidebar{position:fixed;transition:transform .3s;display:flex;flex-direction:column}.p-sidebar-content{position:relative;overflow-y:auto;flex-grow:1}.p-sidebar-header{display:flex;align-items:center}.p-sidebar-footer{margin-top:auto}.p-sidebar-icon{display:flex;align-items:center;justify-content:center;margin-left:auto}.p-sidebar-left{top:0;left:0;width:20rem;height:100%}.p-sidebar-right{top:0;right:0;width:20rem;height:100%}.p-sidebar-top{top:0;left:0;width:100%;height:10rem}.p-sidebar-bottom{bottom:0;left:0;width:100%;height:10rem}.p-sidebar-full{width:100%;height:100%;top:0;left:0;-webkit-transition:none;transition:none}.p-sidebar-left.p-sidebar-sm,.p-sidebar-right.p-sidebar-sm{width:20rem}.p-sidebar-left.p-sidebar-md,.p-sidebar-right.p-sidebar-md{width:40rem}.p-sidebar-left.p-sidebar-lg,.p-sidebar-right.p-sidebar-lg{width:60rem}.p-sidebar-top.p-sidebar-sm,.p-sidebar-bottom.p-sidebar-sm{height:10rem}.p-sidebar-top.p-sidebar-md,.p-sidebar-bottom.p-sidebar-md{height:20rem}.p-sidebar-top.p-sidebar-lg,.p-sidebar-bottom.p-sidebar-lg{height:30rem}@media screen and (max-width: 64em){.p-sidebar-left.p-sidebar-lg,.p-sidebar-left.p-sidebar-md,.p-sidebar-right.p-sidebar-lg,.p-sidebar-right.p-sidebar-md{width:20rem}}}
`],encapsulation:2,data:{animation:[Vc("panelState",[Ns("void => visible",[Ms(zd)]),Ns("visible => void",[Ms(jd)])])]},changeDetection:0})}return n})(),zs=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=_e({type:n});static \u0275inj=ge({imports:[ue,hn,pe,Ls,pe]})}return n})();var Nc=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=_e({type:n});static \u0275inj=ge({imports:[ue,pe]})}return n})();var Oc=(()=>{class n extends sr{static \u0275fac=(()=>{let t;return function(s){return(t||(t=Qi(n)))(s||n)}})();static \u0275cmp=De({type:n,selectors:[["MinusIcon"]],standalone:!0,features:[Hi,Ji],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M13.2222 7.77778H0.777778C0.571498 7.77778 0.373667 7.69584 0.227806 7.54998C0.0819442 7.40412 0 7.20629 0 7.00001C0 6.79373 0.0819442 6.5959 0.227806 6.45003C0.373667 6.30417 0.571498 6.22223 0.777778 6.22223H13.2222C13.4285 6.22223 13.6263 6.30417 13.7722 6.45003C13.9181 6.5959 14 6.79373 14 7.00001C14 7.20629 13.9181 7.40412 13.7722 7.54998C13.6263 7.69584 13.4285 7.77778 13.2222 7.77778Z","fill","currentColor"]],template:function(i,s){i&1&&(Ki(),Z(0,"svg",0),Ue(1,"path",1),ee()),i&2&&(Ce(s.getClassNames()),re("aria-label",s.ariaLabel)("aria-hidden",s.ariaHidden)("role",s.role))},dependencies:[ue],encapsulation:2})}return n})();var Mc=(()=>{class n extends sr{pathId;ngOnInit(){this.pathId="url(#"+ir()+")"}static \u0275fac=(()=>{let t;return function(s){return(t||(t=Qi(n)))(s||n)}})();static \u0275cmp=De({type:n,selectors:[["PlusIcon"]],standalone:!0,features:[Hi,Ji],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M7.67742 6.32258V0.677419C7.67742 0.497757 7.60605 0.325452 7.47901 0.198411C7.35197 0.0713707 7.17966 0 7 0C6.82034 0 6.64803 0.0713707 6.52099 0.198411C6.39395 0.325452 6.32258 0.497757 6.32258 0.677419V6.32258H0.677419C0.497757 6.32258 0.325452 6.39395 0.198411 6.52099C0.0713707 6.64803 0 6.82034 0 7C0 7.17966 0.0713707 7.35197 0.198411 7.47901C0.325452 7.60605 0.497757 7.67742 0.677419 7.67742H6.32258V13.3226C6.32492 13.5015 6.39704 13.6725 6.52358 13.799C6.65012 13.9255 6.82106 13.9977 7 14C7.17966 14 7.35197 13.9286 7.47901 13.8016C7.60605 13.6745 7.67742 13.5022 7.67742 13.3226V7.67742H13.3226C13.5022 7.67742 13.6745 7.60605 13.8016 7.47901C13.9286 7.35197 14 7.17966 14 7C13.9977 6.82106 13.9255 6.65012 13.799 6.52358C13.6725 6.39704 13.5015 6.32492 13.3226 6.32258H7.67742Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,s){i&1&&(Ki(),Z(0,"svg",0)(1,"g"),Ue(2,"path",1),ee(),Z(3,"defs")(4,"clipPath",2),Ue(5,"rect",3),ee()()()),i&2&&(Ce(s.getClassNames()),re("aria-label",s.ariaLabel)("aria-hidden",s.ariaHidden)("role",s.role),W(),re("clip-path",s.pathId),W(3),q("id",s.pathId))},encapsulation:2})}return n})();var js=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=_e({type:n});static \u0275inj=ge({imports:[ue,pe,hn,Mc,Oc,pe]})}return n})();var d_=(()=>{class n{platformId;el;zone;config;renderer;viewContainer;tooltipPosition;tooltipEvent="hover";appendTo;positionStyle;tooltipStyleClass;tooltipZIndex;escape=!0;showDelay;hideDelay;life;positionTop;positionLeft;autoHide=!0;fitContent=!0;hideOnEscape=!0;content;get disabled(){return this._disabled}set disabled(t){this._disabled=t,this.deactivate()}tooltipOptions;_tooltipOptions={tooltipLabel:null,tooltipPosition:"right",tooltipEvent:"hover",appendTo:"body",positionStyle:null,tooltipStyleClass:null,tooltipZIndex:"auto",escape:!0,disabled:null,showDelay:null,hideDelay:null,positionTop:null,positionLeft:null,life:null,autoHide:!0,hideOnEscape:!0,id:ir()+"_tooltip"};_disabled;container;styleClass;tooltipText;showTimeout;hideTimeout;active;mouseEnterListener;mouseLeaveListener;containerMouseleaveListener;clickListener;focusListener;blurListener;scrollHandler;resizeListener;interactionInProgress=!1;constructor(t,i,s,o,l,u){this.platformId=t,this.el=i,this.zone=s,this.config=o,this.renderer=l,this.viewContainer=u}ngAfterViewInit(){As(this.platformId)&&this.zone.runOutsideAngular(()=>{let t=this.getOption("tooltipEvent");if((t==="hover"||t==="both")&&(this.mouseEnterListener=this.onMouseEnter.bind(this),this.mouseLeaveListener=this.onMouseLeave.bind(this),this.clickListener=this.onInputClick.bind(this),this.el.nativeElement.addEventListener("mouseenter",this.mouseEnterListener),this.el.nativeElement.addEventListener("click",this.clickListener),this.el.nativeElement.addEventListener("mouseleave",this.mouseLeaveListener)),t==="focus"||t==="both"){this.focusListener=this.onFocus.bind(this),this.blurListener=this.onBlur.bind(this);let i=this.el.nativeElement.querySelector(".p-component");i||(i=this.getTarget(this.el.nativeElement)),i.addEventListener("focus",this.focusListener),i.addEventListener("blur",this.blurListener)}})}ngOnChanges(t){t.tooltipPosition&&this.setOption({tooltipPosition:t.tooltipPosition.currentValue}),t.tooltipEvent&&this.setOption({tooltipEvent:t.tooltipEvent.currentValue}),t.appendTo&&this.setOption({appendTo:t.appendTo.currentValue}),t.positionStyle&&this.setOption({positionStyle:t.positionStyle.currentValue}),t.tooltipStyleClass&&this.setOption({tooltipStyleClass:t.tooltipStyleClass.currentValue}),t.tooltipZIndex&&this.setOption({tooltipZIndex:t.tooltipZIndex.currentValue}),t.escape&&this.setOption({escape:t.escape.currentValue}),t.showDelay&&this.setOption({showDelay:t.showDelay.currentValue}),t.hideDelay&&this.setOption({hideDelay:t.hideDelay.currentValue}),t.life&&this.setOption({life:t.life.currentValue}),t.positionTop&&this.setOption({positionTop:t.positionTop.currentValue}),t.positionLeft&&this.setOption({positionLeft:t.positionLeft.currentValue}),t.disabled&&this.setOption({disabled:t.disabled.currentValue}),t.content&&(this.setOption({tooltipLabel:t.content.currentValue}),this.active&&(t.content.currentValue?this.container&&this.container.offsetParent?(this.updateText(),this.align()):this.show():this.hide())),t.autoHide&&this.setOption({autoHide:t.autoHide.currentValue}),t.id&&this.setOption({id:t.id.currentValue}),t.tooltipOptions&&(this._tooltipOptions=ei(ei({},this._tooltipOptions),t.tooltipOptions.currentValue),this.deactivate(),this.active&&(this.getOption("tooltipLabel")?this.container&&this.container.offsetParent?(this.updateText(),this.align()):this.show():this.hide()))}isAutoHide(){return this.getOption("autoHide")}onMouseEnter(t){!this.container&&!this.showTimeout&&this.activate()}onMouseLeave(t){this.isAutoHide()?this.deactivate():!(j.hasClass(t.relatedTarget,"p-tooltip")||j.hasClass(t.relatedTarget,"p-tooltip-text")||j.hasClass(t.relatedTarget,"p-tooltip-arrow"))&&this.deactivate()}onFocus(t){this.activate()}onBlur(t){this.deactivate()}onInputClick(t){this.deactivate()}onPressEscape(){this.hideOnEscape&&this.deactivate()}activate(){if(!this.interactionInProgress&&(this.active=!0,this.clearHideTimeout(),this.getOption("showDelay")?this.showTimeout=setTimeout(()=>{this.show()},this.getOption("showDelay")):this.show(),this.getOption("life"))){let t=this.getOption("showDelay")?this.getOption("life")+this.getOption("showDelay"):this.getOption("life");this.hideTimeout=setTimeout(()=>{this.hide()},t)}this.interactionInProgress=!0}deactivate(){this.interactionInProgress=!1,this.active=!1,this.clearShowTimeout(),this.getOption("hideDelay")?(this.clearHideTimeout(),this.hideTimeout=setTimeout(()=>{this.hide()},this.getOption("hideDelay"))):this.hide()}create(){this.container&&(this.clearHideTimeout(),this.remove()),this.container=document.createElement("div"),this.container.setAttribute("id",this.getOption("id")),this.container.setAttribute("role","tooltip");let t=document.createElement("div");t.className="p-tooltip-arrow",this.container.appendChild(t),this.tooltipText=document.createElement("div"),this.tooltipText.className="p-tooltip-text",this.updateText(),this.getOption("positionStyle")&&(this.container.style.position=this.getOption("positionStyle")),this.container.appendChild(this.tooltipText),this.getOption("appendTo")==="body"?document.body.appendChild(this.container):this.getOption("appendTo")==="target"?j.appendChild(this.container,this.el.nativeElement):j.appendChild(this.container,this.getOption("appendTo")),this.container.style.display="inline-block",this.fitContent&&(this.container.style.width="fit-content"),this.isAutoHide()?this.container.style.pointerEvents="none":(this.container.style.pointerEvents="unset",this.bindContainerMouseleaveListener())}bindContainerMouseleaveListener(){if(!this.containerMouseleaveListener){let t=this.container??this.container.nativeElement;this.containerMouseleaveListener=this.renderer.listen(t,"mouseleave",i=>{this.deactivate()})}}unbindContainerMouseleaveListener(){this.containerMouseleaveListener&&(this.bindContainerMouseleaveListener(),this.containerMouseleaveListener=null)}show(){if(!this.getOption("tooltipLabel")||this.getOption("disabled"))return;this.create(),this.el.nativeElement.closest("p-dialog")?setTimeout(()=>{this.container&&this.align()},100):this.align(),j.fadeIn(this.container,250),this.getOption("tooltipZIndex")==="auto"?at.set("tooltip",this.container,this.config.zIndex.tooltip):this.container.style.zIndex=this.getOption("tooltipZIndex"),this.bindDocumentResizeListener(),this.bindScrollListener()}hide(){this.getOption("tooltipZIndex")==="auto"&&at.clear(this.container),this.remove()}updateText(){let t=this.getOption("tooltipLabel");if(t instanceof fc){let i=this.viewContainer.createEmbeddedView(t);i.detectChanges(),i.rootNodes.forEach(s=>this.tooltipText.appendChild(s))}else this.getOption("escape")?(this.tooltipText.innerHTML="",this.tooltipText.appendChild(document.createTextNode(t))):this.tooltipText.innerHTML=t}align(){switch(this.getOption("tooltipPosition")){case"top":this.alignTop(),this.isOutOfBounds()&&(this.alignBottom(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&this.alignLeft()));break;case"bottom":this.alignBottom(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&this.alignLeft()));break;case"left":this.alignLeft(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()));break;case"right":this.alignRight(),this.isOutOfBounds()&&(this.alignLeft(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()));break}}getHostOffset(){if(this.getOption("appendTo")==="body"||this.getOption("appendTo")==="target"){let t=this.el.nativeElement.getBoundingClientRect(),i=t.left+j.getWindowScrollLeft(),s=t.top+j.getWindowScrollTop();return{left:i,top:s}}else return{left:0,top:0}}alignRight(){this.preAlign("right");let t=this.activeElement,i=this.getHostOffset(),s=i.left+j.getOuterWidth(t),o=i.top+(j.getOuterHeight(t)-j.getOuterHeight(this.container))/2;this.container.style.left=s+this.getOption("positionLeft")+"px",this.container.style.top=o+this.getOption("positionTop")+"px"}get activeElement(){return this.el.nativeElement.nodeName.includes("P-")?j.findSingle(this.el.nativeElement,".p-component")||this.el.nativeElement:this.el.nativeElement}alignLeft(){this.preAlign("left");let t=this.getHostOffset(),i=t.left-j.getOuterWidth(this.container),s=t.top+(j.getOuterHeight(this.el.nativeElement)-j.getOuterHeight(this.container))/2;this.container.style.left=i+this.getOption("positionLeft")+"px",this.container.style.top=s+this.getOption("positionTop")+"px"}alignTop(){this.preAlign("top");let t=this.getHostOffset(),i=t.left+(j.getOuterWidth(this.el.nativeElement)-j.getOuterWidth(this.container))/2,s=t.top-j.getOuterHeight(this.container);this.container.style.left=i+this.getOption("positionLeft")+"px",this.container.style.top=s+this.getOption("positionTop")+"px"}alignBottom(){this.preAlign("bottom");let t=this.getHostOffset(),i=t.left+(j.getOuterWidth(this.el.nativeElement)-j.getOuterWidth(this.container))/2,s=t.top+j.getOuterHeight(this.el.nativeElement);this.container.style.left=i+this.getOption("positionLeft")+"px",this.container.style.top=s+this.getOption("positionTop")+"px"}setOption(t){this._tooltipOptions=ei(ei({},this._tooltipOptions),t)}getOption(t){return this._tooltipOptions[t]}getTarget(t){return j.hasClass(t,"p-inputwrapper")?j.findSingle(t,"input"):t}preAlign(t){this.container.style.left="-999px",this.container.style.top="-999px";let i="p-tooltip p-component p-tooltip-"+t;this.container.className=this.getOption("tooltipStyleClass")?i+" "+this.getOption("tooltipStyleClass"):i}isOutOfBounds(){let t=this.container.getBoundingClientRect(),i=t.top,s=t.left,o=j.getOuterWidth(this.container),l=j.getOuterHeight(this.container),u=j.getViewport();return s+o>u.width||s<0||i<0||i+l>u.height}onWindowResize(t){this.hide()}bindDocumentResizeListener(){this.zone.runOutsideAngular(()=>{this.resizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.resizeListener)})}unbindDocumentResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new Pc(this.el.nativeElement,()=>{this.container&&this.hide()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}unbindEvents(){let t=this.getOption("tooltipEvent");if((t==="hover"||t==="both")&&(this.el.nativeElement.removeEventListener("mouseenter",this.mouseEnterListener),this.el.nativeElement.removeEventListener("mouseleave",this.mouseLeaveListener),this.el.nativeElement.removeEventListener("click",this.clickListener)),t==="focus"||t==="both"){let i=this.el.nativeElement.querySelector(".p-component");i||(i=this.getTarget(this.el.nativeElement))}this.unbindDocumentResizeListener()}remove(){this.container&&this.container.parentElement&&(this.getOption("appendTo")==="body"?document.body.removeChild(this.container):this.getOption("appendTo")==="target"?this.el.nativeElement.removeChild(this.container):j.removeChild(this.container,this.getOption("appendTo"))),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.unbindContainerMouseleaveListener(),this.clearTimeouts(),this.container=null,this.scrollHandler=null}clearShowTimeout(){this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=null)}clearHideTimeout(){this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout()}ngOnDestroy(){this.unbindEvents(),this.container&&at.clear(this.container),this.remove(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null)}static \u0275fac=function(i){return new(i||n)(fe(hc),fe(Ge),fe(Wi),fe(rr),fe(sn),fe(pc))};static \u0275dir=Es({type:n,selectors:[["","pTooltip",""]],hostAttrs:[1,"p-element"],hostBindings:function(i,s){i&1&&st("keydown.escape",function(l){return s.onPressEscape(l)},!1,dc)},inputs:{tooltipPosition:"tooltipPosition",tooltipEvent:"tooltipEvent",appendTo:"appendTo",positionStyle:"positionStyle",tooltipStyleClass:"tooltipStyleClass",tooltipZIndex:"tooltipZIndex",escape:[2,"escape","escape",Ve],showDelay:[2,"showDelay","showDelay",Tt],hideDelay:[2,"hideDelay","hideDelay",Tt],life:[2,"life","life",Tt],positionTop:[2,"positionTop","positionTop",Tt],positionLeft:[2,"positionLeft","positionLeft",Tt],autoHide:[2,"autoHide","autoHide",Ve],fitContent:[2,"fitContent","fitContent",Ve],hideOnEscape:[2,"hideOnEscape","hideOnEscape",Ve],content:[0,"pTooltip","content"],disabled:[0,"tooltipDisabled","disabled"],tooltipOptions:"tooltipOptions"},features:[yt,bs]})}return n})(),$s=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=_e({type:n});static \u0275inj=ge({imports:[ue]})}return n})();var Gs=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=_e({type:n});static \u0275inj=ge({imports:[ue,un,hn,$s,pe,un,$s,pe]})}return n})();var Lc=class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=_e({type:n});static \u0275inj=ge({imports:[ue,un,zs,kc,Bs,Ds,Nc,js,qs,Us,Gs,pe,Sc,zs,Bs,Ds,un,js,qs,Us,Gs,pe]})};var Fc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Bc={};var Ct,Ks;(function(){var n;function e(I,p){function _(){}_.prototype=p.prototype,I.D=p.prototype,I.prototype=new _,I.prototype.constructor=I,I.C=function(y,v,w){for(var m=Array(arguments.length-2),nt=2;nt<arguments.length;nt++)m[nt-2]=arguments[nt];return p.prototype[v].apply(y,m)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(I,p,_){_||(_=0);var y=Array(16);if(typeof p=="string")for(var v=0;16>v;++v)y[v]=p.charCodeAt(_++)|p.charCodeAt(_++)<<8|p.charCodeAt(_++)<<16|p.charCodeAt(_++)<<24;else for(v=0;16>v;++v)y[v]=p[_++]|p[_++]<<8|p[_++]<<16|p[_++]<<24;p=I.g[0],_=I.g[1],v=I.g[2];var w=I.g[3],m=p+(w^_&(v^w))+y[0]+3614090360&4294967295;p=_+(m<<7&4294967295|m>>>25),m=w+(v^p&(_^v))+y[1]+3905402710&4294967295,w=p+(m<<12&4294967295|m>>>20),m=v+(_^w&(p^_))+y[2]+606105819&4294967295,v=w+(m<<17&4294967295|m>>>15),m=_+(p^v&(w^p))+y[3]+3250441966&4294967295,_=v+(m<<22&4294967295|m>>>10),m=p+(w^_&(v^w))+y[4]+4118548399&4294967295,p=_+(m<<7&4294967295|m>>>25),m=w+(v^p&(_^v))+y[5]+1200080426&4294967295,w=p+(m<<12&4294967295|m>>>20),m=v+(_^w&(p^_))+y[6]+2821735955&4294967295,v=w+(m<<17&4294967295|m>>>15),m=_+(p^v&(w^p))+y[7]+4249261313&4294967295,_=v+(m<<22&4294967295|m>>>10),m=p+(w^_&(v^w))+y[8]+1770035416&4294967295,p=_+(m<<7&4294967295|m>>>25),m=w+(v^p&(_^v))+y[9]+2336552879&4294967295,w=p+(m<<12&4294967295|m>>>20),m=v+(_^w&(p^_))+y[10]+4294925233&4294967295,v=w+(m<<17&4294967295|m>>>15),m=_+(p^v&(w^p))+y[11]+2304563134&4294967295,_=v+(m<<22&4294967295|m>>>10),m=p+(w^_&(v^w))+y[12]+1804603682&4294967295,p=_+(m<<7&4294967295|m>>>25),m=w+(v^p&(_^v))+y[13]+4254626195&4294967295,w=p+(m<<12&4294967295|m>>>20),m=v+(_^w&(p^_))+y[14]+2792965006&4294967295,v=w+(m<<17&4294967295|m>>>15),m=_+(p^v&(w^p))+y[15]+1236535329&4294967295,_=v+(m<<22&4294967295|m>>>10),m=p+(v^w&(_^v))+y[1]+4129170786&4294967295,p=_+(m<<5&4294967295|m>>>27),m=w+(_^v&(p^_))+y[6]+3225465664&4294967295,w=p+(m<<9&4294967295|m>>>23),m=v+(p^_&(w^p))+y[11]+643717713&4294967295,v=w+(m<<14&4294967295|m>>>18),m=_+(w^p&(v^w))+y[0]+3921069994&4294967295,_=v+(m<<20&4294967295|m>>>12),m=p+(v^w&(_^v))+y[5]+3593408605&4294967295,p=_+(m<<5&4294967295|m>>>27),m=w+(_^v&(p^_))+y[10]+38016083&4294967295,w=p+(m<<9&4294967295|m>>>23),m=v+(p^_&(w^p))+y[15]+3634488961&4294967295,v=w+(m<<14&4294967295|m>>>18),m=_+(w^p&(v^w))+y[4]+3889429448&4294967295,_=v+(m<<20&4294967295|m>>>12),m=p+(v^w&(_^v))+y[9]+568446438&4294967295,p=_+(m<<5&4294967295|m>>>27),m=w+(_^v&(p^_))+y[14]+3275163606&4294967295,w=p+(m<<9&4294967295|m>>>23),m=v+(p^_&(w^p))+y[3]+4107603335&4294967295,v=w+(m<<14&4294967295|m>>>18),m=_+(w^p&(v^w))+y[8]+1163531501&4294967295,_=v+(m<<20&4294967295|m>>>12),m=p+(v^w&(_^v))+y[13]+2850285829&4294967295,p=_+(m<<5&4294967295|m>>>27),m=w+(_^v&(p^_))+y[2]+4243563512&4294967295,w=p+(m<<9&4294967295|m>>>23),m=v+(p^_&(w^p))+y[7]+1735328473&4294967295,v=w+(m<<14&4294967295|m>>>18),m=_+(w^p&(v^w))+y[12]+2368359562&4294967295,_=v+(m<<20&4294967295|m>>>12),m=p+(_^v^w)+y[5]+4294588738&4294967295,p=_+(m<<4&4294967295|m>>>28),m=w+(p^_^v)+y[8]+2272392833&4294967295,w=p+(m<<11&4294967295|m>>>21),m=v+(w^p^_)+y[11]+1839030562&4294967295,v=w+(m<<16&4294967295|m>>>16),m=_+(v^w^p)+y[14]+4259657740&4294967295,_=v+(m<<23&4294967295|m>>>9),m=p+(_^v^w)+y[1]+2763975236&4294967295,p=_+(m<<4&4294967295|m>>>28),m=w+(p^_^v)+y[4]+1272893353&4294967295,w=p+(m<<11&4294967295|m>>>21),m=v+(w^p^_)+y[7]+4139469664&4294967295,v=w+(m<<16&4294967295|m>>>16),m=_+(v^w^p)+y[10]+3200236656&4294967295,_=v+(m<<23&4294967295|m>>>9),m=p+(_^v^w)+y[13]+681279174&4294967295,p=_+(m<<4&4294967295|m>>>28),m=w+(p^_^v)+y[0]+3936430074&4294967295,w=p+(m<<11&4294967295|m>>>21),m=v+(w^p^_)+y[3]+3572445317&4294967295,v=w+(m<<16&4294967295|m>>>16),m=_+(v^w^p)+y[6]+76029189&4294967295,_=v+(m<<23&4294967295|m>>>9),m=p+(_^v^w)+y[9]+3654602809&4294967295,p=_+(m<<4&4294967295|m>>>28),m=w+(p^_^v)+y[12]+3873151461&4294967295,w=p+(m<<11&4294967295|m>>>21),m=v+(w^p^_)+y[15]+530742520&4294967295,v=w+(m<<16&4294967295|m>>>16),m=_+(v^w^p)+y[2]+3299628645&4294967295,_=v+(m<<23&4294967295|m>>>9),m=p+(v^(_|~w))+y[0]+4096336452&4294967295,p=_+(m<<6&4294967295|m>>>26),m=w+(_^(p|~v))+y[7]+1126891415&4294967295,w=p+(m<<10&4294967295|m>>>22),m=v+(p^(w|~_))+y[14]+2878612391&4294967295,v=w+(m<<15&4294967295|m>>>17),m=_+(w^(v|~p))+y[5]+4237533241&4294967295,_=v+(m<<21&4294967295|m>>>11),m=p+(v^(_|~w))+y[12]+1700485571&4294967295,p=_+(m<<6&4294967295|m>>>26),m=w+(_^(p|~v))+y[3]+2399980690&4294967295,w=p+(m<<10&4294967295|m>>>22),m=v+(p^(w|~_))+y[10]+4293915773&4294967295,v=w+(m<<15&4294967295|m>>>17),m=_+(w^(v|~p))+y[1]+2240044497&4294967295,_=v+(m<<21&4294967295|m>>>11),m=p+(v^(_|~w))+y[8]+1873313359&4294967295,p=_+(m<<6&4294967295|m>>>26),m=w+(_^(p|~v))+y[15]+4264355552&4294967295,w=p+(m<<10&4294967295|m>>>22),m=v+(p^(w|~_))+y[6]+2734768916&4294967295,v=w+(m<<15&4294967295|m>>>17),m=_+(w^(v|~p))+y[13]+1309151649&4294967295,_=v+(m<<21&4294967295|m>>>11),m=p+(v^(_|~w))+y[4]+4149444226&4294967295,p=_+(m<<6&4294967295|m>>>26),m=w+(_^(p|~v))+y[11]+3174756917&4294967295,w=p+(m<<10&4294967295|m>>>22),m=v+(p^(w|~_))+y[2]+718787259&4294967295,v=w+(m<<15&4294967295|m>>>17),m=_+(w^(v|~p))+y[9]+3951481745&4294967295,I.g[0]=I.g[0]+p&4294967295,I.g[1]=I.g[1]+(v+(m<<21&4294967295|m>>>11))&4294967295,I.g[2]=I.g[2]+v&4294967295,I.g[3]=I.g[3]+w&4294967295}i.prototype.u=function(I,p){p===void 0&&(p=I.length);for(var _=p-this.blockSize,y=this.B,v=this.h,w=0;w<p;){if(v==0)for(;w<=_;)s(this,I,w),w+=this.blockSize;if(typeof I=="string"){for(;w<p;)if(y[v++]=I.charCodeAt(w++),v==this.blockSize){s(this,y),v=0;break}}else for(;w<p;)if(y[v++]=I[w++],v==this.blockSize){s(this,y),v=0;break}}this.h=v,this.o+=p},i.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var p=1;p<I.length-8;++p)I[p]=0;var _=8*this.o;for(p=I.length-8;p<I.length;++p)I[p]=_&255,_/=256;for(this.u(I),I=Array(16),p=_=0;4>p;++p)for(var y=0;32>y;y+=8)I[_++]=this.g[p]>>>y&255;return I};function o(I,p){var _=u;return Object.prototype.hasOwnProperty.call(_,I)?_[I]:_[I]=p(I)}function l(I,p){this.h=p;for(var _=[],y=!0,v=I.length-1;0<=v;v--){var w=I[v]|0;y&&w==p||(_[v]=w,y=!1)}this.g=_}var u={};function d(I){return-128<=I&&128>I?o(I,function(p){return new l([p|0],0>p?-1:0)}):new l([I|0],0>I?-1:0)}function f(I){if(isNaN(I)||!isFinite(I))return E;if(0>I)return P(f(-I));for(var p=[],_=1,y=0;I>=_;y++)p[y]=I/_|0,_*=4294967296;return new l(p,0)}function g(I,p){if(I.length==0)throw Error("number format error: empty string");if(p=p||10,2>p||36<p)throw Error("radix out of range: "+p);if(I.charAt(0)=="-")return P(g(I.substring(1),p));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=f(Math.pow(p,8)),y=E,v=0;v<I.length;v+=8){var w=Math.min(8,I.length-v),m=parseInt(I.substring(v,v+w),p);8>w?(w=f(Math.pow(p,w)),y=y.j(w).add(f(m))):(y=y.j(_),y=y.add(f(m)))}return y}var E=d(0),C=d(1),S=d(16777216);n=l.prototype,n.m=function(){if(N(this))return-P(this).m();for(var I=0,p=1,_=0;_<this.g.length;_++){var y=this.i(_);I+=(0<=y?y:4294967296+y)*p,p*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(D(this))return"0";if(N(this))return"-"+P(this).toString(I);for(var p=f(Math.pow(I,6)),_=this,y="";;){var v=oe(_,p).g;_=z(_,v.j(p));var w=((0<_.g.length?_.g[0]:_.h)>>>0).toString(I);if(_=v,D(_))return w+y;for(;6>w.length;)w="0"+w;y=w+y}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function D(I){if(I.h!=0)return!1;for(var p=0;p<I.g.length;p++)if(I.g[p]!=0)return!1;return!0}function N(I){return I.h==-1}n.l=function(I){return I=z(this,I),N(I)?-1:D(I)?0:1};function P(I){for(var p=I.g.length,_=[],y=0;y<p;y++)_[y]=~I.g[y];return new l(_,~I.h).add(C)}n.abs=function(){return N(this)?P(this):this},n.add=function(I){for(var p=Math.max(this.g.length,I.g.length),_=[],y=0,v=0;v<=p;v++){var w=y+(this.i(v)&65535)+(I.i(v)&65535),m=(w>>>16)+(this.i(v)>>>16)+(I.i(v)>>>16);y=m>>>16,w&=65535,m&=65535,_[v]=m<<16|w}return new l(_,_[_.length-1]&-2147483648?-1:0)};function z(I,p){return I.add(P(p))}n.j=function(I){if(D(this)||D(I))return E;if(N(this))return N(I)?P(this).j(P(I)):P(P(this).j(I));if(N(I))return P(this.j(P(I)));if(0>this.l(S)&&0>I.l(S))return f(this.m()*I.m());for(var p=this.g.length+I.g.length,_=[],y=0;y<2*p;y++)_[y]=0;for(y=0;y<this.g.length;y++)for(var v=0;v<I.g.length;v++){var w=this.i(y)>>>16,m=this.i(y)&65535,nt=I.i(v)>>>16,On=I.i(v)&65535;_[2*y+2*v]+=m*On,G(_,2*y+2*v),_[2*y+2*v+1]+=w*On,G(_,2*y+2*v+1),_[2*y+2*v+1]+=m*nt,G(_,2*y+2*v+1),_[2*y+2*v+2]+=w*nt,G(_,2*y+2*v+2)}for(y=0;y<p;y++)_[y]=_[2*y+1]<<16|_[2*y];for(y=p;y<2*p;y++)_[y]=0;return new l(_,0)};function G(I,p){for(;(I[p]&65535)!=I[p];)I[p+1]+=I[p]>>>16,I[p]&=65535,p++}function H(I,p){this.g=I,this.h=p}function oe(I,p){if(D(p))throw Error("division by zero");if(D(I))return new H(E,E);if(N(I))return p=oe(P(I),p),new H(P(p.g),P(p.h));if(N(p))return p=oe(I,P(p)),new H(P(p.g),p.h);if(30<I.g.length){if(N(I)||N(p))throw Error("slowDivide_ only works with positive integers.");for(var _=C,y=p;0>=y.l(I);)_=Le(_),y=Le(y);var v=te(_,1),w=te(y,1);for(y=te(y,2),_=te(_,2);!D(y);){var m=w.add(y);0>=m.l(I)&&(v=v.add(_),w=m),y=te(y,1),_=te(_,1)}return p=z(I,v.j(p)),new H(v,p)}for(v=E;0<=I.l(p);){for(_=Math.max(1,Math.floor(I.m()/p.m())),y=Math.ceil(Math.log(_)/Math.LN2),y=48>=y?1:Math.pow(2,y-48),w=f(_),m=w.j(p);N(m)||0<m.l(I);)_-=y,w=f(_),m=w.j(p);D(w)&&(w=C),v=v.add(w),I=z(I,m)}return new H(v,I)}n.A=function(I){return oe(this,I).h},n.and=function(I){for(var p=Math.max(this.g.length,I.g.length),_=[],y=0;y<p;y++)_[y]=this.i(y)&I.i(y);return new l(_,this.h&I.h)},n.or=function(I){for(var p=Math.max(this.g.length,I.g.length),_=[],y=0;y<p;y++)_[y]=this.i(y)|I.i(y);return new l(_,this.h|I.h)},n.xor=function(I){for(var p=Math.max(this.g.length,I.g.length),_=[],y=0;y<p;y++)_[y]=this.i(y)^I.i(y);return new l(_,this.h^I.h)};function Le(I){for(var p=I.g.length+1,_=[],y=0;y<p;y++)_[y]=I.i(y)<<1|I.i(y-1)>>>31;return new l(_,I.h)}function te(I,p){var _=p>>5;p%=32;for(var y=I.g.length-_,v=[],w=0;w<y;w++)v[w]=0<p?I.i(w+_)>>>p|I.i(w+_+1)<<32-p:I.i(w+_);return new l(v,I.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,Ks=Bc.Md5=i,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=f,l.fromString=g,Ct=Bc.Integer=l}).apply(typeof Fc<"u"?Fc:typeof self<"u"?self:typeof window<"u"?window:{});var or=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},lt={};var Qs,Qf,dn,Ws,ri,ar,Hs,Js,Ys;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(r,a,c){return r==Array.prototype||r==Object.prototype||(r[a]=c.value),r};function t(r){r=[typeof globalThis=="object"&&globalThis,r,typeof window=="object"&&window,typeof self=="object"&&self,typeof or=="object"&&or];for(var a=0;a<r.length;++a){var c=r[a];if(c&&c.Math==Math)return c}throw Error("Cannot find global object")}var i=t(this);function s(r,a){if(a)e:{var c=i;r=r.split(".");for(var h=0;h<r.length-1;h++){var T=r[h];if(!(T in c))break e;c=c[T]}r=r[r.length-1],h=c[r],a=a(h),a!=h&&a!=null&&e(c,r,{configurable:!0,writable:!0,value:a})}}function o(r,a){r instanceof String&&(r+="");var c=0,h=!1,T={next:function(){if(!h&&c<r.length){var b=c++;return{value:a(b,r[b]),done:!1}}return h=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}s("Array.prototype.values",function(r){return r||function(){return o(this,function(a,c){return c})}});var l=l||{},u=this||self;function d(r){var a=typeof r;return a=a!="object"?a:r?Array.isArray(r)?"array":a:"null",a=="array"||a=="object"&&typeof r.length=="number"}function f(r){var a=typeof r;return a=="object"&&r!=null||a=="function"}function g(r,a,c){return r.call.apply(r.bind,arguments)}function E(r,a,c){if(!r)throw Error();if(2<arguments.length){var h=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,h),r.apply(a,T)}}return function(){return r.apply(a,arguments)}}function C(r,a,c){return C=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?g:E,C.apply(null,arguments)}function S(r,a){var c=Array.prototype.slice.call(arguments,1);return function(){var h=c.slice();return h.push.apply(h,arguments),r.apply(this,h)}}function D(r,a){function c(){}c.prototype=a.prototype,r.aa=a.prototype,r.prototype=new c,r.prototype.constructor=r,r.Qb=function(h,T,b){for(var R=Array(arguments.length-2),X=2;X<arguments.length;X++)R[X-2]=arguments[X];return a.prototype[T].apply(h,R)}}function N(r){let a=r.length;if(0<a){let c=Array(a);for(let h=0;h<a;h++)c[h]=r[h];return c}return[]}function P(r,a){for(let c=1;c<arguments.length;c++){let h=arguments[c];if(d(h)){let T=r.length||0,b=h.length||0;r.length=T+b;for(let R=0;R<b;R++)r[T+R]=h[R]}else r.push(h)}}class z{constructor(a,c){this.i=a,this.j=c,this.h=0,this.g=null}get(){let a;return 0<this.h?(this.h--,a=this.g,this.g=a.next,a.next=null):a=this.i(),a}}function G(r){return/^[\s\xa0]*$/.test(r)}function H(){var r=u.navigator;return r&&(r=r.userAgent)?r:""}function oe(r){return oe[" "](r),r}oe[" "]=function(){};var Le=H().indexOf("Gecko")!=-1&&!(H().toLowerCase().indexOf("webkit")!=-1&&H().indexOf("Edge")==-1)&&!(H().indexOf("Trident")!=-1||H().indexOf("MSIE")!=-1)&&H().indexOf("Edge")==-1;function te(r,a,c){for(let h in r)a.call(c,r[h],h,r)}function I(r,a){for(let c in r)a.call(void 0,r[c],c,r)}function p(r){let a={};for(let c in r)a[c]=r[c];return a}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function y(r,a){let c,h;for(let T=1;T<arguments.length;T++){h=arguments[T];for(c in h)r[c]=h[c];for(let b=0;b<_.length;b++)c=_[b],Object.prototype.hasOwnProperty.call(h,c)&&(r[c]=h[c])}}function v(r){var a=1;r=r.split(":");let c=[];for(;0<a&&r.length;)c.push(r.shift()),a--;return r.length&&c.push(r.join(":")),c}function w(r){u.setTimeout(()=>{throw r},0)}function m(){var r=Xr;let a=null;return r.g&&(a=r.g,r.g=r.g.next,r.g||(r.h=null),a.next=null),a}class nt{constructor(){this.h=this.g=null}add(a,c){let h=On.get();h.set(a,c),this.h?this.h.next=h:this.g=h,this.h=h}}var On=new z(()=>new Ph,r=>r.reset());class Ph{constructor(){this.next=this.g=this.h=null}set(a,c){this.h=a,this.g=c,this.next=null}reset(){this.next=this.g=this.h=null}}let Mn,Ln=!1,Xr=new nt,ol=()=>{let r=u.Promise.resolve(void 0);Mn=()=>{r.then(Dh)}};var Dh=()=>{for(var r;r=m();){try{r.h.call(r.g)}catch(c){w(c)}var a=On;a.j(r),100>a.h&&(a.h++,r.next=a.g,a.g=r)}Ln=!1};function pt(){this.s=this.s,this.C=this.C}pt.prototype.s=!1,pt.prototype.ma=function(){this.s||(this.s=!0,this.N())},pt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Te(r,a){this.type=r,this.g=this.target=a,this.defaultPrevented=!1}Te.prototype.h=function(){this.defaultPrevented=!0};var Vh=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var r=!1,a=Object.defineProperty({},"passive",{get:function(){r=!0}});try{let c=()=>{};u.addEventListener("test",c,a),u.removeEventListener("test",c,a)}catch{}return r}();function Fn(r,a){if(Te.call(this,r?r.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,r){var c=this.type=r.type,h=r.changedTouches&&r.changedTouches.length?r.changedTouches[0]:null;if(this.target=r.target||r.srcElement,this.g=a,a=r.relatedTarget){if(Le){e:{try{oe(a.nodeName);var T=!0;break e}catch{}T=!1}T||(a=null)}}else c=="mouseover"?a=r.fromElement:c=="mouseout"&&(a=r.toElement);this.relatedTarget=a,h?(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0):(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=r.button,this.key=r.key||"",this.ctrlKey=r.ctrlKey,this.altKey=r.altKey,this.shiftKey=r.shiftKey,this.metaKey=r.metaKey,this.pointerId=r.pointerId||0,this.pointerType=typeof r.pointerType=="string"?r.pointerType:kh[r.pointerType]||"",this.state=r.state,this.i=r,r.defaultPrevented&&Fn.aa.h.call(this)}}D(Fn,Te);var kh={2:"touch",3:"pen",4:"mouse"};Fn.prototype.h=function(){Fn.aa.h.call(this);var r=this.i;r.preventDefault?r.preventDefault():r.returnValue=!1};var Bn="closure_listenable_"+(1e6*Math.random()|0),Nh=0;function Oh(r,a,c,h,T){this.listener=r,this.proxy=null,this.src=a,this.type=c,this.capture=!!h,this.ha=T,this.key=++Nh,this.da=this.fa=!1}function xi(r){r.da=!0,r.listener=null,r.proxy=null,r.src=null,r.ha=null}function Ri(r){this.src=r,this.g={},this.h=0}Ri.prototype.add=function(r,a,c,h,T){var b=r.toString();r=this.g[b],r||(r=this.g[b]=[],this.h++);var R=es(r,a,h,T);return-1<R?(a=r[R],c||(a.fa=!1)):(a=new Oh(a,this.src,b,!!h,T),a.fa=c,r.push(a)),a};function Zr(r,a){var c=a.type;if(c in r.g){var h=r.g[c],T=Array.prototype.indexOf.call(h,a,void 0),b;(b=0<=T)&&Array.prototype.splice.call(h,T,1),b&&(xi(a),r.g[c].length==0&&(delete r.g[c],r.h--))}}function es(r,a,c,h){for(var T=0;T<r.length;++T){var b=r[T];if(!b.da&&b.listener==a&&b.capture==!!c&&b.ha==h)return T}return-1}var ts="closure_lm_"+(1e6*Math.random()|0),ns={};function al(r,a,c,h,T){if(h&&h.once)return cl(r,a,c,h,T);if(Array.isArray(a)){for(var b=0;b<a.length;b++)al(r,a[b],c,h,T);return null}return c=os(c),r&&r[Bn]?r.K(a,c,f(h)?!!h.capture:!!h,T):ll(r,a,c,!1,h,T)}function ll(r,a,c,h,T,b){if(!a)throw Error("Invalid event type");var R=f(T)?!!T.capture:!!T,X=rs(r);if(X||(r[ts]=X=new Ri(r)),c=X.add(a,c,h,R,b),c.proxy)return c;if(h=Mh(),c.proxy=h,h.src=r,h.listener=c,r.addEventListener)Vh||(T=R),T===void 0&&(T=!1),r.addEventListener(a.toString(),h,T);else if(r.attachEvent)r.attachEvent(hl(a.toString()),h);else if(r.addListener&&r.removeListener)r.addListener(h);else throw Error("addEventListener and attachEvent are unavailable.");return c}function Mh(){function r(c){return a.call(r.src,r.listener,c)}let a=Lh;return r}function cl(r,a,c,h,T){if(Array.isArray(a)){for(var b=0;b<a.length;b++)cl(r,a[b],c,h,T);return null}return c=os(c),r&&r[Bn]?r.L(a,c,f(h)?!!h.capture:!!h,T):ll(r,a,c,!0,h,T)}function ul(r,a,c,h,T){if(Array.isArray(a))for(var b=0;b<a.length;b++)ul(r,a[b],c,h,T);else h=f(h)?!!h.capture:!!h,c=os(c),r&&r[Bn]?(r=r.i,a=String(a).toString(),a in r.g&&(b=r.g[a],c=es(b,c,h,T),-1<c&&(xi(b[c]),Array.prototype.splice.call(b,c,1),b.length==0&&(delete r.g[a],r.h--)))):r&&(r=rs(r))&&(a=r.g[a.toString()],r=-1,a&&(r=es(a,c,h,T)),(c=-1<r?a[r]:null)&&is(c))}function is(r){if(typeof r!="number"&&r&&!r.da){var a=r.src;if(a&&a[Bn])Zr(a.i,r);else{var c=r.type,h=r.proxy;a.removeEventListener?a.removeEventListener(c,h,r.capture):a.detachEvent?a.detachEvent(hl(c),h):a.addListener&&a.removeListener&&a.removeListener(h),(c=rs(a))?(Zr(c,r),c.h==0&&(c.src=null,a[ts]=null)):xi(r)}}}function hl(r){return r in ns?ns[r]:ns[r]="on"+r}function Lh(r,a){if(r.da)r=!0;else{a=new Fn(a,this);var c=r.listener,h=r.ha||r.src;r.fa&&is(r),r=c.call(h,a)}return r}function rs(r){return r=r[ts],r instanceof Ri?r:null}var ss="__closure_events_fn_"+(1e9*Math.random()>>>0);function os(r){return typeof r=="function"?r:(r[ss]||(r[ss]=function(a){return r.handleEvent(a)}),r[ss])}function we(){pt.call(this),this.i=new Ri(this),this.M=this,this.F=null}D(we,pt),we.prototype[Bn]=!0,we.prototype.removeEventListener=function(r,a,c,h){ul(this,r,a,c,h)};function Re(r,a){var c,h=r.F;if(h)for(c=[];h;h=h.F)c.push(h);if(r=r.M,h=a.type||a,typeof a=="string")a=new Te(a,r);else if(a instanceof Te)a.target=a.target||r;else{var T=a;a=new Te(h,r),y(a,T)}if(T=!0,c)for(var b=c.length-1;0<=b;b--){var R=a.g=c[b];T=Pi(R,h,!0,a)&&T}if(R=a.g=r,T=Pi(R,h,!0,a)&&T,T=Pi(R,h,!1,a)&&T,c)for(b=0;b<c.length;b++)R=a.g=c[b],T=Pi(R,h,!1,a)&&T}we.prototype.N=function(){if(we.aa.N.call(this),this.i){var r=this.i,a;for(a in r.g){for(var c=r.g[a],h=0;h<c.length;h++)xi(c[h]);delete r.g[a],r.h--}}this.F=null},we.prototype.K=function(r,a,c,h){return this.i.add(String(r),a,!1,c,h)},we.prototype.L=function(r,a,c,h){return this.i.add(String(r),a,!0,c,h)};function Pi(r,a,c,h){if(a=r.i.g[String(a)],!a)return!0;a=a.concat();for(var T=!0,b=0;b<a.length;++b){var R=a[b];if(R&&!R.da&&R.capture==c){var X=R.listener,ve=R.ha||R.src;R.fa&&Zr(r.i,R),T=X.call(ve,h)!==!1&&T}}return T&&!h.defaultPrevented}function dl(r,a,c){if(typeof r=="function")c&&(r=C(r,c));else if(r&&typeof r.handleEvent=="function")r=C(r.handleEvent,r);else throw Error("Invalid listener argument");return 2147483647<Number(a)?-1:u.setTimeout(r,a||0)}function fl(r){r.g=dl(()=>{r.g=null,r.i&&(r.i=!1,fl(r))},r.l);let a=r.h;r.h=null,r.m.apply(null,a)}class Fh extends pt{constructor(a,c){super(),this.m=a,this.l=c,this.h=null,this.i=!1,this.g=null}j(a){this.h=arguments,this.g?this.i=!0:fl(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function qn(r){pt.call(this),this.h=r,this.g={}}D(qn,pt);var pl=[];function ml(r){te(r.g,function(a,c){this.g.hasOwnProperty(c)&&is(a)},r),r.g={}}qn.prototype.N=function(){qn.aa.N.call(this),ml(this)},qn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var as=u.JSON.stringify,Bh=u.JSON.parse,qh=class{stringify(r){return u.JSON.stringify(r,void 0)}parse(r){return u.JSON.parse(r,void 0)}};function ls(){}ls.prototype.h=null;function gl(r){return r.h||(r.h=r.i())}function _l(){}var Un={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function cs(){Te.call(this,"d")}D(cs,Te);function us(){Te.call(this,"c")}D(us,Te);var Vt={},yl=null;function Di(){return yl=yl||new we}Vt.La="serverreachability";function vl(r){Te.call(this,Vt.La,r)}D(vl,Te);function zn(r){let a=Di();Re(a,new vl(a))}Vt.STAT_EVENT="statevent";function Il(r,a){Te.call(this,Vt.STAT_EVENT,r),this.stat=a}D(Il,Te);function Pe(r){let a=Di();Re(a,new Il(a,r))}Vt.Ma="timingevent";function Tl(r,a){Te.call(this,Vt.Ma,r),this.size=a}D(Tl,Te);function jn(r,a){if(typeof r!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){r()},a)}function $n(){this.g=!0}$n.prototype.xa=function(){this.g=!1};function Uh(r,a,c,h,T,b){r.info(function(){if(r.g)if(b)for(var R="",X=b.split("&"),ve=0;ve<X.length;ve++){var K=X[ve].split("=");if(1<K.length){var Ee=K[0];K=K[1];var be=Ee.split("_");R=2<=be.length&&be[1]=="type"?R+(Ee+"="+K+"&"):R+(Ee+"=redacted&")}}else R=null;else R=b;return"XMLHTTP REQ ("+h+") [attempt "+T+"]: "+a+`
`+c+`
`+R})}function zh(r,a,c,h,T,b,R){r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+T+"]: "+a+`
`+c+`
`+b+" "+R})}function Zt(r,a,c,h){r.info(function(){return"XMLHTTP TEXT ("+a+"): "+$h(r,c)+(h?" "+h:"")})}function jh(r,a){r.info(function(){return"TIMEOUT: "+a})}$n.prototype.info=function(){};function $h(r,a){if(!r.g)return a;if(!a)return null;try{var c=JSON.parse(a);if(c){for(r=0;r<c.length;r++)if(Array.isArray(c[r])){var h=c[r];if(!(2>h.length)){var T=h[1];if(Array.isArray(T)&&!(1>T.length)){var b=T[0];if(b!="noop"&&b!="stop"&&b!="close")for(var R=1;R<T.length;R++)T[R]=""}}}}return as(c)}catch{return a}}var Vi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},wl={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},hs;function ki(){}D(ki,ls),ki.prototype.g=function(){return new XMLHttpRequest},ki.prototype.i=function(){return{}},hs=new ki;function mt(r,a,c,h){this.j=r,this.i=a,this.l=c,this.R=h||1,this.U=new qn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new El}function El(){this.i=null,this.g="",this.h=!1}var bl={},ds={};function fs(r,a,c){r.L=1,r.v=Li(it(a)),r.m=c,r.P=!0,Cl(r,null)}function Cl(r,a){r.F=Date.now(),Ni(r),r.A=it(r.v);var c=r.A,h=r.R;Array.isArray(h)||(h=[String(h)]),Bl(c.i,"t",h),r.C=0,c=r.j.J,r.h=new El,r.g=ic(r.j,c?a:null,!r.m),0<r.O&&(r.M=new Fh(C(r.Y,r,r.g),r.O)),a=r.U,c=r.g,h=r.ca;var T="readystatechange";Array.isArray(T)||(T&&(pl[0]=T.toString()),T=pl);for(var b=0;b<T.length;b++){var R=al(c,T[b],h||a.handleEvent,!1,a.h||a);if(!R)break;a.g[R.key]=R}a=r.H?p(r.H):{},r.m?(r.u||(r.u="POST"),a["Content-Type"]="application/x-www-form-urlencoded",r.g.ea(r.A,r.u,r.m,a)):(r.u="GET",r.g.ea(r.A,r.u,null,a)),zn(),Uh(r.i,r.u,r.A,r.l,r.R,r.m)}mt.prototype.ca=function(r){r=r.target;let a=this.M;a&&rt(r)==3?a.j():this.Y(r)},mt.prototype.Y=function(r){try{if(r==this.g)e:{let be=rt(this.g);var a=this.g.Ba();let nn=this.g.Z();if(!(3>be)&&(be!=3||this.g&&(this.h.h||this.g.oa()||Kl(this.g)))){this.J||be!=4||a==7||(a==8||0>=nn?zn(3):zn(2)),ps(this);var c=this.g.Z();this.X=c;t:if(Al(this)){var h=Kl(this.g);r="";var T=h.length,b=rt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){kt(this),Gn(this);var R="";break t}this.h.i=new u.TextDecoder}for(a=0;a<T;a++)this.h.h=!0,r+=this.h.i.decode(h[a],{stream:!(b&&a==T-1)});h.length=0,this.h.g+=r,this.C=0,R=this.h.g}else R=this.g.oa();if(this.o=c==200,zh(this.i,this.u,this.A,this.l,this.R,be,c),this.o){if(this.T&&!this.K){t:{if(this.g){var X,ve=this.g;if((X=ve.g?ve.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!G(X)){var K=X;break t}}K=null}if(c=K)Zt(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ms(this,c);else{this.o=!1,this.s=3,Pe(12),kt(this),Gn(this);break e}}if(this.P){c=!0;let qe;for(;!this.J&&this.C<R.length;)if(qe=Gh(this,R),qe==ds){be==4&&(this.s=4,Pe(14),c=!1),Zt(this.i,this.l,null,"[Incomplete Response]");break}else if(qe==bl){this.s=4,Pe(15),Zt(this.i,this.l,R,"[Invalid Chunk]"),c=!1;break}else Zt(this.i,this.l,qe,null),ms(this,qe);if(Al(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),be!=4||R.length!=0||this.h.h||(this.s=1,Pe(16),c=!1),this.o=this.o&&c,!c)Zt(this.i,this.l,R,"[Invalid Chunked Response]"),kt(this),Gn(this);else if(0<R.length&&!this.W){this.W=!0;var Ee=this.j;Ee.g==this&&Ee.ba&&!Ee.M&&(Ee.j.info("Great, no buffering proxy detected. Bytes received: "+R.length),Ts(Ee),Ee.M=!0,Pe(11))}}else Zt(this.i,this.l,R,null),ms(this,R);be==4&&kt(this),this.o&&!this.J&&(be==4?Zl(this.j,this):(this.o=!1,Ni(this)))}else ld(this.g),c==400&&0<R.indexOf("Unknown SID")?(this.s=3,Pe(12)):(this.s=0,Pe(13)),kt(this),Gn(this)}}}catch{}finally{}};function Al(r){return r.g?r.u=="GET"&&r.L!=2&&r.j.Ca:!1}function Gh(r,a){var c=r.C,h=a.indexOf(`
`,c);return h==-1?ds:(c=Number(a.substring(c,h)),isNaN(c)?bl:(h+=1,h+c>a.length?ds:(a=a.slice(h,h+c),r.C=h+c,a)))}mt.prototype.cancel=function(){this.J=!0,kt(this)};function Ni(r){r.S=Date.now()+r.I,Sl(r,r.I)}function Sl(r,a){if(r.B!=null)throw Error("WatchDog timer not null");r.B=jn(C(r.ba,r),a)}function ps(r){r.B&&(u.clearTimeout(r.B),r.B=null)}mt.prototype.ba=function(){this.B=null;let r=Date.now();0<=r-this.S?(jh(this.i,this.A),this.L!=2&&(zn(),Pe(17)),kt(this),this.s=2,Gn(this)):Sl(this,this.S-r)};function Gn(r){r.j.G==0||r.J||Zl(r.j,r)}function kt(r){ps(r);var a=r.M;a&&typeof a.ma=="function"&&a.ma(),r.M=null,ml(r.U),r.g&&(a=r.g,r.g=null,a.abort(),a.ma())}function ms(r,a){try{var c=r.j;if(c.G!=0&&(c.g==r||gs(c.h,r))){if(!r.K&&gs(c.h,r)&&c.G==3){try{var h=c.Da.g.parse(a)}catch{h=null}if(Array.isArray(h)&&h.length==3){var T=h;if(T[0]==0){e:if(!c.u){if(c.g)if(c.g.F+3e3<r.F)zi(c),qi(c);else break e;Is(c),Pe(18)}}else c.za=T[1],0<c.za-c.T&&37500>T[2]&&c.F&&c.v==0&&!c.C&&(c.C=jn(C(c.Za,c),6e3));if(1>=Pl(c.h)&&c.ca){try{c.ca()}catch{}c.ca=void 0}}else Ot(c,11)}else if((r.K||c.g==r)&&zi(c),!G(a))for(T=c.Da.g.parse(a),a=0;a<T.length;a++){let K=T[a];if(c.T=K[0],K=K[1],c.G==2)if(K[0]=="c"){c.K=K[1],c.ia=K[2];let Ee=K[3];Ee!=null&&(c.la=Ee,c.j.info("VER="+c.la));let be=K[4];be!=null&&(c.Aa=be,c.j.info("SVER="+c.Aa));let nn=K[5];nn!=null&&typeof nn=="number"&&0<nn&&(h=1.5*nn,c.L=h,c.j.info("backChannelRequestTimeoutMs_="+h)),h=c;let qe=r.g;if(qe){let $i=qe.g?qe.g.getResponseHeader("X-Client-Wire-Protocol"):null;if($i){var b=h.h;b.g||$i.indexOf("spdy")==-1&&$i.indexOf("quic")==-1&&$i.indexOf("h2")==-1||(b.j=b.l,b.g=new Set,b.h&&(_s(b,b.h),b.h=null))}if(h.D){let ws=qe.g?qe.g.getResponseHeader("X-HTTP-Session-Id"):null;ws&&(h.ya=ws,ne(h.I,h.D,ws))}}c.G=3,c.l&&c.l.ua(),c.ba&&(c.R=Date.now()-r.F,c.j.info("Handshake RTT: "+c.R+"ms")),h=c;var R=r;if(h.qa=nc(h,h.J?h.ia:null,h.W),R.K){Dl(h.h,R);var X=R,ve=h.L;ve&&(X.I=ve),X.B&&(ps(X),Ni(X)),h.g=R}else Yl(h);0<c.i.length&&Ui(c)}else K[0]!="stop"&&K[0]!="close"||Ot(c,7);else c.G==3&&(K[0]=="stop"||K[0]=="close"?K[0]=="stop"?Ot(c,7):vs(c):K[0]!="noop"&&c.l&&c.l.ta(K),c.v=0)}}zn(4)}catch{}}var Kh=class{constructor(r,a){this.g=r,this.map=a}};function xl(r){this.l=r||10,u.PerformanceNavigationTiming?(r=u.performance.getEntriesByType("navigation"),r=0<r.length&&(r[0].nextHopProtocol=="hq"||r[0].nextHopProtocol=="h2")):r=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=r?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Rl(r){return r.h?!0:r.g?r.g.size>=r.j:!1}function Pl(r){return r.h?1:r.g?r.g.size:0}function gs(r,a){return r.h?r.h==a:r.g?r.g.has(a):!1}function _s(r,a){r.g?r.g.add(a):r.h=a}function Dl(r,a){r.h&&r.h==a?r.h=null:r.g&&r.g.has(a)&&r.g.delete(a)}xl.prototype.cancel=function(){if(this.i=Vl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let r of this.g.values())r.cancel();this.g.clear()}};function Vl(r){if(r.h!=null)return r.i.concat(r.h.D);if(r.g!=null&&r.g.size!==0){let a=r.i;for(let c of r.g.values())a=a.concat(c.D);return a}return N(r.i)}function Qh(r){if(r.V&&typeof r.V=="function")return r.V();if(typeof Map<"u"&&r instanceof Map||typeof Set<"u"&&r instanceof Set)return Array.from(r.values());if(typeof r=="string")return r.split("");if(d(r)){for(var a=[],c=r.length,h=0;h<c;h++)a.push(r[h]);return a}a=[],c=0;for(h in r)a[c++]=r[h];return a}function Wh(r){if(r.na&&typeof r.na=="function")return r.na();if(!r.V||typeof r.V!="function"){if(typeof Map<"u"&&r instanceof Map)return Array.from(r.keys());if(!(typeof Set<"u"&&r instanceof Set)){if(d(r)||typeof r=="string"){var a=[];r=r.length;for(var c=0;c<r;c++)a.push(c);return a}a=[],c=0;for(let h in r)a[c++]=h;return a}}}function kl(r,a){if(r.forEach&&typeof r.forEach=="function")r.forEach(a,void 0);else if(d(r)||typeof r=="string")Array.prototype.forEach.call(r,a,void 0);else for(var c=Wh(r),h=Qh(r),T=h.length,b=0;b<T;b++)a.call(void 0,h[b],c&&c[b],r)}var Nl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Hh(r,a){if(r){r=r.split("&");for(var c=0;c<r.length;c++){var h=r[c].indexOf("="),T=null;if(0<=h){var b=r[c].substring(0,h);T=r[c].substring(h+1)}else b=r[c];a(b,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function Nt(r){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,r instanceof Nt){this.h=r.h,Oi(this,r.j),this.o=r.o,this.g=r.g,Mi(this,r.s),this.l=r.l;var a=r.i,c=new Wn;c.i=a.i,a.g&&(c.g=new Map(a.g),c.h=a.h),Ol(this,c),this.m=r.m}else r&&(a=String(r).match(Nl))?(this.h=!1,Oi(this,a[1]||"",!0),this.o=Kn(a[2]||""),this.g=Kn(a[3]||"",!0),Mi(this,a[4]),this.l=Kn(a[5]||"",!0),Ol(this,a[6]||"",!0),this.m=Kn(a[7]||"")):(this.h=!1,this.i=new Wn(null,this.h))}Nt.prototype.toString=function(){var r=[],a=this.j;a&&r.push(Qn(a,Ml,!0),":");var c=this.g;return(c||a=="file")&&(r.push("//"),(a=this.o)&&r.push(Qn(a,Ml,!0),"@"),r.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.s,c!=null&&r.push(":",String(c))),(c=this.l)&&(this.g&&c.charAt(0)!="/"&&r.push("/"),r.push(Qn(c,c.charAt(0)=="/"?Xh:Yh,!0))),(c=this.i.toString())&&r.push("?",c),(c=this.m)&&r.push("#",Qn(c,ed)),r.join("")};function it(r){return new Nt(r)}function Oi(r,a,c){r.j=c?Kn(a,!0):a,r.j&&(r.j=r.j.replace(/:$/,""))}function Mi(r,a){if(a){if(a=Number(a),isNaN(a)||0>a)throw Error("Bad port number "+a);r.s=a}else r.s=null}function Ol(r,a,c){a instanceof Wn?(r.i=a,td(r.i,r.h)):(c||(a=Qn(a,Zh)),r.i=new Wn(a,r.h))}function ne(r,a,c){r.i.set(a,c)}function Li(r){return ne(r,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),r}function Kn(r,a){return r?a?decodeURI(r.replace(/%25/g,"%2525")):decodeURIComponent(r):""}function Qn(r,a,c){return typeof r=="string"?(r=encodeURI(r).replace(a,Jh),c&&(r=r.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),r):null}function Jh(r){return r=r.charCodeAt(0),"%"+(r>>4&15).toString(16)+(r&15).toString(16)}var Ml=/[#\/\?@]/g,Yh=/[#\?:]/g,Xh=/[#\?]/g,Zh=/[#\?@]/g,ed=/#/g;function Wn(r,a){this.h=this.g=null,this.i=r||null,this.j=!!a}function gt(r){r.g||(r.g=new Map,r.h=0,r.i&&Hh(r.i,function(a,c){r.add(decodeURIComponent(a.replace(/\+/g," ")),c)}))}n=Wn.prototype,n.add=function(r,a){gt(this),this.i=null,r=en(this,r);var c=this.g.get(r);return c||this.g.set(r,c=[]),c.push(a),this.h+=1,this};function Ll(r,a){gt(r),a=en(r,a),r.g.has(a)&&(r.i=null,r.h-=r.g.get(a).length,r.g.delete(a))}function Fl(r,a){return gt(r),a=en(r,a),r.g.has(a)}n.forEach=function(r,a){gt(this),this.g.forEach(function(c,h){c.forEach(function(T){r.call(a,T,h,this)},this)},this)},n.na=function(){gt(this);let r=Array.from(this.g.values()),a=Array.from(this.g.keys()),c=[];for(let h=0;h<a.length;h++){let T=r[h];for(let b=0;b<T.length;b++)c.push(a[h])}return c},n.V=function(r){gt(this);let a=[];if(typeof r=="string")Fl(this,r)&&(a=a.concat(this.g.get(en(this,r))));else{r=Array.from(this.g.values());for(let c=0;c<r.length;c++)a=a.concat(r[c])}return a},n.set=function(r,a){return gt(this),this.i=null,r=en(this,r),Fl(this,r)&&(this.h-=this.g.get(r).length),this.g.set(r,[a]),this.h+=1,this},n.get=function(r,a){return r?(r=this.V(r),0<r.length?String(r[0]):a):a};function Bl(r,a,c){Ll(r,a),0<c.length&&(r.i=null,r.g.set(en(r,a),N(c)),r.h+=c.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let r=[],a=Array.from(this.g.keys());for(var c=0;c<a.length;c++){var h=a[c];let b=encodeURIComponent(String(h)),R=this.V(h);for(h=0;h<R.length;h++){var T=b;R[h]!==""&&(T+="="+encodeURIComponent(String(R[h]))),r.push(T)}}return this.i=r.join("&")};function en(r,a){return a=String(a),r.j&&(a=a.toLowerCase()),a}function td(r,a){a&&!r.j&&(gt(r),r.i=null,r.g.forEach(function(c,h){var T=h.toLowerCase();h!=T&&(Ll(this,h),Bl(this,T,c))},r)),r.j=a}function nd(r,a){let c=new $n;if(u.Image){let h=new Image;h.onload=S(_t,c,"TestLoadImage: loaded",!0,a,h),h.onerror=S(_t,c,"TestLoadImage: error",!1,a,h),h.onabort=S(_t,c,"TestLoadImage: abort",!1,a,h),h.ontimeout=S(_t,c,"TestLoadImage: timeout",!1,a,h),u.setTimeout(function(){h.ontimeout&&h.ontimeout()},1e4),h.src=r}else a(!1)}function id(r,a){let c=new $n,h=new AbortController,T=setTimeout(()=>{h.abort(),_t(c,"TestPingServer: timeout",!1,a)},1e4);fetch(r,{signal:h.signal}).then(b=>{clearTimeout(T),b.ok?_t(c,"TestPingServer: ok",!0,a):_t(c,"TestPingServer: server error",!1,a)}).catch(()=>{clearTimeout(T),_t(c,"TestPingServer: error",!1,a)})}function _t(r,a,c,h,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),h(c)}catch{}}function rd(){this.g=new qh}function sd(r,a,c){let h=c||"";try{kl(r,function(T,b){let R=T;f(T)&&(R=as(T)),a.push(h+b+"="+encodeURIComponent(R))})}catch(T){throw a.push(h+"type="+encodeURIComponent("_badmap")),T}}function Hn(r){this.l=r.Ub||null,this.j=r.eb||!1}D(Hn,ls),Hn.prototype.g=function(){return new Fi(this.l,this.j)},Hn.prototype.i=function(r){return function(){return r}}({});function Fi(r,a){we.call(this),this.D=r,this.o=a,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}D(Fi,we),n=Fi.prototype,n.open=function(r,a){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=r,this.A=a,this.readyState=1,Yn(this)},n.send=function(r){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let a={headers:this.u,method:this.B,credentials:this.m,cache:void 0};r&&(a.body=r),(this.D||u).fetch(new Request(this.A,a)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Jn(this)),this.readyState=0},n.Sa=function(r){if(this.g&&(this.l=r,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=r.headers,this.readyState=2,Yn(this)),this.g&&(this.readyState=3,Yn(this),this.g)))if(this.responseType==="arraybuffer")r.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in r){if(this.j=r.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ql(this)}else r.text().then(this.Ra.bind(this),this.ga.bind(this))};function ql(r){r.j.read().then(r.Pa.bind(r)).catch(r.ga.bind(r))}n.Pa=function(r){if(this.g){if(this.o&&r.value)this.response.push(r.value);else if(!this.o){var a=r.value?r.value:new Uint8Array(0);(a=this.v.decode(a,{stream:!r.done}))&&(this.response=this.responseText+=a)}r.done?Jn(this):Yn(this),this.readyState==3&&ql(this)}},n.Ra=function(r){this.g&&(this.response=this.responseText=r,Jn(this))},n.Qa=function(r){this.g&&(this.response=r,Jn(this))},n.ga=function(){this.g&&Jn(this)};function Jn(r){r.readyState=4,r.l=null,r.j=null,r.v=null,Yn(r)}n.setRequestHeader=function(r,a){this.u.append(r,a)},n.getResponseHeader=function(r){return this.h&&this.h.get(r.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let r=[],a=this.h.entries();for(var c=a.next();!c.done;)c=c.value,r.push(c[0]+": "+c[1]),c=a.next();return r.join(`\r
`)};function Yn(r){r.onreadystatechange&&r.onreadystatechange.call(r)}Object.defineProperty(Fi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(r){this.m=r?"include":"same-origin"}});function Ul(r){let a="";return te(r,function(c,h){a+=h,a+=":",a+=c,a+=`\r
`}),a}function ys(r,a,c){e:{for(h in c){var h=!1;break e}h=!0}h||(c=Ul(c),typeof r=="string"?c!=null&&encodeURIComponent(String(c)):ne(r,a,c))}function ae(r){we.call(this),this.headers=new Map,this.o=r||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}D(ae,we);var od=/^https?$/i,ad=["POST","PUT"];n=ae.prototype,n.Ha=function(r){this.J=r},n.ea=function(r,a,c,h){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+r);a=a?a.toUpperCase():"GET",this.D=r,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():hs.g(),this.v=this.o?gl(this.o):gl(hs),this.g.onreadystatechange=C(this.Ea,this);try{this.B=!0,this.g.open(a,String(r),!0),this.B=!1}catch(b){zl(this,b);return}if(r=c||"",c=new Map(this.headers),h)if(Object.getPrototypeOf(h)===Object.prototype)for(var T in h)c.set(T,h[T]);else if(typeof h.keys=="function"&&typeof h.get=="function")for(let b of h.keys())c.set(b,h.get(b));else throw Error("Unknown input type for opt_headers: "+String(h));h=Array.from(c.keys()).find(b=>b.toLowerCase()=="content-type"),T=u.FormData&&r instanceof u.FormData,!(0<=Array.prototype.indexOf.call(ad,a,void 0))||h||T||c.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[b,R]of c)this.g.setRequestHeader(b,R);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Gl(this),this.u=!0,this.g.send(r),this.u=!1}catch(b){zl(this,b)}};function zl(r,a){r.h=!1,r.g&&(r.j=!0,r.g.abort(),r.j=!1),r.l=a,r.m=5,jl(r),Bi(r)}function jl(r){r.A||(r.A=!0,Re(r,"complete"),Re(r,"error"))}n.abort=function(r){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=r||7,Re(this,"complete"),Re(this,"abort"),Bi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Bi(this,!0)),ae.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?$l(this):this.bb())},n.bb=function(){$l(this)};function $l(r){if(r.h&&typeof l<"u"&&(!r.v[1]||rt(r)!=4||r.Z()!=2)){if(r.u&&rt(r)==4)dl(r.Ea,0,r);else if(Re(r,"readystatechange"),rt(r)==4){r.h=!1;try{let R=r.Z();e:switch(R){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var a=!0;break e;default:a=!1}var c;if(!(c=a)){var h;if(h=R===0){var T=String(r.D).match(Nl)[1]||null;!T&&u.self&&u.self.location&&(T=u.self.location.protocol.slice(0,-1)),h=!od.test(T?T.toLowerCase():"")}c=h}if(c)Re(r,"complete"),Re(r,"success");else{r.m=6;try{var b=2<rt(r)?r.g.statusText:""}catch{b=""}r.l=b+" ["+r.Z()+"]",jl(r)}}finally{Bi(r)}}}}function Bi(r,a){if(r.g){Gl(r);let c=r.g,h=r.v[0]?()=>{}:null;r.g=null,r.v=null,a||Re(r,"ready");try{c.onreadystatechange=h}catch{}}}function Gl(r){r.I&&(u.clearTimeout(r.I),r.I=null)}n.isActive=function(){return!!this.g};function rt(r){return r.g?r.g.readyState:0}n.Z=function(){try{return 2<rt(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(r){if(this.g){var a=this.g.responseText;return r&&a.indexOf(r)==0&&(a=a.substring(r.length)),Bh(a)}};function Kl(r){try{if(!r.g)return null;if("response"in r.g)return r.g.response;switch(r.H){case"":case"text":return r.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in r.g)return r.g.mozResponseArrayBuffer}return null}catch{return null}}function ld(r){let a={};r=(r.g&&2<=rt(r)&&r.g.getAllResponseHeaders()||"").split(`\r
`);for(let h=0;h<r.length;h++){if(G(r[h]))continue;var c=v(r[h]);let T=c[0];if(c=c[1],typeof c!="string")continue;c=c.trim();let b=a[T]||[];a[T]=b,b.push(c)}I(a,function(h){return h.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Xn(r,a,c){return c&&c.internalChannelParams&&c.internalChannelParams[r]||a}function Ql(r){this.Aa=0,this.i=[],this.j=new $n,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Xn("failFast",!1,r),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Xn("baseRetryDelayMs",5e3,r),this.cb=Xn("retryDelaySeedMs",1e4,r),this.Wa=Xn("forwardChannelMaxRetries",2,r),this.wa=Xn("forwardChannelRequestTimeoutMs",2e4,r),this.pa=r&&r.xmlHttpFactory||void 0,this.Xa=r&&r.Tb||void 0,this.Ca=r&&r.useFetchStreams||!1,this.L=void 0,this.J=r&&r.supportsCrossDomainXhr||!1,this.K="",this.h=new xl(r&&r.concurrentRequestLimit),this.Da=new rd,this.P=r&&r.fastHandshake||!1,this.O=r&&r.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=r&&r.Rb||!1,r&&r.xa&&this.j.xa(),r&&r.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&r&&r.detectBufferingProxy||!1,this.ja=void 0,r&&r.longPollingTimeout&&0<r.longPollingTimeout&&(this.ja=r.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Ql.prototype,n.la=8,n.G=1,n.connect=function(r,a,c,h){Pe(0),this.W=r,this.H=a||{},c&&h!==void 0&&(this.H.OSID=c,this.H.OAID=h),this.F=this.X,this.I=nc(this,null,this.W),Ui(this)};function vs(r){if(Wl(r),r.G==3){var a=r.U++,c=it(r.I);if(ne(c,"SID",r.K),ne(c,"RID",a),ne(c,"TYPE","terminate"),Zn(r,c),a=new mt(r,r.j,a),a.L=2,a.v=Li(it(c)),c=!1,u.navigator&&u.navigator.sendBeacon)try{c=u.navigator.sendBeacon(a.v.toString(),"")}catch{}!c&&u.Image&&(new Image().src=a.v,c=!0),c||(a.g=ic(a.j,null),a.g.ea(a.v)),a.F=Date.now(),Ni(a)}tc(r)}function qi(r){r.g&&(Ts(r),r.g.cancel(),r.g=null)}function Wl(r){qi(r),r.u&&(u.clearTimeout(r.u),r.u=null),zi(r),r.h.cancel(),r.s&&(typeof r.s=="number"&&u.clearTimeout(r.s),r.s=null)}function Ui(r){if(!Rl(r.h)&&!r.s){r.s=!0;var a=r.Ga;Mn||ol(),Ln||(Mn(),Ln=!0),Xr.add(a,r),r.B=0}}function cd(r,a){return Pl(r.h)>=r.h.j-(r.s?1:0)?!1:r.s?(r.i=a.D.concat(r.i),!0):r.G==1||r.G==2||r.B>=(r.Va?0:r.Wa)?!1:(r.s=jn(C(r.Ga,r,a),ec(r,r.B)),r.B++,!0)}n.Ga=function(r){if(this.s)if(this.s=null,this.G==1){if(!r){this.U=Math.floor(1e5*Math.random()),r=this.U++;let T=new mt(this,this.j,r),b=this.o;if(this.S&&(b?(b=p(b),y(b,this.S)):b=this.S),this.m!==null||this.O||(T.H=b,b=null),this.P)e:{for(var a=0,c=0;c<this.i.length;c++){t:{var h=this.i[c];if("__data__"in h.map&&(h=h.map.__data__,typeof h=="string")){h=h.length;break t}h=void 0}if(h===void 0)break;if(a+=h,4096<a){a=c;break e}if(a===4096||c===this.i.length-1){a=c+1;break e}}a=1e3}else a=1e3;a=Jl(this,T,a),c=it(this.I),ne(c,"RID",r),ne(c,"CVER",22),this.D&&ne(c,"X-HTTP-Session-Id",this.D),Zn(this,c),b&&(this.O?a="headers="+encodeURIComponent(String(Ul(b)))+"&"+a:this.m&&ys(c,this.m,b)),_s(this.h,T),this.Ua&&ne(c,"TYPE","init"),this.P?(ne(c,"$req",a),ne(c,"SID","null"),T.T=!0,fs(T,c,null)):fs(T,c,a),this.G=2}}else this.G==3&&(r?Hl(this,r):this.i.length==0||Rl(this.h)||Hl(this))};function Hl(r,a){var c;a?c=a.l:c=r.U++;let h=it(r.I);ne(h,"SID",r.K),ne(h,"RID",c),ne(h,"AID",r.T),Zn(r,h),r.m&&r.o&&ys(h,r.m,r.o),c=new mt(r,r.j,c,r.B+1),r.m===null&&(c.H=r.o),a&&(r.i=a.D.concat(r.i)),a=Jl(r,c,1e3),c.I=Math.round(.5*r.wa)+Math.round(.5*r.wa*Math.random()),_s(r.h,c),fs(c,h,a)}function Zn(r,a){r.H&&te(r.H,function(c,h){ne(a,h,c)}),r.l&&kl({},function(c,h){ne(a,h,c)})}function Jl(r,a,c){c=Math.min(r.i.length,c);var h=r.l?C(r.l.Na,r.l,r):null;e:{var T=r.i;let b=-1;for(;;){let R=["count="+c];b==-1?0<c?(b=T[0].g,R.push("ofs="+b)):b=0:R.push("ofs="+b);let X=!0;for(let ve=0;ve<c;ve++){let K=T[ve].g,Ee=T[ve].map;if(K-=b,0>K)b=Math.max(0,T[ve].g-100),X=!1;else try{sd(Ee,R,"req"+K+"_")}catch{h&&h(Ee)}}if(X){h=R.join("&");break e}}}return r=r.i.splice(0,c),a.D=r,h}function Yl(r){if(!r.g&&!r.u){r.Y=1;var a=r.Fa;Mn||ol(),Ln||(Mn(),Ln=!0),Xr.add(a,r),r.v=0}}function Is(r){return r.g||r.u||3<=r.v?!1:(r.Y++,r.u=jn(C(r.Fa,r),ec(r,r.v)),r.v++,!0)}n.Fa=function(){if(this.u=null,Xl(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var r=2*this.R;this.j.info("BP detection timer enabled: "+r),this.A=jn(C(this.ab,this),r)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Pe(10),qi(this),Xl(this))};function Ts(r){r.A!=null&&(u.clearTimeout(r.A),r.A=null)}function Xl(r){r.g=new mt(r,r.j,"rpc",r.Y),r.m===null&&(r.g.H=r.o),r.g.O=0;var a=it(r.qa);ne(a,"RID","rpc"),ne(a,"SID",r.K),ne(a,"AID",r.T),ne(a,"CI",r.F?"0":"1"),!r.F&&r.ja&&ne(a,"TO",r.ja),ne(a,"TYPE","xmlhttp"),Zn(r,a),r.m&&r.o&&ys(a,r.m,r.o),r.L&&(r.g.I=r.L);var c=r.g;r=r.ia,c.L=1,c.v=Li(it(a)),c.m=null,c.P=!0,Cl(c,r)}n.Za=function(){this.C!=null&&(this.C=null,qi(this),Is(this),Pe(19))};function zi(r){r.C!=null&&(u.clearTimeout(r.C),r.C=null)}function Zl(r,a){var c=null;if(r.g==a){zi(r),Ts(r),r.g=null;var h=2}else if(gs(r.h,a))c=a.D,Dl(r.h,a),h=1;else return;if(r.G!=0){if(a.o)if(h==1){c=a.m?a.m.length:0,a=Date.now()-a.F;var T=r.B;h=Di(),Re(h,new Tl(h,c)),Ui(r)}else Yl(r);else if(T=a.s,T==3||T==0&&0<a.X||!(h==1&&cd(r,a)||h==2&&Is(r)))switch(c&&0<c.length&&(a=r.h,a.i=a.i.concat(c)),T){case 1:Ot(r,5);break;case 4:Ot(r,10);break;case 3:Ot(r,6);break;default:Ot(r,2)}}}function ec(r,a){let c=r.Ta+Math.floor(Math.random()*r.cb);return r.isActive()||(c*=2),c*a}function Ot(r,a){if(r.j.info("Error code "+a),a==2){var c=C(r.fb,r),h=r.Xa;let T=!h;h=new Nt(h||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Oi(h,"https"),Li(h),T?nd(h.toString(),c):id(h.toString(),c)}else Pe(2);r.G=0,r.l&&r.l.sa(a),tc(r),Wl(r)}n.fb=function(r){r?(this.j.info("Successfully pinged google.com"),Pe(2)):(this.j.info("Failed to ping google.com"),Pe(1))};function tc(r){if(r.G=0,r.ka=[],r.l){let a=Vl(r.h);(a.length!=0||r.i.length!=0)&&(P(r.ka,a),P(r.ka,r.i),r.h.i.length=0,N(r.i),r.i.length=0),r.l.ra()}}function nc(r,a,c){var h=c instanceof Nt?it(c):new Nt(c);if(h.g!="")a&&(h.g=a+"."+h.g),Mi(h,h.s);else{var T=u.location;h=T.protocol,a=a?a+"."+T.hostname:T.hostname,T=+T.port;var b=new Nt(null);h&&Oi(b,h),a&&(b.g=a),T&&Mi(b,T),c&&(b.l=c),h=b}return c=r.D,a=r.ya,c&&a&&ne(h,c,a),ne(h,"VER",r.la),Zn(r,h),h}function ic(r,a,c){if(a&&!r.J)throw Error("Can't create secondary domain capable XhrIo object.");return a=r.Ca&&!r.pa?new ae(new Hn({eb:c})):new ae(r.pa),a.Ha(r.J),a}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function rc(){}n=rc.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ji(){}ji.prototype.g=function(r,a){return new ke(r,a)};function ke(r,a){we.call(this),this.g=new Ql(a),this.l=r,this.h=a&&a.messageUrlParams||null,r=a&&a.messageHeaders||null,a&&a.clientProtocolHeaderRequired&&(r?r["X-Client-Protocol"]="webchannel":r={"X-Client-Protocol":"webchannel"}),this.g.o=r,r=a&&a.initMessageHeaders||null,a&&a.messageContentType&&(r?r["X-WebChannel-Content-Type"]=a.messageContentType:r={"X-WebChannel-Content-Type":a.messageContentType}),a&&a.va&&(r?r["X-WebChannel-Client-Profile"]=a.va:r={"X-WebChannel-Client-Profile":a.va}),this.g.S=r,(r=a&&a.Sb)&&!G(r)&&(this.g.m=r),this.v=a&&a.supportsCrossDomainXhr||!1,this.u=a&&a.sendRawJson||!1,(a=a&&a.httpSessionIdParam)&&!G(a)&&(this.g.D=a,r=this.h,r!==null&&a in r&&(r=this.h,a in r&&delete r[a])),this.j=new tn(this)}D(ke,we),ke.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ke.prototype.close=function(){vs(this.g)},ke.prototype.o=function(r){var a=this.g;if(typeof r=="string"){var c={};c.__data__=r,r=c}else this.u&&(c={},c.__data__=as(r),r=c);a.i.push(new Kh(a.Ya++,r)),a.G==3&&Ui(a)},ke.prototype.N=function(){this.g.l=null,delete this.j,vs(this.g),delete this.g,ke.aa.N.call(this)};function sc(r){cs.call(this),r.__headers__&&(this.headers=r.__headers__,this.statusCode=r.__status__,delete r.__headers__,delete r.__status__);var a=r.__sm__;if(a){e:{for(let c in a){r=c;break e}r=void 0}(this.i=r)&&(r=this.i,a=a!==null&&r in a?a[r]:void 0),this.data=a}else this.data=r}D(sc,cs);function oc(){us.call(this),this.status=1}D(oc,us);function tn(r){this.g=r}D(tn,rc),tn.prototype.ua=function(){Re(this.g,"a")},tn.prototype.ta=function(r){Re(this.g,new sc(r))},tn.prototype.sa=function(r){Re(this.g,new oc)},tn.prototype.ra=function(){Re(this.g,"b")},ji.prototype.createWebChannel=ji.prototype.g,ke.prototype.send=ke.prototype.o,ke.prototype.open=ke.prototype.m,ke.prototype.close=ke.prototype.close,Ys=lt.createWebChannelTransport=function(){return new ji},Js=lt.getStatEventTarget=function(){return Di()},Hs=lt.Event=Vt,ar=lt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Vi.NO_ERROR=0,Vi.TIMEOUT=8,Vi.HTTP_ERROR=6,ri=lt.ErrorCode=Vi,wl.COMPLETE="complete",Ws=lt.EventType=wl,_l.EventType=Un,Un.OPEN="a",Un.CLOSE="b",Un.ERROR="c",Un.MESSAGE="d",we.prototype.listen=we.prototype.K,dn=lt.WebChannel=_l,Qf=lt.FetchXmlHttpFactory=Hn,ae.prototype.listenOnce=ae.prototype.L,ae.prototype.getLastError=ae.prototype.Ka,ae.prototype.getLastErrorCode=ae.prototype.Ba,ae.prototype.getStatus=ae.prototype.Z,ae.prototype.getResponseJson=ae.prototype.Oa,ae.prototype.getResponseText=ae.prototype.oa,ae.prototype.send=ae.prototype.ea,ae.prototype.setWithCredentials=ae.prototype.Ha,Qs=lt.XhrIo=ae}).apply(typeof or<"u"?or:typeof self<"u"?self:typeof window<"u"?window:{});var qc="@firebase/firestore";var ye=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ye.UNAUTHENTICATED=new ye(null),ye.GOOGLE_CREDENTIALS=new ye("google-credentials-uid"),ye.FIRST_PARTY=new ye("first-party-uid"),ye.MOCK_USER=new ye("mock-user");var kn="10.14.0";var Gt=new wc("@firebase/firestore");function si(){return Gt.logLevel}function k(n,...e){if(Gt.logLevel<=ot.DEBUG){let t=e.map(Na);Gt.debug(`Firestore (${kn}): ${n}`,...t)}}function ht(n,...e){if(Gt.logLevel<=ot.ERROR){let t=e.map(Na);Gt.error(`Firestore (${kn}): ${n}`,...t)}}function vn(n,...e){if(Gt.logLevel<=ot.WARN){let t=e.map(Na);Gt.warn(`Firestore (${kn}): ${n}`,...t)}}function Na(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function L(n="Unexpected state"){let e=`FIRESTORE (${kn}) INTERNAL ASSERTION FAILED: `+n;throw ht(e),new Error(e)}function J(n,e){n||L()}function F(n,e){return n}var A={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},O=class extends Ic{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ct=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var dr=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},no=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ye.UNAUTHENTICATED))}shutdown(){}},io=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},ro=class{constructor(e){this.t=e,this.currentUser=ye.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){J(this.o===void 0);let i=this.i,s=d=>this.i!==i?(i=this.i,t(d)):Promise.resolve(),o=new ct;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new ct,e.enqueueRetryable(()=>s(this.currentUser))};let l=()=>{let d=o;e.enqueueRetryable(()=>V(this,null,function*(){yield d.promise,yield s(this.currentUser)}))},u=d=>{k("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit(d=>u(d)),setTimeout(()=>{if(!this.auth){let d=this.t.getImmediate({optional:!0});d?u(d):(k("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new ct)}},0),l()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(k("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(J(typeof i.accessToken=="string"),new dr(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return J(e===null||typeof e=="string"),new ye(e)}},so=class{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=ye.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},oo=class{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new so(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(ye.FIRST_PARTY))}shutdown(){}invalidateToken(){}},ao=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},lo=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){J(this.o===void 0);let i=o=>{o.error!=null&&k("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let l=o.token!==this.R;return this.R=o.token,k("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>i(o))};let s=o=>{k("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>s(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?s(o):k("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(J(typeof t.token=="string"),this.R=t.token,new ao(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function Wf(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}var fr=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,i="";for(;i.length<20;){let s=Wf(40);for(let o=0;o<s.length;++o)i.length<20&&s[o]<t&&(i+=e.charAt(s[o]%e.length))}return i}};function Q(n,e){return n<e?-1:n>e?1:0}function In(n,e,t){return n.length===e.length&&n.every((i,s)=>t(i,e[s]))}var Ie=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new O(A.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new O(A.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new O(A.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new O(A.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new n(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Q(this.nanoseconds,e.nanoseconds):Q(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var B=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Ie(0,0))}static max(){return new n(new Ie(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var pr=class n{constructor(e,t,i){t===void 0?t=0:t>e.length&&L(),i===void 0?i=e.length-t:i>e.length-t&&L(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let i=Math.min(e.length,t.length);for(let s=0;s<i;s++){let o=e.get(s),l=t.get(s);if(o<l)return-1;if(o>l)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},le=class n extends pr{construct(e,t,i){return new n(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let i of e){if(i.indexOf("//")>=0)throw new O(A.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(s=>s.length>0))}return new n(t)}static emptyPath(){return new n([])}},Hf=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Oe=class n extends pr{construct(e,t,i){return new n(e,t,i)}static isValidIdentifier(e){return Hf.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],i="",s=0,o=()=>{if(i.length===0)throw new O(A.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""},l=!1;for(;s<e.length;){let u=e[s];if(u==="\\"){if(s+1===e.length)throw new O(A.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let d=e[s+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new O(A.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=d,s+=2}else u==="`"?(l=!l,s++):u!=="."||l?(i+=u,s++):(o(),s++)}if(o(),l)throw new O(A.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var M=class n{constructor(e){this.path=e}static fromPath(e){return new n(le.fromString(e))}static fromName(e){return new n(le.fromString(e).popFirst(5))}static empty(){return new n(le.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&le.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return le.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new le(e.slice()))}};var co=class{constructor(e,t,i,s){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=s}};co.UNKNOWN_ID=-1;function Jf(n,e){let t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,s=B.fromTimestamp(i===1e9?new Ie(t+1,0):new Ie(t,i));return new Kt(s,M.empty(),e)}function Yf(n){return new Kt(n.readTime,n.key,-1)}var Kt=class n{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new n(B.min(),M.empty(),-1)}static max(){return new n(B.max(),M.empty(),-1)}};function Xf(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=M.comparator(n.documentKey,e.documentKey),t!==0?t:Q(n.largestBatchId,e.largestBatchId))}var Zf="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",uo=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Ei(n){return V(this,null,function*(){if(n.code!==A.FAILED_PRECONDITION||n.message!==Zf)throw n;k("LocalStore","Unexpectedly lost primary lease")})}var x=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&L(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((i,s)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(i,s)},this.catchCallback=o=>{this.wrapFailure(t,o).next(i,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,i)=>{t(e)})}static reject(e){return new n((t,i)=>{i(e)})}static waitFor(e){return new n((t,i)=>{let s=0,o=0,l=!1;e.forEach(u=>{++s,u.next(()=>{++o,l&&o===s&&t()},d=>i(d))}),l=!0,o===s&&t()})}static or(e){let t=n.resolve(!1);for(let i of e)t=t.next(s=>s?n.resolve(s):i());return t}static forEach(e,t){let i=[];return e.forEach((s,o)=>{i.push(t.call(this,s,o))}),this.waitFor(i)}static mapArray(e,t){return new n((i,s)=>{let o=e.length,l=new Array(o),u=0;for(let d=0;d<o;d++){let f=d;t(e[f]).next(g=>{l[f]=g,++u,u===o&&i(l)},g=>s(g))}})}static doWhile(e,t){return new n((i,s)=>{let o=()=>{e()===!0?t().next(()=>{o()},s):i()};o()})}};function ep(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function bi(n){return n.name==="IndexedDbTransactionError"}var vu=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=s=>this.ie(s),this.se=s=>i.writeSequenceNumber(s))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function jr(n){return n==null}function hi(n){return n===0&&1/n==-1/0}function tp(n){return typeof n=="number"&&Number.isInteger(n)&&!hi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var np=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],By=[...np,"documentOverlays"],ip=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],rp=ip,sp=[...rp,"indexConfiguration","indexState","indexEntries"];var qy=[...sp,"globals"];function Uc(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Yt(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Iu(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ce=class n{constructor(e,t){this.comparator=e,this.root=t||Je.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Je.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Je.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){let s=this.comparator(e,i.key);if(s===0)return t+i.left.size;s<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){let e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new gn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new gn(this.root,e,this.comparator,!1)}getReverseIterator(){return new gn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new gn(this.root,e,this.comparator,!0)}},gn=class{constructor(e,t,i,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?i(e.key,t):1,t&&s&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Je=class n{constructor(e,t,i,s,o){this.key=e,this.value=t,this.color=i??n.RED,this.left=s??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,s,o){return new n(e??this.key,t??this.value,i??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this,o=i(e,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(e,t,i),null):o===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return n.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw L();let e=this.left.check();if(e!==this.right.check())throw L();return e+(this.isRed()?0:1)}};Je.EMPTY=null,Je.RED=!0,Je.BLACK=!1;Je.EMPTY=new class{constructor(){this.size=0}get key(){throw L()}get value(){throw L()}get color(){throw L()}get left(){throw L()}get right(){throw L()}copy(e,t,i,s,o){return this}insert(e,t,i){return new Je(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Se=class n{constructor(e){this.comparator=e,this.data=new ce(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let s=i.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new mr(this.data.getIterator())}getIteratorFrom(e){return new mr(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){let s=t.getNext().key,o=i.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},mr=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Be=class n{constructor(e){this.fields=e,e.sort(Oe.comparator)}static empty(){return new n([])}unionWith(e){let t=new Se(Oe.comparator);for(let i of this.fields)t=t.add(i);for(let i of e)t=t.add(i);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return In(this.fields,e.fields,(t,i)=>t.isEqual(i))}};var gr=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var xe=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new gr("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(s){let o="";for(let l=0;l<s.length;++l)o+=String.fromCharCode(s[l]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Q(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};xe.EMPTY_BYTE_STRING=new xe("");var op=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function dt(n){if(J(!!n),typeof n=="string"){let e=0,t=op.exec(n);if(J(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}let i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:se(n.seconds),nanos:se(n.nanos)}}function se(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function xt(n){return typeof n=="string"?xe.fromBase64String(n):xe.fromUint8Array(n)}function Oa(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Ma(n){let e=n.mapValue.fields.__previous_value__;return Oa(e)?Ma(e):e}function di(n){let e=dt(n.mapValue.fields.__local_write_time__.timestampValue);return new Ie(e.seconds,e.nanos)}var ho=class{constructor(e,t,i,s,o,l,u,d,f){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=s,this.ssl=o,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=d,this.useFetchStreams=f}},_r=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var lr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Qt(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Oa(n)?4:wu(n)?9007199254740991:Tu(n)?10:11:L()}function Ze(n,e){if(n===e)return!0;let t=Qt(n);if(t!==Qt(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return di(n).isEqual(di(e));case 3:return function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;let l=dt(s.timestampValue),u=dt(o.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,o){return xt(s.bytesValue).isEqual(xt(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,o){return se(s.geoPointValue.latitude)===se(o.geoPointValue.latitude)&&se(s.geoPointValue.longitude)===se(o.geoPointValue.longitude)}(n,e);case 2:return function(s,o){if("integerValue"in s&&"integerValue"in o)return se(s.integerValue)===se(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){let l=se(s.doubleValue),u=se(o.doubleValue);return l===u?hi(l)===hi(u):isNaN(l)&&isNaN(u)}return!1}(n,e);case 9:return In(n.arrayValue.values||[],e.arrayValue.values||[],Ze);case 10:case 11:return function(s,o){let l=s.mapValue.fields||{},u=o.mapValue.fields||{};if(Uc(l)!==Uc(u))return!1;for(let d in l)if(l.hasOwnProperty(d)&&(u[d]===void 0||!Ze(l[d],u[d])))return!1;return!0}(n,e);default:return L()}}function fi(n,e){return(n.values||[]).find(t=>Ze(t,e))!==void 0}function Tn(n,e){if(n===e)return 0;let t=Qt(n),i=Qt(e);if(t!==i)return Q(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Q(n.booleanValue,e.booleanValue);case 2:return function(o,l){let u=se(o.integerValue||o.doubleValue),d=se(l.integerValue||l.doubleValue);return u<d?-1:u>d?1:u===d?0:isNaN(u)?isNaN(d)?0:-1:1}(n,e);case 3:return zc(n.timestampValue,e.timestampValue);case 4:return zc(di(n),di(e));case 5:return Q(n.stringValue,e.stringValue);case 6:return function(o,l){let u=xt(o),d=xt(l);return u.compareTo(d)}(n.bytesValue,e.bytesValue);case 7:return function(o,l){let u=o.split("/"),d=l.split("/");for(let f=0;f<u.length&&f<d.length;f++){let g=Q(u[f],d[f]);if(g!==0)return g}return Q(u.length,d.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,l){let u=Q(se(o.latitude),se(l.latitude));return u!==0?u:Q(se(o.longitude),se(l.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return jc(n.arrayValue,e.arrayValue);case 10:return function(o,l){var u,d,f,g;let E=o.fields||{},C=l.fields||{},S=(u=E.value)===null||u===void 0?void 0:u.arrayValue,D=(d=C.value)===null||d===void 0?void 0:d.arrayValue,N=Q(((f=S?.values)===null||f===void 0?void 0:f.length)||0,((g=D?.values)===null||g===void 0?void 0:g.length)||0);return N!==0?N:jc(S,D)}(n.mapValue,e.mapValue);case 11:return function(o,l){if(o===lr.mapValue&&l===lr.mapValue)return 0;if(o===lr.mapValue)return 1;if(l===lr.mapValue)return-1;let u=o.fields||{},d=Object.keys(u),f=l.fields||{},g=Object.keys(f);d.sort(),g.sort();for(let E=0;E<d.length&&E<g.length;++E){let C=Q(d[E],g[E]);if(C!==0)return C;let S=Tn(u[d[E]],f[g[E]]);if(S!==0)return S}return Q(d.length,g.length)}(n.mapValue,e.mapValue);default:throw L()}}function zc(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Q(n,e);let t=dt(n),i=dt(e),s=Q(t.seconds,i.seconds);return s!==0?s:Q(t.nanos,i.nanos)}function jc(n,e){let t=n.values||[],i=e.values||[];for(let s=0;s<t.length&&s<i.length;++s){let o=Tn(t[s],i[s]);if(o)return o}return Q(t.length,i.length)}function wn(n){return fo(n)}function fo(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let i=dt(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return xt(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return M.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",s=!0;for(let o of t.values||[])s?s=!1:i+=",",i+=fo(o);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){let i=Object.keys(t.fields||{}).sort(),s="{",o=!0;for(let l of i)o?o=!1:s+=",",s+=`${l}:${fo(t.fields[l])}`;return s+"}"}(n.mapValue):L()}function po(n){return!!n&&"integerValue"in n}function La(n){return!!n&&"arrayValue"in n}function $c(n){return!!n&&"nullValue"in n}function Gc(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ur(n){return!!n&&"mapValue"in n}function Tu(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function ai(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Yt(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=ai(i)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ai(n.arrayValue.values[t]);return e}return Object.assign({},n)}function wu(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Ne=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!ur(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ai(t)}setAll(e){let t=Oe.emptyPath(),i={},s=[];e.forEach((l,u)=>{if(!t.isImmediateParentOf(u)){let d=this.getFieldsMap(t);this.applyChanges(d,i,s),i={},s=[],t=u.popLast()}l?i[u.lastSegment()]=ai(l):s.push(u.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,i,s)}delete(e){let t=this.field(e.popLast());ur(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ze(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let s=t.mapValue.fields[e.get(i)];ur(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,i){Yt(t,(s,o)=>e[s]=o);for(let s of i)delete e[s]}clone(){return new n(ai(this.value))}};function Eu(n){let e=[];return Yt(n.fields,(t,i)=>{let s=new Oe([t]);if(ur(i)){let o=Eu(i.mapValue).fields;if(o.length===0)e.push(s);else for(let l of o)e.push(s.child(l))}else e.push(s)}),new Be(e)}var ze=class n{constructor(e,t,i,s,o,l,u){this.key=e,this.documentType=t,this.version=i,this.readTime=s,this.createTime=o,this.data=l,this.documentState=u}static newInvalidDocument(e){return new n(e,0,B.min(),B.min(),B.min(),Ne.empty(),0)}static newFoundDocument(e,t,i,s){return new n(e,1,t,B.min(),i,s,0)}static newNoDocument(e,t){return new n(e,2,t,B.min(),B.min(),Ne.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,B.min(),B.min(),Ne.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(B.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ne.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ne.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=B.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var En=class{constructor(e,t){this.position=e,this.inclusive=t}};function Kc(n,e,t){let i=0;for(let s=0;s<n.position.length;s++){let o=e[s],l=n.position[s];if(o.field.isKeyField()?i=M.comparator(M.fromName(l.referenceValue),t.key):i=Tn(l,t.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function Qc(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ze(n.position[t],e.position[t]))return!1;return!0}var bn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function ap(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var yr=class{},me=class n extends yr{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new go(e,t,i):t==="array-contains"?new vo(e,i):t==="in"?new Io(e,i):t==="not-in"?new To(e,i):t==="array-contains-any"?new wo(e,i):new n(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new _o(e,i):new yo(e,i)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Tn(t,this.value)):t!==null&&Qt(this.value)===Qt(t)&&this.matchesComparison(Tn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return L()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},et=class n extends yr{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return bu(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function bu(n){return n.op==="and"}function Cu(n){return lp(n)&&bu(n)}function lp(n){for(let e of n.filters)if(e instanceof et)return!1;return!0}function mo(n){if(n instanceof me)return n.field.canonicalString()+n.op.toString()+wn(n.value);if(Cu(n))return n.filters.map(e=>mo(e)).join(",");{let e=n.filters.map(t=>mo(t)).join(",");return`${n.op}(${e})`}}function Au(n,e){return n instanceof me?function(i,s){return s instanceof me&&i.op===s.op&&i.field.isEqual(s.field)&&Ze(i.value,s.value)}(n,e):n instanceof et?function(i,s){return s instanceof et&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce((o,l,u)=>o&&Au(l,s.filters[u]),!0):!1}(n,e):void L()}function Su(n){return n instanceof me?function(t){return`${t.field.canonicalString()} ${t.op} ${wn(t.value)}`}(n):n instanceof et?function(t){return t.op.toString()+" {"+t.getFilters().map(Su).join(" ,")+"}"}(n):"Filter"}var go=class extends me{constructor(e,t,i){super(e,t,i),this.key=M.fromName(i.referenceValue)}matches(e){let t=M.comparator(e.key,this.key);return this.matchesComparison(t)}},_o=class extends me{constructor(e,t){super(e,"in",t),this.keys=xu("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},yo=class extends me{constructor(e,t){super(e,"not-in",t),this.keys=xu("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function xu(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>M.fromName(i.referenceValue))}var vo=class extends me{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return La(t)&&fi(t.arrayValue,this.value)}},Io=class extends me{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&fi(this.value.arrayValue,t)}},To=class extends me{constructor(e,t){super(e,"not-in",t)}matches(e){if(fi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!fi(this.value.arrayValue,t)}},wo=class extends me{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!La(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>fi(this.value.arrayValue,i))}};var Eo=class{constructor(e,t=null,i=[],s=[],o=null,l=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=s,this.limit=o,this.startAt=l,this.endAt=u,this.ue=null}};function Wc(n,e=null,t=[],i=[],s=null,o=null,l=null){return new Eo(n,e,t,i,s,o,l)}function Fa(n){let e=F(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>mo(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(o){return o.field.canonicalString()+o.dir}(i)).join(","),jr(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>wn(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>wn(i)).join(",")),e.ue=t}return e.ue}function Ba(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!ap(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Au(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Qc(n.startAt,e.startAt)&&Qc(n.endAt,e.endAt)}function bo(n){return M.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Cn=class{constructor(e,t=null,i=[],s=[],o=null,l="F",u=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=s,this.limit=o,this.limitType=l,this.startAt=u,this.endAt=d,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function cp(n,e,t,i,s,o,l,u){return new Cn(n,e,t,i,s,o,l,u)}function qa(n){return new Cn(n)}function Hc(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function up(n){return n.collectionGroup!==null}function li(n){let e=F(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new Se(Oe.comparator);return l.filters.forEach(d=>{d.getFlattenedFilters().forEach(f=>{f.isInequality()&&(u=u.add(f.field))})}),u})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new bn(o,i))}),t.has(Oe.keyField().canonicalString())||e.ce.push(new bn(Oe.keyField(),i))}return e.ce}function Ye(n){let e=F(n);return e.le||(e.le=hp(e,li(n))),e.le}function hp(n,e){if(n.limitType==="F")return Wc(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{let o=s.dir==="desc"?"asc":"desc";return new bn(s.field,o)});let t=n.endAt?new En(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new En(n.startAt.position,n.startAt.inclusive):null;return Wc(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function Co(n,e,t){return new Cn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function $r(n,e){return Ba(Ye(n),Ye(e))&&n.limitType===e.limitType}function Ru(n){return`${Fa(Ye(n))}|lt:${n.limitType}`}function fn(n){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(s=>Su(s)).join(", ")}]`),jr(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(s=>function(l){return`${l.field.canonicalString()} (${l.dir})`}(s)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(s=>wn(s)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(s=>wn(s)).join(",")),`Target(${i})`}(Ye(n))}; limitType=${n.limitType})`}function Gr(n,e){return e.isFoundDocument()&&function(i,s){let o=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):M.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)}(n,e)&&function(i,s){for(let o of li(i))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0}(n,e)&&function(i,s){for(let o of i.filters)if(!o.matches(s))return!1;return!0}(n,e)&&function(i,s){return!(i.startAt&&!function(l,u,d){let f=Kc(l,u,d);return l.inclusive?f<=0:f<0}(i.startAt,li(i),s)||i.endAt&&!function(l,u,d){let f=Kc(l,u,d);return l.inclusive?f>=0:f>0}(i.endAt,li(i),s))}(n,e)}function dp(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Pu(n){return(e,t)=>{let i=!1;for(let s of li(n)){let o=fp(s,e,t);if(o!==0)return o;i=i||s.field.isKeyField()}return 0}}function fp(n,e,t){let i=n.field.isKeyField()?M.comparator(e.key,t.key):function(o,l,u){let d=l.data.field(o),f=u.data.field(o);return d!==null&&f!==null?Tn(d,f):L()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return L()}}var Rt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(let[s,o]of i)if(this.equalsFn(s,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let i=this.mapKeyFn(e),s=this.inner[i];if(s===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return void(s[o]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return i.length===1?delete this.inner[t]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Yt(this.inner,(t,i)=>{for(let[s,o]of i)e(s,o)})}isEmpty(){return Iu(this.inner)}size(){return this.innerSize}};var pp=new ce(M.comparator);function ft(){return pp}var Du=new ce(M.comparator);function oi(...n){let e=Du;for(let t of n)e=e.insert(t.key,t);return e}function Vu(n){let e=Du;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function zt(){return ci()}function ku(){return ci()}function ci(){return new Rt(n=>n.toString(),(n,e)=>n.isEqual(e))}var mp=new ce(M.comparator),gp=new Se(M.comparator);function U(...n){let e=gp;for(let t of n)e=e.add(t);return e}var _p=new Se(Q);function yp(){return _p}function Ua(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:hi(e)?"-0":e}}function Nu(n){return{integerValue:""+n}}function vp(n,e){return tp(e)?Nu(e):Ua(n,e)}var An=class{constructor(){this._=void 0}};function Ip(n,e,t){return n instanceof Sn?function(s,o){let l={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&Oa(o)&&(o=Ma(o)),o&&(l.fields.__previous_value__=o),{mapValue:l}}(t,e):n instanceof Wt?Mu(n,e):n instanceof Ht?Lu(n,e):function(s,o){let l=Ou(s,o),u=Jc(l)+Jc(s.Pe);return po(l)&&po(s.Pe)?Nu(u):Ua(s.serializer,u)}(n,e)}function Tp(n,e,t){return n instanceof Wt?Mu(n,e):n instanceof Ht?Lu(n,e):t}function Ou(n,e){return n instanceof xn?function(i){return po(i)||function(o){return!!o&&"doubleValue"in o}(i)}(e)?e:{integerValue:0}:null}var Sn=class extends An{},Wt=class extends An{constructor(e){super(),this.elements=e}};function Mu(n,e){let t=Fu(e);for(let i of n.elements)t.some(s=>Ze(s,i))||t.push(i);return{arrayValue:{values:t}}}var Ht=class extends An{constructor(e){super(),this.elements=e}};function Lu(n,e){let t=Fu(e);for(let i of n.elements)t=t.filter(s=>!Ze(s,i));return{arrayValue:{values:t}}}var xn=class extends An{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function Jc(n){return se(n.integerValue||n.doubleValue)}function Fu(n){return La(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function wp(n,e){return n.field.isEqual(e.field)&&function(i,s){return i instanceof Wt&&s instanceof Wt||i instanceof Ht&&s instanceof Ht?In(i.elements,s.elements,Ze):i instanceof xn&&s instanceof xn?Ze(i.Pe,s.Pe):i instanceof Sn&&s instanceof Sn}(n.transform,e.transform)}var Ao=class{constructor(e,t){this.version=e,this.transformResults=t}},ut=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function hr(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Rn=class{};function Bu(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new pi(n.key,ut.none()):new Jt(n.key,n.data,ut.none());{let t=n.data,i=Ne.empty(),s=new Se(Oe.comparator);for(let o of e.fields)if(!s.has(o)){let l=t.field(o);l===null&&o.length>1&&(o=o.popLast(),l=t.field(o)),l===null?i.delete(o):i.set(o,l),s=s.add(o)}return new tt(n.key,i,new Be(s.toArray()),ut.none())}}function Ep(n,e,t){n instanceof Jt?function(s,o,l){let u=s.value.clone(),d=Xc(s.fieldTransforms,o,l.transformResults);u.setAll(d),o.convertToFoundDocument(l.version,u).setHasCommittedMutations()}(n,e,t):n instanceof tt?function(s,o,l){if(!hr(s.precondition,o))return void o.convertToUnknownDocument(l.version);let u=Xc(s.fieldTransforms,o,l.transformResults),d=o.data;d.setAll(qu(s)),d.setAll(u),o.convertToFoundDocument(l.version,d).setHasCommittedMutations()}(n,e,t):function(s,o,l){o.convertToNoDocument(l.version).setHasCommittedMutations()}(0,e,t)}function ui(n,e,t,i){return n instanceof Jt?function(o,l,u,d){if(!hr(o.precondition,l))return u;let f=o.value.clone(),g=Zc(o.fieldTransforms,d,l);return f.setAll(g),l.convertToFoundDocument(l.version,f).setHasLocalMutations(),null}(n,e,t,i):n instanceof tt?function(o,l,u,d){if(!hr(o.precondition,l))return u;let f=Zc(o.fieldTransforms,d,l),g=l.data;return g.setAll(qu(o)),g.setAll(f),l.convertToFoundDocument(l.version,g).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(E=>E.field))}(n,e,t,i):function(o,l,u){return hr(o.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u}(n,e,t)}function bp(n,e){let t=null;for(let i of n.fieldTransforms){let s=e.data.field(i.field),o=Ou(i.transform,s||null);o!=null&&(t===null&&(t=Ne.empty()),t.set(i.field,o))}return t||null}function Yc(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&In(i,s,(o,l)=>wp(o,l))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Jt=class extends Rn{constructor(e,t,i,s=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}},tt=class extends Rn{constructor(e,t,i,s,o=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function qu(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let i=n.data.field(t);e.set(t,i)}}),e}function Xc(n,e,t){let i=new Map;J(n.length===t.length);for(let s=0;s<t.length;s++){let o=n[s],l=o.transform,u=e.data.field(o.field);i.set(o.field,Tp(l,u,t[s]))}return i}function Zc(n,e,t){let i=new Map;for(let s of n){let o=s.transform,l=t.data.field(s.field);i.set(s.field,Ip(o,l,e))}return i}var pi=class extends Rn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},So=class extends Rn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var xo=class{constructor(e,t,i,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(e,t){let i=t.mutationResults;for(let s=0;s<this.mutations.length;s++){let o=this.mutations[s];o.key.isEqual(e.key)&&Ep(o,e,i[s])}}applyToLocalView(e,t){for(let i of this.baseMutations)i.key.isEqual(e.key)&&(t=ui(i,e,t,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(e.key)&&(t=ui(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let i=ku();return this.mutations.forEach(s=>{let o=e.get(s.key),l=o.overlayedDocument,u=this.applyToLocalView(l,o.mutatedFields);u=t.has(s.key)?null:u;let d=Bu(l,u);d!==null&&i.set(s.key,d),l.isValidDocument()||l.convertToNoDocument(B.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),U())}isEqual(e){return this.batchId===e.batchId&&In(this.mutations,e.mutations,(t,i)=>Yc(t,i))&&In(this.baseMutations,e.baseMutations,(t,i)=>Yc(t,i))}},Ro=class n{constructor(e,t,i,s){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=s}static from(e,t,i){J(e.mutations.length===i.length);let s=function(){return mp}(),o=e.mutations;for(let l=0;l<o.length;l++)s=s.insert(o[l].key,i[l].version);return new n(e,t,i,s)}};var Po=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Do=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var he,$;function Cp(n){switch(n){default:return L();case A.CANCELLED:case A.UNKNOWN:case A.DEADLINE_EXCEEDED:case A.RESOURCE_EXHAUSTED:case A.INTERNAL:case A.UNAVAILABLE:case A.UNAUTHENTICATED:return!1;case A.INVALID_ARGUMENT:case A.NOT_FOUND:case A.ALREADY_EXISTS:case A.PERMISSION_DENIED:case A.FAILED_PRECONDITION:case A.ABORTED:case A.OUT_OF_RANGE:case A.UNIMPLEMENTED:case A.DATA_LOSS:return!0}}function Uu(n){if(n===void 0)return ht("GRPC error has no .code"),A.UNKNOWN;switch(n){case he.OK:return A.OK;case he.CANCELLED:return A.CANCELLED;case he.UNKNOWN:return A.UNKNOWN;case he.DEADLINE_EXCEEDED:return A.DEADLINE_EXCEEDED;case he.RESOURCE_EXHAUSTED:return A.RESOURCE_EXHAUSTED;case he.INTERNAL:return A.INTERNAL;case he.UNAVAILABLE:return A.UNAVAILABLE;case he.UNAUTHENTICATED:return A.UNAUTHENTICATED;case he.INVALID_ARGUMENT:return A.INVALID_ARGUMENT;case he.NOT_FOUND:return A.NOT_FOUND;case he.ALREADY_EXISTS:return A.ALREADY_EXISTS;case he.PERMISSION_DENIED:return A.PERMISSION_DENIED;case he.FAILED_PRECONDITION:return A.FAILED_PRECONDITION;case he.ABORTED:return A.ABORTED;case he.OUT_OF_RANGE:return A.OUT_OF_RANGE;case he.UNIMPLEMENTED:return A.UNIMPLEMENTED;case he.DATA_LOSS:return A.DATA_LOSS;default:return L()}}($=he||(he={}))[$.OK=0]="OK",$[$.CANCELLED=1]="CANCELLED",$[$.UNKNOWN=2]="UNKNOWN",$[$.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$[$.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$[$.NOT_FOUND=5]="NOT_FOUND",$[$.ALREADY_EXISTS=6]="ALREADY_EXISTS",$[$.PERMISSION_DENIED=7]="PERMISSION_DENIED",$[$.UNAUTHENTICATED=16]="UNAUTHENTICATED",$[$.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$[$.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$[$.ABORTED=10]="ABORTED",$[$.OUT_OF_RANGE=11]="OUT_OF_RANGE",$[$.UNIMPLEMENTED=12]="UNIMPLEMENTED",$[$.INTERNAL=13]="INTERNAL",$[$.UNAVAILABLE=14]="UNAVAILABLE",$[$.DATA_LOSS=15]="DATA_LOSS";var eu=null;function Ap(){return new TextEncoder}var Sp=new Ct([4294967295,4294967295],0);function tu(n){let e=Ap().encode(n),t=new Ks;return t.update(e),new Uint8Array(t.digest())}function nu(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),s=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Ct([t,i],0),new Ct([s,o],0)]}var Vo=class n{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new jt(`Invalid padding: ${t}`);if(i<0)throw new jt(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new jt(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new jt(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Ct.fromNumber(this.Ie)}Ee(e,t,i){let s=e.add(t.multiply(Ct.fromNumber(i)));return s.compare(Sp)===1&&(s=new Ct([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=tu(e),[i,s]=nu(t);for(let o=0;o<this.hashCount;o++){let l=this.Ee(i,s,o);if(!this.de(l))return!1}return!0}static create(e,t,i){let s=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),l=new n(o,s,t);return i.forEach(u=>l.insert(u)),l}insert(e){if(this.Ie===0)return;let t=tu(e),[i,s]=nu(t);for(let o=0;o<this.hashCount;o++){let l=this.Ee(i,s,o);this.Ae(l)}}Ae(e){let t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}},jt=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var vr=class n{constructor(e,t,i,s,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,i){let s=new Map;return s.set(e,mi.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new n(B.min(),s,new ce(Q),ft(),U())}},mi=class n{constructor(e,t,i,s,o){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new n(i,t,U(),U(),U())}};var _n=class{constructor(e,t,i,s){this.Re=e,this.removedTargetIds=t,this.key=i,this.Ve=s}},Ir=class{constructor(e,t){this.targetId=e,this.me=t}},Tr=class{constructor(e,t,i=xe.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=s}},wr=class{constructor(){this.fe=0,this.ge=ru(),this.pe=xe.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=U(),t=U(),i=U();return this.ge.forEach((s,o)=>{switch(o){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:i=i.add(s);break;default:L()}}),new mi(this.pe,this.ye,e,t,i)}Ce(){this.we=!1,this.ge=ru()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,J(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},ko=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=ft(),this.qe=iu(),this.Qe=new ce(Q)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let i=this.Ge(t);switch(e.state){case 0:this.ze(t)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),i.De(e.resumeToken));break;default:L()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((i,s)=>{this.ze(s)&&t(s)})}He(e){let t=e.targetId,i=e.me.count,s=this.Je(t);if(s){let o=s.target;if(bo(o))if(i===0){let l=new M(o.path);this.Ue(t,l,ze.newNoDocument(l,B.min()))}else J(i===1);else{let l=this.Ye(t);if(l!==i){let u=this.Ze(e),d=u?this.Xe(u,e,l):1;if(d!==0){this.je(t);let f=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,f)}eu?.et(function(g,E,C,S,D){var N,P,z,G,H,oe;let Le={localCacheCount:g,existenceFilterCount:E.count,databaseId:C.database,projectId:C.projectId},te=E.unchangedNames;return te&&(Le.bloomFilter={applied:D===0,hashCount:(N=te?.hashCount)!==null&&N!==void 0?N:0,bitmapLength:(G=(z=(P=te?.bits)===null||P===void 0?void 0:P.bitmap)===null||z===void 0?void 0:z.length)!==null&&G!==void 0?G:0,padding:(oe=(H=te?.bits)===null||H===void 0?void 0:H.padding)!==null&&oe!==void 0?oe:0,mightContain:I=>{var p;return(p=S?.mightContain(I))!==null&&p!==void 0&&p}}),Le}(l,e.me,this.Le.tt(),u,d))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:i="",padding:s=0},hashCount:o=0}=t,l,u;try{l=xt(i).toUint8Array()}catch(d){if(d instanceof gr)return vn("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{u=new Vo(l,s,o)}catch(d){return vn(d instanceof jt?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return u.Ie===0?null:u}Xe(e,t,i){return t.me.count===i-this.nt(e,t.targetId)?0:2}nt(e,t){let i=this.Le.getRemoteKeysForTarget(t),s=0;return i.forEach(o=>{let l=this.Le.tt(),u=`projects/${l.projectId}/databases/${l.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.Ue(t,o,null),s++)}),s}rt(e){let t=new Map;this.Be.forEach((o,l)=>{let u=this.Je(l);if(u){if(o.current&&bo(u.target)){let d=new M(u.target.path);this.ke.get(d)!==null||this.it(l,d)||this.Ue(l,d,ze.newNoDocument(d,e))}o.be&&(t.set(l,o.ve()),o.Ce())}});let i=U();this.qe.forEach((o,l)=>{let u=!0;l.forEachWhile(d=>{let f=this.Je(d);return!f||f.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(i=i.add(o))}),this.ke.forEach((o,l)=>l.setReadTime(e));let s=new vr(e,t,this.Qe,this.ke,i);return this.ke=ft(),this.qe=iu(),this.Qe=new ce(Q),s}$e(e,t){if(!this.ze(e))return;let i=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,i),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,i){if(!this.ze(e))return;let s=this.Ge(e);this.it(e,t)?s.Fe(t,1):s.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),i&&(this.ke=this.ke.insert(t,i))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new wr,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Se(Q),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||k("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new wr),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function iu(){return new ce(M.comparator)}function ru(){return new ce(M.comparator)}var xp={asc:"ASCENDING",desc:"DESCENDING"},Rp={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Pp={and:"AND",or:"OR"},No=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Oo(n,e){return n.useProto3Json||jr(e)?e:{value:e}}function Er(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function zu(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Dp(n,e){return Er(n,e.toTimestamp())}function Xe(n){return J(!!n),B.fromTimestamp(function(t){let i=dt(t);return new Ie(i.seconds,i.nanos)}(n))}function za(n,e){return Mo(n,e).canonicalString()}function Mo(n,e){let t=function(s){return new le(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function ju(n){let e=le.fromString(n);return J(Wu(e)),e}function Lo(n,e){return za(n.databaseId,e.path)}function Xs(n,e){let t=ju(e);if(t.get(1)!==n.databaseId.projectId)throw new O(A.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new O(A.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new M(Gu(t))}function $u(n,e){return za(n.databaseId,e)}function Vp(n){let e=ju(n);return e.length===4?le.emptyPath():Gu(e)}function Fo(n){return new le(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Gu(n){return J(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function su(n,e,t){return{name:Lo(n,e),fields:t.value.mapValue.fields}}function kp(n,e){let t;if("targetChange"in e){e.targetChange;let i=function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:L()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],o=function(f,g){return f.useProto3Json?(J(g===void 0||typeof g=="string"),xe.fromBase64String(g||"")):(J(g===void 0||g instanceof Buffer||g instanceof Uint8Array),xe.fromUint8Array(g||new Uint8Array))}(n,e.targetChange.resumeToken),l=e.targetChange.cause,u=l&&function(f){let g=f.code===void 0?A.UNKNOWN:Uu(f.code);return new O(g,f.message||"")}(l);t=new Tr(i,s,o,u||null)}else if("documentChange"in e){e.documentChange;let i=e.documentChange;i.document,i.document.name,i.document.updateTime;let s=Xs(n,i.document.name),o=Xe(i.document.updateTime),l=i.document.createTime?Xe(i.document.createTime):B.min(),u=new Ne({mapValue:{fields:i.document.fields}}),d=ze.newFoundDocument(s,o,l,u),f=i.targetIds||[],g=i.removedTargetIds||[];t=new _n(f,g,d.key,d)}else if("documentDelete"in e){e.documentDelete;let i=e.documentDelete;i.document;let s=Xs(n,i.document),o=i.readTime?Xe(i.readTime):B.min(),l=ze.newNoDocument(s,o),u=i.removedTargetIds||[];t=new _n([],u,l.key,l)}else if("documentRemove"in e){e.documentRemove;let i=e.documentRemove;i.document;let s=Xs(n,i.document),o=i.removedTargetIds||[];t=new _n([],o,s,null)}else{if(!("filter"in e))return L();{e.filter;let i=e.filter;i.targetId;let{count:s=0,unchangedNames:o}=i,l=new Do(s,o),u=i.targetId;t=new Ir(u,l)}}return t}function Np(n,e){let t;if(e instanceof Jt)t={update:su(n,e.key,e.value)};else if(e instanceof pi)t={delete:Lo(n,e.key)};else if(e instanceof tt)t={update:su(n,e.key,e.data),updateMask:jp(e.fieldMask)};else{if(!(e instanceof So))return L();t={verify:Lo(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(o,l){let u=l.transform;if(u instanceof Sn)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Wt)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Ht)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof xn)return{fieldPath:l.field.canonicalString(),increment:u.Pe};throw L()}(0,i))),e.precondition.isNone||(t.currentDocument=function(s,o){return o.updateTime!==void 0?{updateTime:Dp(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:L()}(n,e.precondition)),t}function Op(n,e){return n&&n.length>0?(J(e!==void 0),n.map(t=>function(s,o){let l=s.updateTime?Xe(s.updateTime):Xe(o);return l.isEqual(B.min())&&(l=Xe(o)),new Ao(l,s.transformResults||[])}(t,e))):[]}function Mp(n,e){return{documents:[$u(n,e.path)]}}function Lp(n,e){let t={structuredQuery:{}},i=e.path,s;e.collectionGroup!==null?(s=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=$u(n,s);let o=function(f){if(f.length!==0)return Qu(et.create(f,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let l=function(f){if(f.length!==0)return f.map(g=>function(C){return{field:pn(C.field),direction:qp(C.dir)}}(g))}(e.orderBy);l&&(t.structuredQuery.orderBy=l);let u=Oo(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(f){return{before:f.inclusive,values:f.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(f){return{before:!f.inclusive,values:f.position}}(e.endAt)),{_t:t,parent:s}}function Fp(n){let e=Vp(n.parent),t=n.structuredQuery,i=t.from?t.from.length:0,s=null;if(i>0){J(i===1);let g=t.from[0];g.allDescendants?s=g.collectionId:e=e.child(g.collectionId)}let o=[];t.where&&(o=function(E){let C=Ku(E);return C instanceof et&&Cu(C)?C.getFilters():[C]}(t.where));let l=[];t.orderBy&&(l=function(E){return E.map(C=>function(D){return new bn(mn(D.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(D.direction))}(C))}(t.orderBy));let u=null;t.limit&&(u=function(E){let C;return C=typeof E=="object"?E.value:E,jr(C)?null:C}(t.limit));let d=null;t.startAt&&(d=function(E){let C=!!E.before,S=E.values||[];return new En(S,C)}(t.startAt));let f=null;return t.endAt&&(f=function(E){let C=!E.before,S=E.values||[];return new En(S,C)}(t.endAt)),cp(e,s,l,o,u,"F",d,f)}function Bp(n,e){let t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return L()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Ku(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let i=mn(t.unaryFilter.field);return me.create(i,"==",{doubleValue:NaN});case"IS_NULL":let s=mn(t.unaryFilter.field);return me.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=mn(t.unaryFilter.field);return me.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let l=mn(t.unaryFilter.field);return me.create(l,"!=",{nullValue:"NULL_VALUE"});default:return L()}}(n):n.fieldFilter!==void 0?function(t){return me.create(mn(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return L()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return et.create(t.compositeFilter.filters.map(i=>Ku(i)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return L()}}(t.compositeFilter.op))}(n):L()}function qp(n){return xp[n]}function Up(n){return Rp[n]}function zp(n){return Pp[n]}function pn(n){return{fieldPath:n.canonicalString()}}function mn(n){return Oe.fromServerFormat(n.fieldPath)}function Qu(n){return n instanceof me?function(t){if(t.op==="=="){if(Gc(t.value))return{unaryFilter:{field:pn(t.field),op:"IS_NAN"}};if($c(t.value))return{unaryFilter:{field:pn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Gc(t.value))return{unaryFilter:{field:pn(t.field),op:"IS_NOT_NAN"}};if($c(t.value))return{unaryFilter:{field:pn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:pn(t.field),op:Up(t.op),value:t.value}}}(n):n instanceof et?function(t){let i=t.getFilters().map(s=>Qu(s));return i.length===1?i[0]:{compositeFilter:{op:zp(t.op),filters:i}}}(n):L()}function jp(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Wu(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var gi=class n{constructor(e,t,i,s,o=B.min(),l=B.min(),u=xe.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=d}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Bo=class{constructor(e){this.ct=e}};function $p(n){let e=Fp({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Co(e,e.limit,"L"):e}var br=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(se(e.integerValue));else if("doubleValue"in e){let i=se(e.doubleValue);isNaN(i)?this.dt(t,13):(this.dt(t,15),hi(i)?t.At(0):t.At(i))}else if("timestampValue"in e){let i=e.timestampValue;this.dt(t,20),typeof i=="string"&&(i=dt(i)),t.Rt(`${i.seconds||""}`),t.At(i.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(xt(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let i=e.geoPointValue;this.dt(t,45),t.At(i.latitude||0),t.At(i.longitude||0)}else"mapValue"in e?wu(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Tu(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):L()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let i=e.fields||{};this.dt(t,55);for(let s of Object.keys(i))this.Vt(s,t),this.Tt(i[s],t)}wt(e,t){var i,s;let o=e.fields||{};this.dt(t,53);let l="value",u=((s=(i=o[l].arrayValue)===null||i===void 0?void 0:i.values)===null||s===void 0?void 0:s.length)||0;this.dt(t,15),t.At(se(u)),this.Vt(l,t),this.Tt(o[l],t)}bt(e,t){let i=e.values||[];this.dt(t,50);for(let s of i)this.Tt(s,t)}yt(e,t){this.dt(t,37),M.fromName(e).path.forEach(i=>{this.dt(t,60),this.Dt(i,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};br.vt=new br;var qo=class{constructor(){this.un=new Uo}addToCollectionParentIndex(e,t){return this.un.add(t),x.resolve()}getCollectionParents(e,t){return x.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return x.resolve()}deleteFieldIndex(e,t){return x.resolve()}deleteAllFieldIndexes(e){return x.resolve()}createTargetIndexes(e,t){return x.resolve()}getDocumentsMatchingTarget(e,t){return x.resolve(null)}getIndexType(e,t){return x.resolve(0)}getFieldIndexes(e,t){return x.resolve([])}getNextCollectionGroupToUpdate(e){return x.resolve(null)}getMinOffset(e,t){return x.resolve(Kt.min())}getMinOffsetFromCollectionGroup(e,t){return x.resolve(Kt.min())}updateCollectionGroup(e,t,i){return x.resolve()}updateIndexEntries(e,t){return x.resolve()}},Uo=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),i=e.popLast(),s=this.index[t]||new Se(le.comparator),o=!s.has(i);return this.index[t]=s.add(i),o}has(e){let t=e.lastSegment(),i=e.popLast(),s=this.index[t];return s&&s.has(i)}getEntries(e){return(this.index[e]||new Se(le.comparator)).toArray()}};var zy=new Uint8Array(0);var He=class n{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};He.DEFAULT_COLLECTION_PERCENTILE=10,He.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,He.DEFAULT=new He(41943040,He.DEFAULT_COLLECTION_PERCENTILE,He.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),He.DISABLED=new He(-1,0,0);var _i=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var zo=class{constructor(){this.changes=new Rt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ze.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let i=this.changes.get(t);return i!==void 0?x.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var jo=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var $o=class{constructor(e,t,i,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=s}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(i=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(i!==null&&ui(i.mutation,s,Be.empty(),Ie.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,U()).next(()=>i))}getLocalViewOfDocuments(e,t,i=U()){let s=zt();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,i).next(o=>{let l=oi();return o.forEach((u,d)=>{l=l.insert(u,d.overlayedDocument)}),l}))}getOverlayedDocuments(e,t){let i=zt();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,U()))}populateOverlays(e,t,i){let s=[];return i.forEach(o=>{t.has(o)||s.push(o)}),this.documentOverlayCache.getOverlays(e,s).next(o=>{o.forEach((l,u)=>{t.set(l,u)})})}computeViews(e,t,i,s){let o=ft(),l=ci(),u=function(){return ci()}();return t.forEach((d,f)=>{let g=i.get(f.key);s.has(f.key)&&(g===void 0||g.mutation instanceof tt)?o=o.insert(f.key,f):g!==void 0?(l.set(f.key,g.mutation.getFieldMask()),ui(g.mutation,f,g.mutation.getFieldMask(),Ie.now())):l.set(f.key,Be.empty())}),this.recalculateAndSaveOverlays(e,o).next(d=>(d.forEach((f,g)=>l.set(f,g)),t.forEach((f,g)=>{var E;return u.set(f,new jo(g,(E=l.get(f))!==null&&E!==void 0?E:null))}),u))}recalculateAndSaveOverlays(e,t){let i=ci(),s=new ce((l,u)=>l-u),o=U();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(l=>{for(let u of l)u.keys().forEach(d=>{let f=t.get(d);if(f===null)return;let g=i.get(d)||Be.empty();g=u.applyToLocalView(f,g),i.set(d,g);let E=(s.get(u.batchId)||U()).add(d);s=s.insert(u.batchId,E)})}).next(()=>{let l=[],u=s.getReverseIterator();for(;u.hasNext();){let d=u.getNext(),f=d.key,g=d.value,E=ku();g.forEach(C=>{if(!o.has(C)){let S=Bu(t.get(C),i.get(C));S!==null&&E.set(C,S),o=o.add(C)}}),l.push(this.documentOverlayCache.saveOverlays(e,f,E))}return x.waitFor(l)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,s){return function(l){return M.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):up(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,s):this.getDocumentsMatchingCollectionQuery(e,t,i,s)}getNextDocuments(e,t,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,s).next(o=>{let l=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,s-o.size):x.resolve(zt()),u=-1,d=o;return l.next(f=>x.forEach(f,(g,E)=>(u<E.largestBatchId&&(u=E.largestBatchId),o.get(g)?x.resolve():this.remoteDocumentCache.getEntry(e,g).next(C=>{d=d.insert(g,C)}))).next(()=>this.populateOverlays(e,f,o)).next(()=>this.computeViews(e,d,f,U())).next(g=>({batchId:u,changes:Vu(g)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new M(t)).next(i=>{let s=oi();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,i,s){let o=t.collectionGroup,l=oi();return this.indexManager.getCollectionParents(e,o).next(u=>x.forEach(u,d=>{let f=function(E,C){return new Cn(C,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)}(t,d.child(o));return this.getDocumentsMatchingCollectionQuery(e,f,i,s).next(g=>{g.forEach((E,C)=>{l=l.insert(E,C)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(e,t,i,s){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(l=>(o=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,o,s))).next(l=>{o.forEach((d,f)=>{let g=f.getKey();l.get(g)===null&&(l=l.insert(g,ze.newInvalidDocument(g)))});let u=oi();return l.forEach((d,f)=>{let g=o.get(d);g!==void 0&&ui(g.mutation,f,Be.empty(),Ie.now()),Gr(t,f)&&(u=u.insert(d,f))}),u})}};var Go=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return x.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:Xe(s.createTime)}}(t)),x.resolve()}getNamedQuery(e,t){return x.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(s){return{name:s.name,query:$p(s.bundledQuery),readTime:Xe(s.readTime)}}(t)),x.resolve()}};var Ko=class{constructor(){this.overlays=new ce(M.comparator),this.Ir=new Map}getOverlay(e,t){return x.resolve(this.overlays.get(t))}getOverlays(e,t){let i=zt();return x.forEach(t,s=>this.getOverlay(e,s).next(o=>{o!==null&&i.set(s,o)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((s,o)=>{this.ht(e,t,o)}),x.resolve()}removeOverlaysForBatchId(e,t,i){let s=this.Ir.get(i);return s!==void 0&&(s.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(i)),x.resolve()}getOverlaysForCollection(e,t,i){let s=zt(),o=t.length+1,l=new M(t.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){let d=u.getNext().value,f=d.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===o&&d.largestBatchId>i&&s.set(d.getKey(),d)}return x.resolve(s)}getOverlaysForCollectionGroup(e,t,i,s){let o=new ce((f,g)=>f-g),l=this.overlays.getIterator();for(;l.hasNext();){let f=l.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>i){let g=o.get(f.largestBatchId);g===null&&(g=zt(),o=o.insert(f.largestBatchId,g)),g.set(f.getKey(),f)}}let u=zt(),d=o.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((f,g)=>u.set(f,g)),!(u.size()>=s)););return x.resolve(u)}ht(e,t,i){let s=this.overlays.get(i.key);if(s!==null){let l=this.Ir.get(s.largestBatchId).delete(i.key);this.Ir.set(s.largestBatchId,l)}this.overlays=this.overlays.insert(i.key,new Po(t,i));let o=this.Ir.get(t);o===void 0&&(o=U(),this.Ir.set(t,o)),this.Ir.set(t,o.add(i.key))}};var Qo=class{constructor(){this.sessionToken=xe.EMPTY_BYTE_STRING}getSessionToken(e){return x.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,x.resolve()}};var yi=class{constructor(){this.Tr=new Se(de.Er),this.dr=new Se(de.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let i=new de(e,t);this.Tr=this.Tr.add(i),this.dr=this.dr.add(i)}Rr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.Vr(new de(e,t))}mr(e,t){e.forEach(i=>this.removeReference(i,t))}gr(e){let t=new M(new le([])),i=new de(t,e),s=new de(t,e+1),o=[];return this.dr.forEachInRange([i,s],l=>{this.Vr(l),o.push(l.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new M(new le([])),i=new de(t,e),s=new de(t,e+1),o=U();return this.dr.forEachInRange([i,s],l=>{o=o.add(l.key)}),o}containsKey(e){let t=new de(e,0),i=this.Tr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}},de=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return M.comparator(e.key,t.key)||Q(e.wr,t.wr)}static Ar(e,t){return Q(e.wr,t.wr)||M.comparator(e.key,t.key)}};var Wo=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Se(de.Er)}checkEmpty(e){return x.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,s){let o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let l=new xo(o,t,i,s);this.mutationQueue.push(l);for(let u of s)this.br=this.br.add(new de(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return x.resolve(l)}lookupMutationBatch(e,t){return x.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let i=t+1,s=this.vr(i),o=s<0?0:s;return x.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return x.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return x.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let i=new de(t,0),s=new de(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([i,s],l=>{let u=this.Dr(l.wr);o.push(u)}),x.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Se(Q);return t.forEach(s=>{let o=new de(s,0),l=new de(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,l],u=>{i=i.add(u.wr)})}),x.resolve(this.Cr(i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,s=i.length+1,o=i;M.isDocumentKey(o)||(o=o.child(""));let l=new de(new M(o),0),u=new Se(Q);return this.br.forEachWhile(d=>{let f=d.key.path;return!!i.isPrefixOf(f)&&(f.length===s&&(u=u.add(d.wr)),!0)},l),x.resolve(this.Cr(u))}Cr(e){let t=[];return e.forEach(i=>{let s=this.Dr(i);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){J(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let i=this.br;return x.forEach(t.mutations,s=>{let o=new de(s.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=i})}On(e){}containsKey(e,t){let i=new de(t,0),s=this.br.firstAfterOrEqual(i);return x.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,x.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Ho=class{constructor(e){this.Mr=e,this.docs=function(){return new ce(M.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let i=t.key,s=this.docs.get(i),o=s?s.size:0,l=this.Mr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:l}),this.size+=l-o,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let i=this.docs.get(t);return x.resolve(i?i.document.mutableCopy():ze.newInvalidDocument(t))}getEntries(e,t){let i=ft();return t.forEach(s=>{let o=this.docs.get(s);i=i.insert(s,o?o.document.mutableCopy():ze.newInvalidDocument(s))}),x.resolve(i)}getDocumentsMatchingQuery(e,t,i,s){let o=ft(),l=t.path,u=new M(l.child("")),d=this.docs.getIteratorFrom(u);for(;d.hasNext();){let{key:f,value:{document:g}}=d.getNext();if(!l.isPrefixOf(f.path))break;f.path.length>l.length+1||Xf(Yf(g),i)<=0||(s.has(g.key)||Gr(t,g))&&(o=o.insert(g.key,g.mutableCopy()))}return x.resolve(o)}getAllFromCollectionGroup(e,t,i,s){L()}Or(e,t){return x.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new Jo(this)}getSize(e){return x.resolve(this.size)}},Jo=class extends zo{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((i,s)=>{s.isValidDocument()?t.push(this.cr.addEntry(e,s)):this.cr.removeEntry(i)}),x.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var Yo=class{constructor(e){this.persistence=e,this.Nr=new Rt(t=>Fa(t),Ba),this.lastRemoteSnapshotVersion=B.min(),this.highestTargetId=0,this.Lr=0,this.Br=new yi,this.targetCount=0,this.kr=_i.Bn()}forEachTarget(e,t){return this.Nr.forEach((i,s)=>t(s)),x.resolve()}getLastRemoteSnapshotVersion(e){return x.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return x.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),x.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.Lr&&(this.Lr=t),x.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new _i(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,x.resolve()}updateTargetData(e,t){return this.Kn(t),x.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,x.resolve()}removeTargets(e,t,i){let s=0,o=[];return this.Nr.forEach((l,u)=>{u.sequenceNumber<=t&&i.get(u.targetId)===null&&(this.Nr.delete(l),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),s++)}),x.waitFor(o).next(()=>s)}getTargetCount(e){return x.resolve(this.targetCount)}getTargetData(e,t){let i=this.Nr.get(t)||null;return x.resolve(i)}addMatchingKeys(e,t,i){return this.Br.Rr(t,i),x.resolve()}removeMatchingKeys(e,t,i){this.Br.mr(t,i);let s=this.persistence.referenceDelegate,o=[];return s&&t.forEach(l=>{o.push(s.markPotentiallyOrphaned(e,l))}),x.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),x.resolve()}getMatchingKeysForTargetId(e,t){let i=this.Br.yr(t);return x.resolve(i)}containsKey(e,t){return x.resolve(this.Br.containsKey(t))}};var Xo=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new vu(0),this.Kr=!1,this.Kr=!0,this.$r=new Qo,this.referenceDelegate=e(this),this.Ur=new Yo(this),this.indexManager=new qo,this.remoteDocumentCache=function(s){return new Ho(s)}(i=>this.referenceDelegate.Wr(i)),this.serializer=new Bo(t),this.Gr=new Go(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ko,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.qr[e.toKey()];return i||(i=new Wo(t,this.referenceDelegate),this.qr[e.toKey()]=i),i}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,i){k("MemoryPersistence","Starting transaction:",e);let s=new Zo(this.Qr.next());return this.referenceDelegate.zr(),i(s).next(o=>this.referenceDelegate.jr(s).next(()=>o)).toPromise().then(o=>(s.raiseOnCommittedEvent(),o))}Hr(e,t){return x.or(Object.values(this.qr).map(i=>()=>i.containsKey(e,t)))}},Zo=class extends uo{constructor(e){super(),this.currentSequenceNumber=e}},ea=class n{constructor(e){this.persistence=e,this.Jr=new yi,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw L()}addReference(e,t,i){return this.Jr.addReference(i,t),this.Xr.delete(i.toString()),x.resolve()}removeReference(e,t,i){return this.Jr.removeReference(i,t),this.Xr.add(i.toString()),x.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),x.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(s=>this.Xr.add(s.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(o=>this.Xr.add(o.toString()))}).next(()=>i.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return x.forEach(this.Xr,i=>{let s=M.fromPath(i);return this.ei(e,s).next(o=>{o||t.removeEntry(s,B.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(i=>{i?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return x.or([()=>x.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var ta=class n{constructor(e,t,i,s){this.targetId=e,this.fromCache=t,this.$i=i,this.Ui=s}static Wi(e,t){let i=U(),s=U();for(let o of t.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new n(e,t.fromCache,i,s)}};var na=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var ia=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return vc()?8:ep(yc())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,i,s){let o={result:null};return this.Yi(e,t).next(l=>{o.result=l}).next(()=>{if(!o.result)return this.Zi(e,t,s,i).next(l=>{o.result=l})}).next(()=>{if(o.result)return;let l=new na;return this.Xi(e,t,l).next(u=>{if(o.result=u,this.zi)return this.es(e,t,l,u.size)})}).next(()=>o.result)}es(e,t,i,s){return i.documentReadCount<this.ji?(si()<=ot.DEBUG&&k("QueryEngine","SDK will not create cache indexes for query:",fn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),x.resolve()):(si()<=ot.DEBUG&&k("QueryEngine","Query:",fn(t),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.Hi*s?(si()<=ot.DEBUG&&k("QueryEngine","The SDK decides to create cache indexes for query:",fn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ye(t))):x.resolve())}Yi(e,t){if(Hc(t))return x.resolve(null);let i=Ye(t);return this.indexManager.getIndexType(e,i).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=Co(t,null,"F"),i=Ye(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(o=>{let l=U(...o);return this.Ji.getDocuments(e,l).next(u=>this.indexManager.getMinOffset(e,i).next(d=>{let f=this.ts(t,u);return this.ns(t,f,l,d.readTime)?this.Yi(e,Co(t,null,"F")):this.rs(e,f,t,d)}))})))}Zi(e,t,i,s){return Hc(t)||s.isEqual(B.min())?x.resolve(null):this.Ji.getDocuments(e,i).next(o=>{let l=this.ts(t,o);return this.ns(t,l,i,s)?x.resolve(null):(si()<=ot.DEBUG&&k("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),fn(t)),this.rs(e,l,t,Jf(s,-1)).next(u=>u))})}ts(e,t){let i=new Se(Pu(e));return t.forEach((s,o)=>{Gr(e,o)&&(i=i.add(o))}),i}ns(e,t,i,s){if(e.limit===null)return!1;if(i.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}Xi(e,t,i){return si()<=ot.DEBUG&&k("QueryEngine","Using full collection scan to execute query:",fn(t)),this.Ji.getDocumentsMatchingQuery(e,t,Kt.min(),i)}rs(e,t,i,s){return this.Ji.getDocumentsMatchingQuery(e,i,s).next(o=>(t.forEach(l=>{o=o.insert(l.key,l)}),o))}};var ra=class{constructor(e,t,i,s){this.persistence=e,this.ss=t,this.serializer=s,this.os=new ce(Q),this._s=new Rt(o=>Fa(o),Ba),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(i)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new $o(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function Gp(n,e,t,i){return new ra(n,e,t,i)}function Hu(n,e){return V(this,null,function*(){let t=F(n);return yield t.persistence.runTransaction("Handle user change","readonly",i=>{let s;return t.mutationQueue.getAllMutationBatches(i).next(o=>(s=o,t.ls(e),t.mutationQueue.getAllMutationBatches(i))).next(o=>{let l=[],u=[],d=U();for(let f of s){l.push(f.batchId);for(let g of f.mutations)d=d.add(g.key)}for(let f of o){u.push(f.batchId);for(let g of f.mutations)d=d.add(g.key)}return t.localDocuments.getDocuments(i,d).next(f=>({hs:f,removedBatchIds:l,addedBatchIds:u}))})})})}function Kp(n,e){let t=F(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let s=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return function(u,d,f,g){let E=f.batch,C=E.keys(),S=x.resolve();return C.forEach(D=>{S=S.next(()=>g.getEntry(d,D)).next(N=>{let P=f.docVersions.get(D);J(P!==null),N.version.compareTo(P)<0&&(E.applyToRemoteDocument(N,f),N.isValidDocument()&&(N.setReadTime(f.commitVersion),g.addEntry(N)))})}),S.next(()=>u.mutationQueue.removeMutationBatch(d,E))}(t,i,e,o).next(()=>o.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(u){let d=U();for(let f=0;f<u.mutationResults.length;++f)u.mutationResults[f].transformResults.length>0&&(d=d.add(u.batch.mutations[f].key));return d}(e))).next(()=>t.localDocuments.getDocuments(i,s))})}function Ju(n){let e=F(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function Qp(n,e){let t=F(n),i=e.snapshotVersion,s=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let l=t.cs.newChangeBuffer({trackRemovals:!0});s=t.os;let u=[];e.targetChanges.forEach((g,E)=>{let C=s.get(E);if(!C)return;u.push(t.Ur.removeMatchingKeys(o,g.removedDocuments,E).next(()=>t.Ur.addMatchingKeys(o,g.addedDocuments,E)));let S=C.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(E)!==null?S=S.withResumeToken(xe.EMPTY_BYTE_STRING,B.min()).withLastLimboFreeSnapshotVersion(B.min()):g.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(g.resumeToken,i)),s=s.insert(E,S),function(N,P,z){return N.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-N.snapshotVersion.toMicroseconds()>=3e8?!0:z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0}(C,S,g)&&u.push(t.Ur.updateTargetData(o,S))});let d=ft(),f=U();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(o,g))}),u.push(Wp(o,l,e.documentUpdates).next(g=>{d=g.Ps,f=g.Is})),!i.isEqual(B.min())){let g=t.Ur.getLastRemoteSnapshotVersion(o).next(E=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,i));u.push(g)}return x.waitFor(u).next(()=>l.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,d,f)).next(()=>d)}).then(o=>(t.os=s,o))}function Wp(n,e,t){let i=U(),s=U();return t.forEach(o=>i=i.add(o)),e.getEntries(n,i).next(o=>{let l=ft();return t.forEach((u,d)=>{let f=o.get(u);d.isFoundDocument()!==f.isFoundDocument()&&(s=s.add(u)),d.isNoDocument()&&d.version.isEqual(B.min())?(e.removeEntry(u,d.readTime),l=l.insert(u,d)):!f.isValidDocument()||d.version.compareTo(f.version)>0||d.version.compareTo(f.version)===0&&f.hasPendingWrites?(e.addEntry(d),l=l.insert(u,d)):k("LocalStore","Ignoring outdated watch update for ",u,". Current version:",f.version," Watch version:",d.version)}),{Ps:l,Is:s}})}function Hp(n,e){let t=F(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function Jp(n,e){let t=F(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let s;return t.Ur.getTargetData(i,e).next(o=>o?(s=o,x.resolve(s)):t.Ur.allocateTargetId(i).next(l=>(s=new gi(e,l,"TargetPurposeListen",i.currentSequenceNumber),t.Ur.addTargetData(i,s).next(()=>s))))}).then(i=>{let s=t.os.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.os=t.os.insert(i.targetId,i),t._s.set(e,i.targetId)),i})}function sa(n,e,t){return V(this,null,function*(){let i=F(n),s=i.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield i.persistence.runTransaction("Release target",o,l=>i.persistence.referenceDelegate.removeTarget(l,s)))}catch(l){if(!bi(l))throw l;k("LocalStore",`Failed to update sequence numbers for target ${e}: ${l}`)}i.os=i.os.remove(e),i._s.delete(s.target)})}function ou(n,e,t){let i=F(n),s=B.min(),o=U();return i.persistence.runTransaction("Execute query","readwrite",l=>function(d,f,g){let E=F(d),C=E._s.get(g);return C!==void 0?x.resolve(E.os.get(C)):E.Ur.getTargetData(f,g)}(i,l,Ye(e)).next(u=>{if(u)return s=u.lastLimboFreeSnapshotVersion,i.Ur.getMatchingKeysForTargetId(l,u.targetId).next(d=>{o=d})}).next(()=>i.ss.getDocumentsMatchingQuery(l,e,t?s:B.min(),t?o:U())).next(u=>(Yp(i,dp(e),u),{documents:u,Ts:o})))}function Yp(n,e,t){let i=n.us.get(e)||B.min();t.forEach((s,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)}),n.us.set(e,i)}var Cr=class{constructor(){this.activeTargetIds=yp()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var oa=class{constructor(){this.so=new Cr,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,i){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Cr,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var aa=class{_o(e){}shutdown(){}};var Ar=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){k("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){k("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var cr=null;function Zs(){return cr===null?cr=function(){return 268435456+Math.round(2147483648*Math.random())}():cr++,"0x"+cr.toString(16)}var Xp={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var la=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Ae="WebChannelConnection",ca=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let i=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=i+"://"+t.host,this.vo=`projects/${s}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${o}`}get Fo(){return!1}Mo(t,i,s,o,l){let u=Zs(),d=this.xo(t,i.toUriEncodedString());k("RestConnection",`Sending RPC '${t}' ${u}:`,d,s);let f={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(f,o,l),this.No(t,d,f,s).then(g=>(k("RestConnection",`Received RPC '${t}' ${u}: `,g),g),g=>{throw vn("RestConnection",`RPC '${t}' ${u} failed with error: `,g,"url: ",d,"request:",s),g})}Lo(t,i,s,o,l,u){return this.Mo(t,i,s,o,l)}Oo(t,i,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+kn}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((o,l)=>t[l]=o),s&&s.headers.forEach((o,l)=>t[l]=o)}xo(t,i){let s=Xp[t];return`${this.Do}/v1/${i}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,i,s){let o=Zs();return new Promise((l,u)=>{let d=new Qs;d.setWithCredentials(!0),d.listenOnce(Ws.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case ri.NO_ERROR:let g=d.getResponseJson();k(Ae,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(g)),l(g);break;case ri.TIMEOUT:k(Ae,`RPC '${e}' ${o} timed out`),u(new O(A.DEADLINE_EXCEEDED,"Request time out"));break;case ri.HTTP_ERROR:let E=d.getStatus();if(k(Ae,`RPC '${e}' ${o} failed with status:`,E,"response text:",d.getResponseText()),E>0){let C=d.getResponseJson();Array.isArray(C)&&(C=C[0]);let S=C?.error;if(S&&S.status&&S.message){let D=function(P){let z=P.toLowerCase().replace(/_/g,"-");return Object.values(A).indexOf(z)>=0?z:A.UNKNOWN}(S.status);u(new O(D,S.message))}else u(new O(A.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new O(A.UNAVAILABLE,"Connection failed."));break;default:L()}}finally{k(Ae,`RPC '${e}' ${o} completed.`)}});let f=JSON.stringify(s);k(Ae,`RPC '${e}' ${o} sending request:`,s),d.send(t,"POST",f,i,15)})}Bo(e,t,i){let s=Zs(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=Ys(),u=Js(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(d.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Oo(d.initMessageHeaders,t,i),d.encodeInitMessageHeaders=!0;let g=o.join("");k(Ae,`Creating RPC '${e}' stream ${s}: ${g}`,d);let E=l.createWebChannel(g,d),C=!1,S=!1,D=new la({Io:P=>{S?k(Ae,`Not sending because RPC '${e}' stream ${s} is closed:`,P):(C||(k(Ae,`Opening RPC '${e}' stream ${s} transport.`),E.open(),C=!0),k(Ae,`RPC '${e}' stream ${s} sending:`,P),E.send(P))},To:()=>E.close()}),N=(P,z,G)=>{P.listen(z,H=>{try{G(H)}catch(oe){setTimeout(()=>{throw oe},0)}})};return N(E,dn.EventType.OPEN,()=>{S||(k(Ae,`RPC '${e}' stream ${s} transport opened.`),D.yo())}),N(E,dn.EventType.CLOSE,()=>{S||(S=!0,k(Ae,`RPC '${e}' stream ${s} transport closed`),D.So())}),N(E,dn.EventType.ERROR,P=>{S||(S=!0,vn(Ae,`RPC '${e}' stream ${s} transport errored:`,P),D.So(new O(A.UNAVAILABLE,"The operation could not be completed")))}),N(E,dn.EventType.MESSAGE,P=>{var z;if(!S){let G=P.data[0];J(!!G);let H=G,oe=H.error||((z=H[0])===null||z===void 0?void 0:z.error);if(oe){k(Ae,`RPC '${e}' stream ${s} received error:`,oe);let Le=oe.status,te=function(_){let y=he[_];if(y!==void 0)return Uu(y)}(Le),I=oe.message;te===void 0&&(te=A.INTERNAL,I="Unknown error status: "+Le+" with message "+oe.message),S=!0,D.So(new O(te,I)),E.close()}else k(Ae,`RPC '${e}' stream ${s} received:`,G),D.bo(G)}}),N(u,Hs.STAT_EVENT,P=>{P.stat===ar.PROXY?k(Ae,`RPC '${e}' stream ${s} detected buffering proxy`):P.stat===ar.NOPROXY&&k(Ae,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{D.wo()},0),D}};function eo(){return typeof document<"u"?document:null}function Kr(n){return new No(n,!0)}var Sr=class{constructor(e,t,i=1e3,s=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=i,this.qo=s,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),i=Math.max(0,Date.now()-this.Uo),s=Math.max(0,t-i);s>0&&k("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var xr=class{constructor(e,t,i,s,o,l,u,d){this.ui=e,this.Ho=i,this.Jo=s,this.connection=o,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=d,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Sr(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return V(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return V(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return V(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===A.RESOURCE_EXHAUSTED?(ht(t.toString()),ht("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===A.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,s])=>{this.Yo===t&&this.P_(i,s)},i=>{e(()=>{let s=new O(A.UNKNOWN,"Fetching auth token failed: "+i.message);return this.I_(s)})})}P_(e,t){let i=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{i(()=>this.listener.Eo())}),this.stream.Ro(()=>{i(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{i(()=>this.I_(s))}),this.stream.onMessage(s=>{i(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(()=>V(this,null,function*(){this.state=0,this.start()}))}I_(e){return k("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(k("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},ua=class extends xr{constructor(e,t,i,s,o,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,s,l),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=kp(this.serializer,e),i=function(o){if(!("targetChange"in o))return B.min();let l=o.targetChange;return l.targetIds&&l.targetIds.length?B.min():l.readTime?Xe(l.readTime):B.min()}(e);return this.listener.d_(t,i)}A_(e){let t={};t.database=Fo(this.serializer),t.addTarget=function(o,l){let u,d=l.target;if(u=bo(d)?{documents:Mp(o,d)}:{query:Lp(o,d)._t},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=zu(o,l.resumeToken);let f=Oo(o,l.expectedCount);f!==null&&(u.expectedCount=f)}else if(l.snapshotVersion.compareTo(B.min())>0){u.readTime=Er(o,l.snapshotVersion.toTimestamp());let f=Oo(o,l.expectedCount);f!==null&&(u.expectedCount=f)}return u}(this.serializer,e);let i=Bp(this.serializer,e);i&&(t.labels=i),this.a_(t)}R_(e){let t={};t.database=Fo(this.serializer),t.removeTarget=e,this.a_(t)}},ha=class extends xr{constructor(e,t,i,s,o,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,s,l),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return J(!!e.streamToken),this.lastStreamToken=e.streamToken,J(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){J(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=Op(e.writeResults,e.commitTime),i=Xe(e.commitTime);return this.listener.g_(i,t)}p_(){let e={};e.database=Fo(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(i=>Np(this.serializer,i))};this.a_(t)}};var da=class extends class{}{constructor(e,t,i,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new O(A.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Mo(e,Mo(t,i),s,o,l)).catch(o=>{throw o.name==="FirebaseError"?(o.code===A.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new O(A.UNKNOWN,o.toString())})}Lo(e,t,i,s,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,u])=>this.connection.Lo(e,Mo(t,i),s,l,u,o)).catch(l=>{throw l.name==="FirebaseError"?(l.code===A.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new O(A.UNKNOWN,l.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},fa=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ht(t),this.D_=!1):k("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var pa=class{constructor(e,t,i,s,o){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(l=>{i.enqueueAndForget(()=>V(this,null,function*(){Xt(this)&&(k("RemoteStore","Restarting streams for network reachability change."),yield function(d){return V(this,null,function*(){let f=F(d);f.L_.add(4),yield Ci(f),f.q_.set("Unknown"),f.L_.delete(4),yield Qr(f)})}(this))}))}),this.q_=new fa(i,s)}};function Qr(n){return V(this,null,function*(){if(Xt(n))for(let e of n.B_)yield e(!0)})}function Ci(n){return V(this,null,function*(){for(let e of n.B_)yield e(!1)})}function Yu(n,e){let t=F(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Ka(t)?Ga(t):Nn(t).r_()&&$a(t,e))}function ja(n,e){let t=F(n),i=Nn(t);t.N_.delete(e),i.r_()&&Xu(t,e),t.N_.size===0&&(i.r_()?i.o_():Xt(t)&&t.q_.set("Unknown"))}function $a(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(B.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Nn(n).A_(e)}function Xu(n,e){n.Q_.xe(e),Nn(n).R_(e)}function Ga(n){n.Q_=new ko({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Nn(n).start(),n.q_.v_()}function Ka(n){return Xt(n)&&!Nn(n).n_()&&n.N_.size>0}function Xt(n){return F(n).L_.size===0}function Zu(n){n.Q_=void 0}function Zp(n){return V(this,null,function*(){n.q_.set("Online")})}function em(n){return V(this,null,function*(){n.N_.forEach((e,t)=>{$a(n,e)})})}function tm(n,e){return V(this,null,function*(){Zu(n),Ka(n)?(n.q_.M_(e),Ga(n)):n.q_.set("Unknown")})}function nm(n,e,t){return V(this,null,function*(){if(n.q_.set("Online"),e instanceof Tr&&e.state===2&&e.cause)try{yield function(s,o){return V(this,null,function*(){let l=o.cause;for(let u of o.targetIds)s.N_.has(u)&&(yield s.remoteSyncer.rejectListen(u,l),s.N_.delete(u),s.Q_.removeTarget(u))})}(n,e)}catch(i){k("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield Rr(n,i)}else if(e instanceof _n?n.Q_.Ke(e):e instanceof Ir?n.Q_.He(e):n.Q_.We(e),!t.isEqual(B.min()))try{let i=yield Ju(n.localStore);t.compareTo(i)>=0&&(yield function(o,l){let u=o.Q_.rt(l);return u.targetChanges.forEach((d,f)=>{if(d.resumeToken.approximateByteSize()>0){let g=o.N_.get(f);g&&o.N_.set(f,g.withResumeToken(d.resumeToken,l))}}),u.targetMismatches.forEach((d,f)=>{let g=o.N_.get(d);if(!g)return;o.N_.set(d,g.withResumeToken(xe.EMPTY_BYTE_STRING,g.snapshotVersion)),Xu(o,d);let E=new gi(g.target,d,f,g.sequenceNumber);$a(o,E)}),o.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(i){k("RemoteStore","Failed to raise snapshot:",i),yield Rr(n,i)}})}function Rr(n,e,t){return V(this,null,function*(){if(!bi(e))throw e;n.L_.add(1),yield Ci(n),n.q_.set("Offline"),t||(t=()=>Ju(n.localStore)),n.asyncQueue.enqueueRetryable(()=>V(this,null,function*(){k("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield Qr(n)}))})}function eh(n,e){return e().catch(t=>Rr(n,t,e))}function Wr(n){return V(this,null,function*(){let e=F(n),t=Pt(e),i=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;im(e);)try{let s=yield Hp(e.localStore,i);if(s===null){e.O_.length===0&&t.o_();break}i=s.batchId,rm(e,s)}catch(s){yield Rr(e,s)}th(e)&&nh(e)})}function im(n){return Xt(n)&&n.O_.length<10}function rm(n,e){n.O_.push(e);let t=Pt(n);t.r_()&&t.V_&&t.m_(e.mutations)}function th(n){return Xt(n)&&!Pt(n).n_()&&n.O_.length>0}function nh(n){Pt(n).start()}function sm(n){return V(this,null,function*(){Pt(n).p_()})}function om(n){return V(this,null,function*(){let e=Pt(n);for(let t of n.O_)e.m_(t.mutations)})}function am(n,e,t){return V(this,null,function*(){let i=n.O_.shift(),s=Ro.from(i,e,t);yield eh(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),yield Wr(n)})}function lm(n,e){return V(this,null,function*(){e&&Pt(n).V_&&(yield function(i,s){return V(this,null,function*(){if(function(l){return Cp(l)&&l!==A.ABORTED}(s.code)){let o=i.O_.shift();Pt(i).s_(),yield eh(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield Wr(i)}})}(n,e)),th(n)&&nh(n)})}function au(n,e){return V(this,null,function*(){let t=F(n);t.asyncQueue.verifyOperationInProgress(),k("RemoteStore","RemoteStore received new credentials");let i=Xt(t);t.L_.add(3),yield Ci(t),i&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield Qr(t)})}function cm(n,e){return V(this,null,function*(){let t=F(n);e?(t.L_.delete(2),yield Qr(t)):e||(t.L_.add(2),yield Ci(t),t.q_.set("Unknown"))})}function Nn(n){return n.K_||(n.K_=function(t,i,s){let o=F(t);return o.w_(),new ua(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(n.datastore,n.asyncQueue,{Eo:Zp.bind(null,n),Ro:em.bind(null,n),mo:tm.bind(null,n),d_:nm.bind(null,n)}),n.B_.push(e=>V(this,null,function*(){e?(n.K_.s_(),Ka(n)?Ga(n):n.q_.set("Unknown")):(yield n.K_.stop(),Zu(n))}))),n.K_}function Pt(n){return n.U_||(n.U_=function(t,i,s){let o=F(t);return o.w_(),new ha(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:sm.bind(null,n),mo:lm.bind(null,n),f_:om.bind(null,n),g_:am.bind(null,n)}),n.B_.push(e=>V(this,null,function*(){e?(n.U_.s_(),yield Wr(n)):(yield n.U_.stop(),n.O_.length>0&&(k("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var ma=class n{constructor(e,t,i,s,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=s,this.removalCallback=o,this.deferred=new ct,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,s,o){let l=Date.now()+i,u=new n(e,t,l,s,o);return u.start(i),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new O(A.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Qa(n,e){if(ht("AsyncQueue",`${e}: ${n}`),bi(n))return new O(A.UNAVAILABLE,`${e}: ${n}`);throw n}var Pr=class n{constructor(e){this.comparator=e?(t,i)=>e(t,i)||M.comparator(t.key,i.key):(t,i)=>M.comparator(t.key,i.key),this.keyedMap=oi(),this.sortedSet=new ce(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){let s=t.getNext().key,o=i.getNext().key;if(!s.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let i=new n;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}};var Dr=class{constructor(){this.W_=new ce(M.comparator)}track(e){let t=e.doc.key,i=this.W_.get(t);i?e.type!==0&&i.type===3?this.W_=this.W_.insert(t,e):e.type===3&&i.type!==1?this.W_=this.W_.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.W_=this.W_.remove(t):e.type===1&&i.type===2?this.W_=this.W_.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):L():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,i)=>{e.push(i)}),e}},Pn=class n{constructor(e,t,i,s,o,l,u,d,f){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=o,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=d,this.hasCachedResults=f}static fromInitialDocuments(e,t,i,s,o){let l=[];return t.forEach(u=>{l.push({type:0,doc:u})}),new n(e,t,Pr.emptySet(t),l,i,s,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&$r(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==i[s].type||!t[s].doc.isEqual(i[s].doc))return!1;return!0}};var ga=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},_a=class{constructor(){this.queries=lu(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,i){let s=F(t),o=s.queries;s.queries=lu(),o.forEach((l,u)=>{for(let d of u.j_)d.onError(i)})})(this,new O(A.ABORTED,"Firestore shutting down"))}};function lu(){return new Rt(n=>Ru(n),$r)}function um(n,e){return V(this,null,function*(){let t=F(n),i=3,s=e.query,o=t.queries.get(s);o?!o.H_()&&e.J_()&&(i=2):(o=new ga,i=e.J_()?0:1);try{switch(i){case 0:o.z_=yield t.onListen(s,!0);break;case 1:o.z_=yield t.onListen(s,!1);break;case 2:yield t.onFirstRemoteStoreListen(s)}}catch(l){let u=Qa(l,`Initialization of query '${fn(e.query)}' failed`);return void e.onError(u)}t.queries.set(s,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&Wa(t)})}function hm(n,e){return V(this,null,function*(){let t=F(n),i=e.query,s=3,o=t.queries.get(i);if(o){let l=o.j_.indexOf(e);l>=0&&(o.j_.splice(l,1),o.j_.length===0?s=e.J_()?0:1:!o.H_()&&e.J_()&&(s=2))}switch(s){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}})}function dm(n,e){let t=F(n),i=!1;for(let s of e){let o=s.query,l=t.queries.get(o);if(l){for(let u of l.j_)u.X_(s)&&(i=!0);l.z_=s}}i&&Wa(t)}function fm(n,e,t){let i=F(n),s=i.queries.get(e);if(s)for(let o of s.j_)o.onError(t);i.queries.delete(e)}function Wa(n){n.Y_.forEach(e=>{e.next()})}var ya,cu;(cu=ya||(ya={})).ea="default",cu.Cache="cache";var va=class{constructor(e,t,i){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=i||{}}X_(e){if(!this.options.includeMetadataChanges){let i=[];for(let s of e.docChanges)s.type!==3&&i.push(s);e=new Pn(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let i=t!=="Offline";return(!this.options._a||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Pn.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==ya.Cache}};var Vr=class{constructor(e){this.key=e}},kr=class{constructor(e){this.key=e}},Ia=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=U(),this.mutatedKeys=U(),this.Aa=Pu(e),this.Ra=new Pr(this.Aa)}get Va(){return this.Ta}ma(e,t){let i=t?t.fa:new Dr,s=t?t.Ra:this.Ra,o=t?t.mutatedKeys:this.mutatedKeys,l=s,u=!1,d=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,f=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((g,E)=>{let C=s.get(g),S=Gr(this.query,E)?E:null,D=!!C&&this.mutatedKeys.has(C.key),N=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations),P=!1;C&&S?C.data.isEqual(S.data)?D!==N&&(i.track({type:3,doc:S}),P=!0):this.ga(C,S)||(i.track({type:2,doc:S}),P=!0,(d&&this.Aa(S,d)>0||f&&this.Aa(S,f)<0)&&(u=!0)):!C&&S?(i.track({type:0,doc:S}),P=!0):C&&!S&&(i.track({type:1,doc:C}),P=!0,(d||f)&&(u=!0)),P&&(S?(l=l.add(S),o=N?o.add(g):o.delete(g)):(l=l.delete(g),o=o.delete(g)))}),this.query.limit!==null)for(;l.size>this.query.limit;){let g=this.query.limitType==="F"?l.last():l.first();l=l.delete(g.key),o=o.delete(g.key),i.track({type:1,doc:g})}return{Ra:l,fa:i,ns:u,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,s){let o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let l=e.fa.G_();l.sort((g,E)=>function(S,D){let N=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return L()}};return N(S)-N(D)}(g.type,E.type)||this.Aa(g.doc,E.doc)),this.pa(i),s=s!=null&&s;let u=t&&!s?this.ya():[],d=this.da.size===0&&this.current&&!s?1:0,f=d!==this.Ea;return this.Ea=d,l.length!==0||f?{snapshot:new Pn(this.query,e.Ra,o,l,e.mutatedKeys,d===0,f,!1,!!i&&i.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Dr,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=U(),this.Ra.forEach(i=>{this.Sa(i.key)&&(this.da=this.da.add(i.key))});let t=[];return e.forEach(i=>{this.da.has(i)||t.push(new kr(i))}),this.da.forEach(i=>{e.has(i)||t.push(new Vr(i))}),t}ba(e){this.Ta=e.Ts,this.da=U();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Pn.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},Ta=class{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}},wa=class{constructor(e){this.key=e,this.va=!1}},Ea=class{constructor(e,t,i,s,o,l){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=l,this.Ca={},this.Fa=new Rt(u=>Ru(u),$r),this.Ma=new Map,this.xa=new Set,this.Oa=new ce(M.comparator),this.Na=new Map,this.La=new yi,this.Ba={},this.ka=new Map,this.qa=_i.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function pm(n,e,t=!0){return V(this,null,function*(){let i=lh(n),s,o=i.Fa.get(e);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),s=o.view.Da()):s=yield ih(i,e,t,!0),s})}function mm(n,e){return V(this,null,function*(){let t=lh(n);yield ih(t,e,!0,!1)})}function ih(n,e,t,i){return V(this,null,function*(){let s=yield Jp(n.localStore,Ye(e)),o=s.targetId,l=n.sharedClientState.addLocalQueryTarget(o,t),u;return i&&(u=yield gm(n,e,o,l==="current",s.resumeToken)),n.isPrimaryClient&&t&&Yu(n.remoteStore,s),u})}function gm(n,e,t,i,s){return V(this,null,function*(){n.Ka=(E,C,S)=>function(N,P,z,G){return V(this,null,function*(){let H=P.view.ma(z);H.ns&&(H=yield ou(N.localStore,P.query,!1).then(({documents:I})=>P.view.ma(I,H)));let oe=G&&G.targetChanges.get(P.targetId),Le=G&&G.targetMismatches.get(P.targetId)!=null,te=P.view.applyChanges(H,N.isPrimaryClient,oe,Le);return hu(N,P.targetId,te.wa),te.snapshot})}(n,E,C,S);let o=yield ou(n.localStore,e,!0),l=new Ia(e,o.Ts),u=l.ma(o.documents),d=mi.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",s),f=l.applyChanges(u,n.isPrimaryClient,d);hu(n,t,f.wa);let g=new Ta(e,t,l);return n.Fa.set(e,g),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),f.snapshot})}function _m(n,e,t){return V(this,null,function*(){let i=F(n),s=i.Fa.get(e),o=i.Ma.get(s.targetId);if(o.length>1)return i.Ma.set(s.targetId,o.filter(l=>!$r(l,e))),void i.Fa.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||(yield sa(i.localStore,s.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(s.targetId),t&&ja(i.remoteStore,s.targetId),ba(i,s.targetId)}).catch(Ei))):(ba(i,s.targetId),yield sa(i.localStore,s.targetId,!0))})}function ym(n,e){return V(this,null,function*(){let t=F(n),i=t.Fa.get(e),s=t.Ma.get(i.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),ja(t.remoteStore,i.targetId))})}function vm(n,e,t){return V(this,null,function*(){let i=Am(n);try{let s=yield function(l,u){let d=F(l),f=Ie.now(),g=u.reduce((S,D)=>S.add(D.key),U()),E,C;return d.persistence.runTransaction("Locally write mutations","readwrite",S=>{let D=ft(),N=U();return d.cs.getEntries(S,g).next(P=>{D=P,D.forEach((z,G)=>{G.isValidDocument()||(N=N.add(z))})}).next(()=>d.localDocuments.getOverlayedDocuments(S,D)).next(P=>{E=P;let z=[];for(let G of u){let H=bp(G,E.get(G.key).overlayedDocument);H!=null&&z.push(new tt(G.key,H,Eu(H.value.mapValue),ut.exists(!0)))}return d.mutationQueue.addMutationBatch(S,f,z,u)}).next(P=>{C=P;let z=P.applyToLocalDocumentSet(E,N);return d.documentOverlayCache.saveOverlays(S,P.batchId,z)})}).then(()=>({batchId:C.batchId,changes:Vu(E)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(s.batchId),function(l,u,d){let f=l.Ba[l.currentUser.toKey()];f||(f=new ce(Q)),f=f.insert(u,d),l.Ba[l.currentUser.toKey()]=f}(i,s.batchId,t),yield Ai(i,s.changes),yield Wr(i.remoteStore)}catch(s){let o=Qa(s,"Failed to persist write");t.reject(o)}})}function rh(n,e){return V(this,null,function*(){let t=F(n);try{let i=yield Qp(t.localStore,e);e.targetChanges.forEach((s,o)=>{let l=t.Na.get(o);l&&(J(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?l.va=!0:s.modifiedDocuments.size>0?J(l.va):s.removedDocuments.size>0&&(J(l.va),l.va=!1))}),yield Ai(t,i,e)}catch(i){yield Ei(i)}})}function uu(n,e,t){let i=F(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){let s=[];i.Fa.forEach((o,l)=>{let u=l.view.Z_(e);u.snapshot&&s.push(u.snapshot)}),function(l,u){let d=F(l);d.onlineState=u;let f=!1;d.queries.forEach((g,E)=>{for(let C of E.j_)C.Z_(u)&&(f=!0)}),f&&Wa(d)}(i.eventManager,e),s.length&&i.Ca.d_(s),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function Im(n,e,t){return V(this,null,function*(){let i=F(n);i.sharedClientState.updateQueryState(e,"rejected",t);let s=i.Na.get(e),o=s&&s.key;if(o){let l=new ce(M.comparator);l=l.insert(o,ze.newNoDocument(o,B.min()));let u=U().add(o),d=new vr(B.min(),new Map,new ce(Q),l,u);yield rh(i,d),i.Oa=i.Oa.remove(o),i.Na.delete(e),Ha(i)}else yield sa(i.localStore,e,!1).then(()=>ba(i,e,t)).catch(Ei)})}function Tm(n,e){return V(this,null,function*(){let t=F(n),i=e.batch.batchId;try{let s=yield Kp(t.localStore,e);oh(t,i,null),sh(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),yield Ai(t,s)}catch(s){yield Ei(s)}})}function wm(n,e,t){return V(this,null,function*(){let i=F(n);try{let s=yield function(l,u){let d=F(l);return d.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let g;return d.mutationQueue.lookupMutationBatch(f,u).next(E=>(J(E!==null),g=E.keys(),d.mutationQueue.removeMutationBatch(f,E))).next(()=>d.mutationQueue.performConsistencyCheck(f)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(f,g,u)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,g)).next(()=>d.localDocuments.getDocuments(f,g))})}(i.localStore,e);oh(i,e,t),sh(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),yield Ai(i,s)}catch(s){yield Ei(s)}})}function sh(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function oh(n,e,t){let i=F(n),s=i.Ba[i.currentUser.toKey()];if(s){let o=s.get(e);o&&(t?o.reject(t):o.resolve(),s=s.remove(e)),i.Ba[i.currentUser.toKey()]=s}}function ba(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let i of n.Ma.get(e))n.Fa.delete(i),t&&n.Ca.$a(i,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(i=>{n.La.containsKey(i)||ah(n,i)})}function ah(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(ja(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Ha(n))}function hu(n,e,t){for(let i of t)i instanceof Vr?(n.La.addReference(i.key,e),Em(n,i)):i instanceof kr?(k("SyncEngine","Document no longer in limbo: "+i.key),n.La.removeReference(i.key,e),n.La.containsKey(i.key)||ah(n,i.key)):L()}function Em(n,e){let t=e.key,i=t.path.canonicalString();n.Oa.get(t)||n.xa.has(i)||(k("SyncEngine","New document in limbo: "+t),n.xa.add(i),Ha(n))}function Ha(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new M(le.fromString(e)),i=n.qa.next();n.Na.set(i,new wa(t)),n.Oa=n.Oa.insert(t,i),Yu(n.remoteStore,new gi(Ye(qa(t.path)),i,"TargetPurposeLimboResolution",vu.oe))}}function Ai(n,e,t){return V(this,null,function*(){let i=F(n),s=[],o=[],l=[];i.Fa.isEmpty()||(i.Fa.forEach((u,d)=>{l.push(i.Ka(d,e,t).then(f=>{var g;if((f||t)&&i.isPrimaryClient){let E=f?!f.fromCache:(g=t?.targetChanges.get(d.targetId))===null||g===void 0?void 0:g.current;i.sharedClientState.updateQueryState(d.targetId,E?"current":"not-current")}if(f){s.push(f);let E=ta.Wi(d.targetId,f);o.push(E)}}))}),yield Promise.all(l),i.Ca.d_(s),yield function(d,f){return V(this,null,function*(){let g=F(d);try{yield g.persistence.runTransaction("notifyLocalViewChanges","readwrite",E=>x.forEach(f,C=>x.forEach(C.$i,S=>g.persistence.referenceDelegate.addReference(E,C.targetId,S)).next(()=>x.forEach(C.Ui,S=>g.persistence.referenceDelegate.removeReference(E,C.targetId,S)))))}catch(E){if(!bi(E))throw E;k("LocalStore","Failed to update sequence numbers: "+E)}for(let E of f){let C=E.targetId;if(!E.fromCache){let S=g.os.get(C),D=S.snapshotVersion,N=S.withLastLimboFreeSnapshotVersion(D);g.os=g.os.insert(C,N)}}})}(i.localStore,o))})}function bm(n,e){return V(this,null,function*(){let t=F(n);if(!t.currentUser.isEqual(e)){k("SyncEngine","User change. New user:",e.toKey());let i=yield Hu(t.localStore,e);t.currentUser=e,function(o,l){o.ka.forEach(u=>{u.forEach(d=>{d.reject(new O(A.CANCELLED,l))})}),o.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),yield Ai(t,i.hs)}})}function Cm(n,e){let t=F(n),i=t.Na.get(e);if(i&&i.va)return U().add(i.key);{let s=U(),o=t.Ma.get(e);if(!o)return s;for(let l of o){let u=t.Fa.get(l);s=s.unionWith(u.view.Va)}return s}}function lh(n){let e=F(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=rh.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Cm.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Im.bind(null,e),e.Ca.d_=dm.bind(null,e.eventManager),e.Ca.$a=fm.bind(null,e.eventManager),e}function Am(n){let e=F(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Tm.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=wm.bind(null,e),e}var du=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return V(this,null,function*(){this.serializer=Kr(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,i){return null}Ha(t,i){return null}za(t){return Gp(this.persistence,new ia,t.initialUser,this.serializer)}Ga(t){return new Xo(ea.Zr,this.serializer)}Wa(t){return new oa}terminate(){return V(this,null,function*(){var t,i;(t=this.gcScheduler)===null||t===void 0||t.stop(),(i=this.indexBackfillerScheduler)===null||i===void 0||i.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var Sm=(()=>{class n{initialize(t,i){return V(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>uu(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=bm.bind(null,this.syncEngine),yield cm(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new _a}()}createDatastore(t){let i=Kr(t.databaseInfo.databaseId),s=function(l){return new ca(l)}(t.databaseInfo);return function(l,u,d,f){return new da(l,u,d,f)}(t.authCredentials,t.appCheckCredentials,s,i)}createRemoteStore(t){return function(s,o,l,u,d){return new pa(s,o,l,u,d)}(this.localStore,this.datastore,t.asyncQueue,i=>uu(this.syncEngine,i,0),function(){return Ar.D()?new Ar:new aa}())}createSyncEngine(t,i){return function(o,l,u,d,f,g,E){let C=new Ea(o,l,u,d,f,g);return E&&(C.Qa=!0),C}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,i)}terminate(){return V(this,null,function*(){var t,i;yield function(o){return V(this,null,function*(){let l=F(o);k("RemoteStore","RemoteStore shutting down."),l.L_.add(5),yield Ci(l),l.k_.shutdown(),l.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(i=this.eventManager)===null||i===void 0||i.terminate()})}}return n.provider={build:()=>new n},n})();var Ca=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ht("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Aa=class{constructor(e,t,i,s,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=s,this.user=ye.UNAUTHENTICATED,this.clientId=fr.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,l=>V(this,null,function*(){k("FirestoreClient","Received user=",l.uid),yield this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(i,l=>(k("FirestoreClient","Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ct;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>V(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let i=Qa(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}};function to(n,e){return V(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),k("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(s=>V(this,null,function*(){i.isEqual(s)||(yield Hu(e.localStore,s),i=s)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function fu(n,e){return V(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield xm(n);k("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>au(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>au(e.remoteStore,s)),n._onlineComponents=e})}function xm(n){return V(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){k("FirestoreClient","Using user provided OfflineComponentProvider");try{yield to(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(s){return s.name==="FirebaseError"?s.code===A.FAILED_PRECONDITION||s.code===A.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;vn("Error using user provided cache. Falling back to memory cache: "+t),yield to(n,new du)}}else k("FirestoreClient","Using default OfflineComponentProvider"),yield to(n,new du);return n._offlineComponents})}function ch(n){return V(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(k("FirestoreClient","Using user provided OnlineComponentProvider"),yield fu(n,n._uninitializedComponentsProvider._online)):(k("FirestoreClient","Using default OnlineComponentProvider"),yield fu(n,new Sm))),n._onlineComponents})}function Rm(n){return ch(n).then(e=>e.syncEngine)}function pu(n){return V(this,null,function*(){let e=yield ch(n),t=e.eventManager;return t.onListen=pm.bind(null,e.syncEngine),t.onUnlisten=_m.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=mm.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=ym.bind(null,e.syncEngine),t})}function uh(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var mu=new Map;function hh(n,e,t){if(!t)throw new O(A.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Pm(n,e,t,i){if(e===!0&&i===!0)throw new O(A.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function gu(n){if(!M.isDocumentKey(n))throw new O(A.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function _u(n){if(M.isDocumentKey(n))throw new O(A.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ja(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":L()}function At(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new O(A.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Ja(n);throw new O(A.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var Nr=class{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new O(A.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new O(A.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Pm("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=uh((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new O(A.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new O(A.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new O(A.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,s){return i.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Dn=class{constructor(e,t,i,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Nr({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new O(A.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new O(A.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Nr(e),e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new no;switch(i.type){case"firstParty":return new oo(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new O(A.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return V(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let i=mu.get(t);i&&(k("ComponentProvider","Removing Datastore"),mu.delete(t),i.terminate())}(this),Promise.resolve()}};function dh(n,e,t,i={}){var s;let o=(n=At(n,Dn))._getSettings(),l=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==l&&vn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:l,ssl:!1})),i.mockUserToken){let u,d;if(typeof i.mockUserToken=="string")u=i.mockUserToken,d=ye.MOCK_USER;else{u=_c(i.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);let f=i.mockUserToken.sub||i.mockUserToken.user_id;if(!f)throw new O(A.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new ye(f)}n._authCredentials=new io(new dr(u,d))}}var Or=class n{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Me=class n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new St(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},St=class n extends Or{constructor(e,t,i){super(e,t,qa(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Me(this.firestore,null,new M(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function fh(n,e,...t){if(n=Ke(n),hh("collection","path",e),n instanceof Dn){let i=le.fromString(e,...t);return _u(i),new St(n,null,i)}{if(!(n instanceof Me||n instanceof St))throw new O(A.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(le.fromString(e,...t));return _u(i),new St(n.firestore,null,i)}}function Ya(n,e,...t){if(n=Ke(n),arguments.length===1&&(e=fr.newId()),hh("doc","path",e),n instanceof Dn){let i=le.fromString(e,...t);return gu(i),new Me(n,null,new M(i))}{if(!(n instanceof Me||n instanceof St))throw new O(A.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(le.fromString(e,...t));return gu(i),new Me(n.firestore,n instanceof St?n.converter:null,new M(i))}}var Mr=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Sr(this,"async_queue_retry"),this.Vu=()=>{let i=eo();i&&k("AsyncQueue","Visibility state changed to "+i.visibilityState),this.t_.jo()},this.mu=e;let t=eo();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=eo();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new ct;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return V(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!bi(e))throw e;k("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(i=>{this.Eu=i,this.du=!1;let s=function(l){let u=l.message||"";return l.stack&&(u=l.stack.includes(l.message)?l.stack:l.message+`
`+l.stack),u}(i);throw ht("INTERNAL UNHANDLED ERROR: ",s),i}).then(i=>(this.du=!1,i))));return this.mu=t,t}enqueueAfterDelay(e,t,i){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let s=ma.createAndSchedule(this,e,t,i,o=>this.yu(o));return this.Tu.push(s),s}fu(){this.Eu&&L()}verifyOperationInProgress(){}wu(){return V(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};function yu(n){return function(t,i){if(typeof t!="object"||t===null)return!1;let s=t;for(let o of i)if(o in s&&typeof s[o]=="function")return!0;return!1}(n,["next","error","complete"])}var Dt=class extends Dn{constructor(e,t,i,s){super(e,t,i,s),this.type="firestore",this._queue=new Mr,this._persistenceKey=s?.name||"[DEFAULT]"}_terminate(){return V(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Mr(e),this._firestoreClient=void 0,yield e}})}};function ph(n,e){let t=typeof n=="object"?n:Ac(),i=typeof n=="string"?n:e||"(default)",s=bc(t,"firestore").getImmediate({identifier:i});if(!s._initialized){let o=gc("firestore");o&&dh(s,...o)}return s}function mh(n){if(n._terminated)throw new O(A.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Dm(n),n._firestoreClient}function Dm(n){var e,t,i;let s=n._freezeSettings(),o=function(u,d,f,g){return new ho(u,d,f,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,uh(g.experimentalLongPollingOptions),g.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=s.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new Aa(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(u){let d=u?._online.build();return{_offline:u?._offline.build(d),_online:d}}(n._componentsProvider))}var vi=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(xe.fromBase64String(e))}catch(t){throw new O(A.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(xe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Vn=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new O(A.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Oe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Ii=class{constructor(e){this._methodName=e}};var Ti=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new O(A.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new O(A.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Q(this._lat,e._lat)||Q(this._long,e._long)}};var wi=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,s){if(i.length!==s.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==s[o])return!1;return!0}(this._values,e._values)}};var Vm=/^__.*__$/,Sa=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new tt(e,this.data,this.fieldMask,t,this.fieldTransforms):new Jt(e,this.data,t,this.fieldTransforms)}},Lr=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new tt(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function gh(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw L()}}var xa=class n{constructor(e,t,i,s,o,l){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=s,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:i,xu:!1});return s.Ou(e),s}Nu(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:i,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Br(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(gh(this.Cu)&&Vm.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},Ra=class{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Kr(e)}Qu(e,t,i,s=!1){return new xa({Cu:e,methodName:t,qu:i,path:Oe.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function _h(n){let e=n._freezeSettings(),t=Kr(n._databaseId);return new Ra(n._databaseId,!!e.ignoreUndefinedProperties,t)}function km(n,e,t,i,s,o={}){let l=n.Qu(o.merge||o.mergeFields?2:0,e,t,s);Xa("Data must be an object, but it was:",l,i);let u=yh(i,l),d,f;if(o.merge)d=new Be(l.fieldMask),f=l.fieldTransforms;else if(o.mergeFields){let g=[];for(let E of o.mergeFields){let C=Pa(e,E,t);if(!l.contains(C))throw new O(A.INVALID_ARGUMENT,`Field '${C}' is specified in your field mask but missing from your input data.`);Ih(g,C)||g.push(C)}d=new Be(g),f=l.fieldTransforms.filter(E=>d.covers(E.field))}else d=null,f=l.fieldTransforms;return new Sa(new Ne(u),d,f)}var Fr=class n extends Ii{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function Nm(n,e,t,i){let s=n.Qu(1,e,t);Xa("Data must be an object, but it was:",s,i);let o=[],l=Ne.empty();Yt(i,(d,f)=>{let g=Za(e,d,t);f=Ke(f);let E=s.Nu(g);if(f instanceof Fr)o.push(g);else{let C=Hr(f,E);C!=null&&(o.push(g),l.set(g,C))}});let u=new Be(o);return new Lr(l,u,s.fieldTransforms)}function Om(n,e,t,i,s,o){let l=n.Qu(1,e,t),u=[Pa(e,i,t)],d=[s];if(o.length%2!=0)throw new O(A.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let C=0;C<o.length;C+=2)u.push(Pa(e,o[C])),d.push(o[C+1]);let f=[],g=Ne.empty();for(let C=u.length-1;C>=0;--C)if(!Ih(f,u[C])){let S=u[C],D=d[C];D=Ke(D);let N=l.Nu(S);if(D instanceof Fr)f.push(S);else{let P=Hr(D,N);P!=null&&(f.push(S),g.set(S,P))}}let E=new Be(f);return new Lr(g,E,l.fieldTransforms)}function Hr(n,e){if(vh(n=Ke(n)))return Xa("Unsupported field value:",e,n),yh(n,e);if(n instanceof Ii)return function(i,s){if(!gh(s.Cu))throw s.Bu(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${i._methodName}() is not currently supported inside arrays`);let o=i._toFieldTransform(s);o&&s.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(i,s){let o=[],l=0;for(let u of i){let d=Hr(u,s.Lu(l));d==null&&(d={nullValue:"NULL_VALUE"}),o.push(d),l++}return{arrayValue:{values:o}}}(n,e)}return function(i,s){if((i=Ke(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return vp(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){let o=Ie.fromDate(i);return{timestampValue:Er(s.serializer,o)}}if(i instanceof Ie){let o=new Ie(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Er(s.serializer,o)}}if(i instanceof Ti)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof vi)return{bytesValue:zu(s.serializer,i._byteString)};if(i instanceof Me){let o=s.databaseId,l=i.firestore._databaseId;if(!l.isEqual(o))throw s.Bu(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:za(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof wi)return function(l,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:l.toArray().map(d=>{if(typeof d!="number")throw u.Bu("VectorValues must only contain numeric values.");return Ua(u.serializer,d)})}}}}}}(i,s);throw s.Bu(`Unsupported field value: ${Ja(i)}`)}(n,e)}function yh(n,e){let t={};return Iu(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Yt(n,(i,s)=>{let o=Hr(s,e.Mu(i));o!=null&&(t[i]=o)}),{mapValue:{fields:t}}}function vh(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ie||n instanceof Ti||n instanceof vi||n instanceof Me||n instanceof Ii||n instanceof wi)}function Xa(n,e,t){if(!vh(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){let i=Ja(t);throw i==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+i)}}function Pa(n,e,t){if((e=Ke(e))instanceof Vn)return e._internalPath;if(typeof e=="string")return Za(n,e);throw Br("Field path arguments must be of type string or ",n,!1,void 0,t)}var Mm=new RegExp("[~\\*/\\[\\]]");function Za(n,e,t){if(e.search(Mm)>=0)throw Br(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Vn(...e.split("."))._internalPath}catch{throw Br(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Br(n,e,t,i,s){let o=i&&!i.isEmpty(),l=s!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let d="";return(o||l)&&(d+=" (found",o&&(d+=` in field ${i}`),l&&(d+=` in document ${s}`),d+=")"),new O(A.INVALID_ARGUMENT,u+n+d)}function Ih(n,e){return n.some(t=>t.isEqual(e))}var qr=class{constructor(e,t,i,s,o){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Me(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Da(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Th("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Da=class extends qr{data(){return super.data()}};function Th(n,e){return typeof e=="string"?Za(n,e):e instanceof Vn?e._internalPath:e._delegate._internalPath}function Lm(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new O(A.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Va=class{convertValue(e,t="none"){switch(Qt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return se(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(xt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw L()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let i={};return Yt(e,(s,o)=>{i[s]=this.convertValue(o,t)}),i}convertVectorValue(e){var t,i,s;let o=(s=(i=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||i===void 0?void 0:i.values)===null||s===void 0?void 0:s.map(l=>se(l.doubleValue));return new wi(o)}convertGeoPoint(e){return new Ti(se(e.latitude),se(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":let i=Ma(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(di(e));default:return null}}convertTimestamp(e){let t=dt(e);return new Ie(t.seconds,t.nanos)}convertDocumentKey(e,t){let i=le.fromString(e);J(Wu(i));let s=new _r(i.get(1),i.get(3)),o=new M(i.popFirst(5));return s.isEqual(t)||ht(`Document ${o} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function Fm(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}var $t=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ur=class extends qr{constructor(e,t,i,s,o,l){super(e,t,i,s,l),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new yn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let i=this._document.data.field(Th("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}},yn=class extends Ur{data(e={}){return super.data(e)}},ka=class{constructor(e,t,i,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new $t(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new yn(this._firestore,this._userDataWriter,i.key,i,new $t(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new O(A.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,o){if(s._snapshot.oldDocs.isEmpty()){let l=0;return s._snapshot.docChanges.map(u=>{let d=new yn(s._firestore,s._userDataWriter,u.doc.key,u.doc,new $t(s._snapshot.mutatedKeys.has(u.doc.key),s._snapshot.fromCache),s.query.converter);return u.doc,{type:"added",doc:d,oldIndex:-1,newIndex:l++}})}{let l=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{let d=new yn(s._firestore,s._userDataWriter,u.doc.key,u.doc,new $t(s._snapshot.mutatedKeys.has(u.doc.key),s._snapshot.fromCache),s.query.converter),f=-1,g=-1;return u.type!==0&&(f=l.indexOf(u.doc.key),l=l.delete(u.doc.key)),u.type!==1&&(l=l.add(u.doc),g=l.indexOf(u.doc.key)),{type:Bm(u.type),doc:d,oldIndex:f,newIndex:g}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function Bm(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return L()}}var zr=class extends Va{constructor(e){super(),this.firestore=e}convertBytes(e){return new vi(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,t)}};function wh(n,e,t,...i){n=At(n,Me);let s=At(n.firestore,Dt),o=_h(s),l;return l=typeof(e=Ke(e))=="string"||e instanceof Vn?Om(o,"updateDoc",n._key,e,t,i):Nm(o,"updateDoc",n._key,e),tl(s,[l.toMutation(n._key,ut.exists(!0))])}function Eh(n){return tl(At(n.firestore,Dt),[new pi(n._key,ut.none())])}function bh(n,e){let t=At(n.firestore,Dt),i=Ya(n),s=Fm(n.converter,e);return tl(t,[km(_h(n.firestore),"addDoc",i._key,s,n.converter!==null,{}).toMutation(i._key,ut.exists(!1))]).then(()=>i)}function el(n,...e){var t,i,s;n=Ke(n);let o={includeMetadataChanges:!1,source:"default"},l=0;typeof e[l]!="object"||yu(e[l])||(o=e[l],l++);let u={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(yu(e[l])){let E=e[l];e[l]=(t=E.next)===null||t===void 0?void 0:t.bind(E),e[l+1]=(i=E.error)===null||i===void 0?void 0:i.bind(E),e[l+2]=(s=E.complete)===null||s===void 0?void 0:s.bind(E)}let d,f,g;if(n instanceof Me)f=At(n.firestore,Dt),g=qa(n._key.path),d={next:E=>{e[l]&&e[l](qm(f,n,E))},error:e[l+1],complete:e[l+2]};else{let E=At(n,Or);f=At(E.firestore,Dt),g=E._query;let C=new zr(f);d={next:S=>{e[l]&&e[l](new ka(f,C,E,S))},error:e[l+1],complete:e[l+2]},Lm(n._query)}return function(C,S,D,N){let P=new Ca(N),z=new va(S,P,D);return C.asyncQueue.enqueueAndForget(()=>V(this,null,function*(){return um(yield pu(C),z)})),()=>{P.Za(),C.asyncQueue.enqueueAndForget(()=>V(this,null,function*(){return hm(yield pu(C),z)}))}}(mh(f),g,u,d)}function tl(n,e){return function(i,s){let o=new ct;return i.asyncQueue.enqueueAndForget(()=>V(this,null,function*(){return vm(yield Rm(i),s,o)})),o.promise}(mh(n),e)}function qm(n,e,t){let i=t.docs.get(e._key),s=new zr(n);return new Ur(n,s,e._key,i,new $t(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(s){kn=s})(Cc),Ec(new Tc("firestore",(i,{instanceIdentifier:s,options:o})=>{let l=i.getProvider("app").getImmediate(),u=new Dt(new ro(i.getProvider("auth-internal")),new lo(i.getProvider("app-check-internal")),function(f,g){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new O(A.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new _r(f.options.projectId,g)}(l,s),l);return o=Object.assign({useFetchStreams:t},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),cn(qc,"4.7.3",e),cn(qc,"4.7.3","esm2017")})();var Yy={firebase:{apiKey:"AIzaSyCyDosyJxwuY7Oz7Xa4v9Y5Ej06CsSMtNw",authDomain:"testangular-3bb36.firebaseapp.com",projectId:"testangular-3bb36",storageBucket:"testangular-3bb36.firebasestorage.app",messagingSenderId:"469852807387",appId:"1:469852807387:web:c7758a95d63b133b15ecfe",measurementId:"G-FXSN1FRE0E"},defaultAvatar:"https://www.w3schools.com/w3images/avatar2.png"};var Um="auth";var Jr=class{constructor(){return nr(Um)}};var Yr=function(){return Yr=Object.assign||function(e){for(var t,i=1,s=arguments.length;i<s;i++){t=arguments[i];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Yr.apply(this,arguments)};var $m={includeMetadataChanges:!1};function nl(n,e){return e===void 0&&(e=$m),new ac(function(t){var i=el(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:i}})}function Ch(n){return nl(n,{includeMetadataChanges:!0})}function Ah(n,e){return e===void 0&&(e={}),Ch(n).pipe(Gi(function(t){return il(t,e)}))}function il(n,e){var t;e===void 0&&(e={});var i=n.data(e);return!n.exists()||typeof i!="object"||i===null||!e.idField?i:Yr(Yr({},i),(t={},t[e.idField]=n.id,t))}function Sh(n){return nl(n,{includeMetadataChanges:!0}).pipe(Gi(function(e){return e.docs}))}function xh(n,e){return e===void 0&&(e={}),Sh(n).pipe(Gi(function(t){return t.map(function(i){return il(i,e)})}))}var Si=class{constructor(e){return e}},Rh="firestore",rl=class{constructor(){return nr(Rh)}};var sl=new lc("angularfire2.firestore-instances");function Gm(n,e){let t=xs(Rh,n,e);return t&&new Si(t)}function Km(n){return(e,t)=>{let i=e.runOutsideAngular(()=>n(t));return new Si(i)}}var Qm={provide:rl,deps:[[new ti,sl]]},Wm={provide:Si,useFactory:Gm,deps:[[new ti,sl],xc]};function Vv(n,...e){return cn("angularfire",Ss.full,"fst"),cc([Wm,Qm,{provide:sl,useFactory:Km(n),multi:!0,deps:[Wi,uc,Ps,Rc,[new ti,Jr],[new ti,Rs],...e]}])}var kv=Qe(xh,!0);var Nv=Qe(Ah,!0);var Ov=Qe(bh,!0);var Mv=Qe(fh,!0);var Lv=Qe(Eh,!0);var Fv=Qe(Ya,!0);var Bv=Qe(ph,!0);var qv=Qe(wh,!0);export{Ie as a,Yy as b,Ym as c,Bs as d,ag as e,qs as f,Fg as g,d_ as h,$s as i,Si as j,Vv as k,kv as l,Nv as m,Ov as n,Mv as o,Lv as p,Fv as q,Bv as r,qv as s,Mc as t,vg as u,Us as v,Lc as w};
